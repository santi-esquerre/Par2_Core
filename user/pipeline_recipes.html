

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pipeline Recipes &mdash; Par2_Core Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Memory Contract" href="memory_contract.html" />
    <link rel="prev" title="Quick Start" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Par2_Core
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">Quick Start</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#build-the-library">Build the library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="quickstart.html#build-with-examples">Build with examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#link-from-your-own-cmake-project">Link from your own CMake project</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#minimal-code">Minimal code</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart.html#cmake-options-reference">CMake options reference</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Pipeline Recipes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#recipe-a-single-stream-simple">Recipe A — Single stream (simple)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hot-loop">Hot loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="#key-points">Key points</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#recipe-b-multi-stream-with-events">Recipe B — Multi-stream with events</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Hot loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Key points</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#velocity-updates-between-steps">Velocity updates between steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extracting-results">Extracting results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#positions">Positions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#statistics">Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unwrapped-positions-periodic-bc">Unwrapped positions (periodic BC)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="memory_contract.html">Memory Contract</a><ul>
<li class="toctree-l3"><a class="reference internal" href="memory_contract.html#core-principle-views-are-non-owning">Core principle: views are non-owning</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory_contract.html#velocity-fields">Velocity fields</a><ul>
<li class="toctree-l4"><a class="reference internal" href="memory_contract.html#layout">Layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="memory_contract.html#allocation">Allocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="memory_contract.html#lifetime">Lifetime</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="memory_contract.html#particles">Particles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="memory_contract.html#layout-structure-of-arrays-soa">Layout: Structure of Arrays (SoA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="memory_contract.html#id1">Allocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="memory_contract.html#id2">Lifetime</a></li>
<li class="toctree-l4"><a class="reference internal" href="memory_contract.html#status-array-open-bc">Status array (Open BC)</a></li>
<li class="toctree-l4"><a class="reference internal" href="memory_contract.html#wrap-counters-periodic-bc">Wrap counters (Periodic BC)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="memory_contract.html#unwrapped-positions">Unwrapped positions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="memory_contract.html#what-they-are">What they are</a></li>
<li class="toctree-l4"><a class="reference internal" href="memory_contract.html#how-to-compute">How to compute</a></li>
<li class="toctree-l4"><a class="reference internal" href="memory_contract.html#cost">Cost</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="memory_contract.html#engine-owned-temporaries">Engine-owned temporaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory_contract.html#prohibitions">Prohibitions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="performance_tips.html">Performance Tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="performance_tips.html#prepare-once-step-many">1. <code class="docutils literal notranslate"><span class="pre">prepare()</span></code> once, <code class="docutils literal notranslate"><span class="pre">step()</span></code> many</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tips.html#reuse-engine-and-workspace">2. Reuse engine and workspace</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tips.html#no-allocs-no-syncs-in-step">3. No allocs, no syncs in <code class="docutils literal notranslate"><span class="pre">step()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tips.html#streams-and-events-beat-global-sync">4. Streams and events beat global sync</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tips.html#know-the-hotspots">5. Know the hotspots</a></li>
<li class="toctree-l3"><a class="reference internal" href="performance_tips.html#cuda-tips">6. CUDA tips</a><ul>
<li class="toctree-l4"><a class="reference internal" href="performance_tips.html#cudamallocasync-for-workspace"><code class="docutils literal notranslate"><span class="pre">cudaMallocAsync</span></code> for workspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="performance_tips.html#avoid-unnecessary-atomics">Avoid unnecessary atomics</a></li>
<li class="toctree-l4"><a class="reference internal" href="performance_tips.html#prefer-soa">Prefer SoA</a></li>
<li class="toctree-l4"><a class="reference internal" href="performance_tips.html#pinned-host-memory-for-snapshots">Pinned host memory for snapshots</a></li>
<li class="toctree-l4"><a class="reference internal" href="performance_tips.html#block-size">Block size</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="performance_tips.html#debug-vs-release">7. Debug vs release</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Scientific Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../theory/rwpt.html">RWPT: From ADE to Stochastic Particles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/rwpt.html#the-advectiondispersion-equation">The Advection–Dispersion Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/rwpt.html#equivalent-ito-sde">Equivalent Itô SDE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../theory/rwpt.html#the-drift-vector">The drift vector</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../theory/rwpt.html#itotaylor-stepping-scheme">Itô–Taylor Stepping Scheme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/rwpt.html#per-particle-kernel-algorithm">Per-particle kernel algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/rwpt.html#source">Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/rwpt.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory/dispersion_tensor.html">Dispersion Tensor</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/dispersion_tensor.html#eigenvalues">Eigenvalues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/dispersion_tensor.html#displacement-matrix-mathbf-b">Displacement Matrix <span class="math notranslate nohighlight">\(\mathbf{B}\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/dispersion_tensor.html#special-case-dispatching">Special-Case Dispatching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/dispersion_tensor.html#zero-velocity-handling">Zero-Velocity Handling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory/displacement_matrix.html">Displacement Matrix <span class="math notranslate nohighlight">\(\mathbf{B}\)</span></a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#algebraic-setup">Algebraic setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#eigenvalues">Eigenvalues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#eigenvectors">Eigenvectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#gamma-coefficients-and-assembly">Gamma coefficients and assembly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#special-cases">Special cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#zero-velocity-handling">Zero-velocity handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#hpc-motivation">HPC motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#source">Source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory/drift_correction.html">Drift Correction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/drift_correction.html#par2-core-modes">Par2_Core Modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../theory/drift_correction.html#trilinearonfly-derivatives">TrilinearOnFly Derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theory/drift_correction.html#precomputed-finite-difference-stencil">Precomputed Finite-Difference Stencil</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../theory/drift_correction.html#source">Source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory/interpolation.html">Velocity Interpolation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/interpolation.html#linear-face-centred">Linear (Face-Centred)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/interpolation.html#trilinear-corner-based">Trilinear (Corner-Based)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/interpolation.html#choosing-a-mode">Choosing a Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/interpolation.html#source">Source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory/boundaries.html">Boundary Conditions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/boundaries.html#wrap-counters-periodic">Wrap Counters (Periodic)</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">HPC / GPU Architecture</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hpc/memory_layout.html">Memory Layout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hpc/memory_layout.html#grid-indexing">Grid Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/memory_layout.html#particle-storage-soa">Particle Storage (SoA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/memory_layout.html#velocity-views-zero-copy">Velocity Views (Zero-Copy)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/streams_events.html">CUDA Streams &amp; Events</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hpc/streams_events.html#stream-ownership">Stream Ownership</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/streams_events.html#event-based-synchronisation">Event-Based Synchronisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/streams_events.html#double-buffered-velocity-pattern">Double-Buffered Velocity Pattern</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/workspace_allocs.html">Workspace Allocations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hpc/workspace_allocs.html#prepare-vs-step"><code class="docutils literal notranslate"><span class="pre">prepare()</span></code> vs <code class="docutils literal notranslate"><span class="pre">step()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/workspace_allocs.html#what-prepare-allocates">What <code class="docutils literal notranslate"><span class="pre">prepare()</span></code> Allocates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/workspace_allocs.html#growth-policy">Growth Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/workspace_allocs.html#cudamallocasync-cuda-11-2"><code class="docutils literal notranslate"><span class="pre">cudaMallocAsync</span></code> (CUDA ≥ 11.2)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/rng_reproducibility.html">RNG &amp; Reproducibility</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hpc/rng_reproducibility.html#random-number-generation">Random Number Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/rng_reproducibility.html#seeding">Seeding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/rng_reproducibility.html#reproducibility-guarantees">Reproducibility Guarantees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/rng_reproducibility.html#correlation-risks">Correlation risks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/performance_notes.html">Performance Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hpc/performance_notes.html#kernel-block-size">Kernel Block Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/performance_notes.html#arithmetic-intensity">Arithmetic Intensity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/performance_notes.html#debug-vs-release">Debug vs Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/performance_notes.html#allocation-free-stepping">Allocation-Free Stepping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/performance_notes.html#known-limitations">Known Limitations</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#how-to-integrate-tl-dr">How to integrate (TL;DR)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#core-engine">Core Engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv44par2"><code class="docutils literal notranslate"><span class="pre">par2</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par215TransportEngineE"><code class="docutils literal notranslate"><span class="pre">par2::TransportEngine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par26detailE"><code class="docutils literal notranslate"><span class="pre">par2::detail</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#types-configuration">Types &amp; Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4N4par212BoundaryTypeE"><code class="docutils literal notranslate"><span class="pre">BoundaryType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212BoundaryType6ClosedE"><code class="docutils literal notranslate"><span class="pre">Closed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212BoundaryType8PeriodicE"><code class="docutils literal notranslate"><span class="pre">Periodic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212BoundaryType4OpenE"><code class="docutils literal notranslate"><span class="pre">Open</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4N4par217InterpolationModeE"><code class="docutils literal notranslate"><span class="pre">InterpolationMode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par217InterpolationMode6LinearE"><code class="docutils literal notranslate"><span class="pre">Linear</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par217InterpolationMode9TrilinearE"><code class="docutils literal notranslate"><span class="pre">Trilinear</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4N4par219DriftCorrectionModeE"><code class="docutils literal notranslate"><span class="pre">DriftCorrectionMode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par219DriftCorrectionMode4NoneE"><code class="docutils literal notranslate"><span class="pre">None</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par219DriftCorrectionMode11PrecomputedE"><code class="docutils literal notranslate"><span class="pre">Precomputed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par219DriftCorrectionMode14TrilinearOnFlyE"><code class="docutils literal notranslate"><span class="pre">TrilinearOnFly</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4N4par214ParticleStatusE"><code class="docutils literal notranslate"><span class="pre">ParticleStatus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214ParticleStatus6ActiveE"><code class="docutils literal notranslate"><span class="pre">Active</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214ParticleStatus6ExitedE"><code class="docutils literal notranslate"><span class="pre">Exited</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214ParticleStatus8InactiveE"><code class="docutils literal notranslate"><span class="pre">Inactive</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4N4par212EngineConfigE"><code class="docutils literal notranslate"><span class="pre">par2::EngineConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212EngineConfig18interpolation_modeE"><code class="docutils literal notranslate"><span class="pre">interpolation_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212EngineConfig10drift_modeE"><code class="docutils literal notranslate"><span class="pre">drift_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212EngineConfig8rng_seedE"><code class="docutils literal notranslate"><span class="pre">rng_seed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212EngineConfig17kernel_block_sizeE"><code class="docutils literal notranslate"><span class="pre">kernel_block_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212EngineConfig12debug_checksE"><code class="docutils literal notranslate"><span class="pre">debug_checks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212EngineConfig14nan_preventionE"><code class="docutils literal notranslate"><span class="pre">nan_prevention</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par29StepStatsE"><code class="docutils literal notranslate"><span class="pre">par2::StepStats</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par29StepStats16active_particlesE"><code class="docutils literal notranslate"><span class="pre">active_particles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par29StepStats16exited_particlesE"><code class="docutils literal notranslate"><span class="pre">exited_particles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par29StepStats16max_displacementE"><code class="docutils literal notranslate"><span class="pre">max_displacement</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par215TransportParamsE"><code class="docutils literal notranslate"><span class="pre">par2::TransportParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par215TransportParams14has_dispersionEv"><code class="docutils literal notranslate"><span class="pre">has_dispersion()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par215TransportParams19molecular_diffusionE"><code class="docutils literal notranslate"><span class="pre">molecular_diffusion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par215TransportParams7alpha_lE"><code class="docutils literal notranslate"><span class="pre">alpha_l</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par215TransportParams7alpha_tE"><code class="docutils literal notranslate"><span class="pre">alpha_t</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#grid">Grid</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T"><code class="docutils literal notranslate"><span class="pre">make_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par217make_uniform_gridE8GridDescI1TEiii1T1T1T1T"><code class="docutils literal notranslate"><span class="pre">make_uniform_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par28GridDescE"><code class="docutils literal notranslate"><span class="pre">par2::GridDesc</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par28GridDesc9num_cellsEv"><code class="docutils literal notranslate"><span class="pre">num_cells()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par28GridDesc11num_cornersEv"><code class="docutils literal notranslate"><span class="pre">num_corners()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par28GridDesc8length_xEv"><code class="docutils literal notranslate"><span class="pre">length_x()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par28GridDesc8length_yEv"><code class="docutils literal notranslate"><span class="pre">length_y()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par28GridDesc8length_zEv"><code class="docutils literal notranslate"><span class="pre">length_z()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par28GridDesc11cell_volumeEv"><code class="docutils literal notranslate"><span class="pre">cell_volume()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par28GridDesc13domain_volumeEv"><code class="docutils literal notranslate"><span class="pre">domain_volume()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par28GridDesc5is_2dEv"><code class="docutils literal notranslate"><span class="pre">is_2d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par28GridDesc5x_maxEv"><code class="docutils literal notranslate"><span class="pre">x_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par28GridDesc5y_maxEv"><code class="docutils literal notranslate"><span class="pre">y_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par28GridDesc5z_maxEv"><code class="docutils literal notranslate"><span class="pre">z_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par28GridDesc2nxE"><code class="docutils literal notranslate"><span class="pre">nx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par28GridDesc2nyE"><code class="docutils literal notranslate"><span class="pre">ny</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par28GridDesc2nzE"><code class="docutils literal notranslate"><span class="pre">nz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par28GridDesc2dxE"><code class="docutils literal notranslate"><span class="pre">dx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par28GridDesc2dyE"><code class="docutils literal notranslate"><span class="pre">dy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par28GridDesc2dzE"><code class="docutils literal notranslate"><span class="pre">dz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par28GridDesc2pxE"><code class="docutils literal notranslate"><span class="pre">px</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par28GridDesc2pyE"><code class="docutils literal notranslate"><span class="pre">py</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par28GridDesc2pzE"><code class="docutils literal notranslate"><span class="pre">pz</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#views-zero-copy-binding">Views (Zero-Copy Binding)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par215ConstDeviceSpanE"><code class="docutils literal notranslate"><span class="pre">ConstDeviceSpan</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par218ConstParticlesViewE"><code class="docutils literal notranslate"><span class="pre">par2::ConstParticlesView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par218ConstParticlesView5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par218ConstParticlesView18ConstParticlesViewEv"><code class="docutils literal notranslate"><span class="pre">ConstParticlesView()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par218ConstParticlesView18ConstParticlesViewERK13ParticlesViewI1TE"><code class="docutils literal notranslate"><span class="pre">ConstParticlesView()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par218ConstParticlesView1xE"><code class="docutils literal notranslate"><span class="pre">x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par218ConstParticlesView1yE"><code class="docutils literal notranslate"><span class="pre">y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par218ConstParticlesView1zE"><code class="docutils literal notranslate"><span class="pre">z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par218ConstParticlesView1nE"><code class="docutils literal notranslate"><span class="pre">n</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par218ConstParticlesView6statusE"><code class="docutils literal notranslate"><span class="pre">status</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par218ConstParticlesView5wrapXE"><code class="docutils literal notranslate"><span class="pre">wrapX</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par218ConstParticlesView5wrapYE"><code class="docutils literal notranslate"><span class="pre">wrapY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par218ConstParticlesView5wrapZE"><code class="docutils literal notranslate"><span class="pre">wrapZ</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par210DeviceSpanE"><code class="docutils literal notranslate"><span class="pre">par2::DeviceSpan</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par210DeviceSpan5emptyEv"><code class="docutils literal notranslate"><span class="pre">empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par210DeviceSpan5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par210DeviceSpan4dataE"><code class="docutils literal notranslate"><span class="pre">data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par210DeviceSpan4sizeE"><code class="docutils literal notranslate"><span class="pre">size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par219DriftCorrectionViewE"><code class="docutils literal notranslate"><span class="pre">par2::DriftCorrectionView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par219DriftCorrectionView5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par219DriftCorrectionView3dcxE"><code class="docutils literal notranslate"><span class="pre">dcx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par219DriftCorrectionView3dcyE"><code class="docutils literal notranslate"><span class="pre">dcy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par219DriftCorrectionView3dczE"><code class="docutils literal notranslate"><span class="pre">dcz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par219DriftCorrectionView4sizeE"><code class="docutils literal notranslate"><span class="pre">size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par213ParticlesViewE"><code class="docutils literal notranslate"><span class="pre">par2::ParticlesView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par213ParticlesView5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par213ParticlesView10has_statusEv"><code class="docutils literal notranslate"><span class="pre">has_status()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par213ParticlesView10has_wrap_xEv"><code class="docutils literal notranslate"><span class="pre">has_wrap_x()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par213ParticlesView10has_wrap_yEv"><code class="docutils literal notranslate"><span class="pre">has_wrap_y()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par213ParticlesView10has_wrap_zEv"><code class="docutils literal notranslate"><span class="pre">has_wrap_z()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par213ParticlesView12has_any_wrapEv"><code class="docutils literal notranslate"><span class="pre">has_any_wrap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213ParticlesView1xE"><code class="docutils literal notranslate"><span class="pre">x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213ParticlesView1yE"><code class="docutils literal notranslate"><span class="pre">y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213ParticlesView1zE"><code class="docutils literal notranslate"><span class="pre">z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213ParticlesView1nE"><code class="docutils literal notranslate"><span class="pre">n</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213ParticlesView6statusE"><code class="docutils literal notranslate"><span class="pre">status</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213ParticlesView5wrapXE"><code class="docutils literal notranslate"><span class="pre">wrapX</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213ParticlesView5wrapYE"><code class="docutils literal notranslate"><span class="pre">wrapY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213ParticlesView5wrapZE"><code class="docutils literal notranslate"><span class="pre">wrapZ</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par222UnwrappedPositionsViewE"><code class="docutils literal notranslate"><span class="pre">par2::UnwrappedPositionsView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par222UnwrappedPositionsView5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par222UnwrappedPositionsView3x_uE"><code class="docutils literal notranslate"><span class="pre">x_u</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par222UnwrappedPositionsView3y_uE"><code class="docutils literal notranslate"><span class="pre">y_u</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par222UnwrappedPositionsView3z_uE"><code class="docutils literal notranslate"><span class="pre">z_u</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par222UnwrappedPositionsView8capacityE"><code class="docutils literal notranslate"><span class="pre">capacity</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#velocity-layout">Velocity Layout</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par212VelocityViewE"><code class="docutils literal notranslate"><span class="pre">VelocityView</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par218CornerVelocityViewE"><code class="docutils literal notranslate"><span class="pre">CornerVelocityView</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4N4par28merge_idEiiiii"><code class="docutils literal notranslate"><span class="pre">merge_id()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4N4par210field_sizeEiii"><code class="docutils literal notranslate"><span class="pre">field_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par210field_sizeE6size_tRK8GridDescI1TE"><code class="docutils literal notranslate"><span class="pre">field_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I00EN4par219validate_face_fieldEvRK13FaceFieldViewI1TERK8GridDescI5GridTE"><code class="docutils literal notranslate"><span class="pre">validate_face_field()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I00EN4par221validate_corner_fieldEvRK15CornerFieldViewI1TERK8GridDescI5GridTE"><code class="docutils literal notranslate"><span class="pre">validate_corner_field()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par215CornerFieldViewE"><code class="docutils literal notranslate"><span class="pre">par2::CornerFieldView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par215CornerFieldView5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4I0ENK4par215CornerFieldView12matches_gridEbRK8GridDescI5GridTE"><code class="docutils literal notranslate"><span class="pre">matches_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par215CornerFieldView2UcE"><code class="docutils literal notranslate"><span class="pre">Uc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par215CornerFieldView2VcE"><code class="docutils literal notranslate"><span class="pre">Vc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par215CornerFieldView2WcE"><code class="docutils literal notranslate"><span class="pre">Wc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par215CornerFieldView4sizeE"><code class="docutils literal notranslate"><span class="pre">size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par213FaceFieldViewE"><code class="docutils literal notranslate"><span class="pre">par2::FaceFieldView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par213FaceFieldView5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4I0ENK4par213FaceFieldView12matches_gridEbRK8GridDescI5GridTE"><code class="docutils literal notranslate"><span class="pre">matches_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213FaceFieldView1UE"><code class="docutils literal notranslate"><span class="pre">U</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213FaceFieldView1VE"><code class="docutils literal notranslate"><span class="pre">V</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213FaceFieldView1WE"><code class="docutils literal notranslate"><span class="pre">W</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213FaceFieldView4sizeE"><code class="docutils literal notranslate"><span class="pre">size</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#boundary-conditions">Boundary Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par212AxisBoundaryE"><code class="docutils literal notranslate"><span class="pre">par2::AxisBoundary</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212AxisBoundary2loE"><code class="docutils literal notranslate"><span class="pre">lo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212AxisBoundary2hiE"><code class="docutils literal notranslate"><span class="pre">hi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212AxisBoundary9symmetricE12BoundaryType"><code class="docutils literal notranslate"><span class="pre">symmetric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212AxisBoundary6closedEv"><code class="docutils literal notranslate"><span class="pre">closed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212AxisBoundary8periodicEv"><code class="docutils literal notranslate"><span class="pre">periodic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par212AxisBoundary4openEv"><code class="docutils literal notranslate"><span class="pre">open()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par214BoundaryConfigE"><code class="docutils literal notranslate"><span class="pre">par2::BoundaryConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par214BoundaryConfig12has_periodicEv"><code class="docutils literal notranslate"><span class="pre">has_periodic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par214BoundaryConfig8has_openEv"><code class="docutils literal notranslate"><span class="pre">has_open()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214BoundaryConfig1xE"><code class="docutils literal notranslate"><span class="pre">x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214BoundaryConfig1yE"><code class="docutils literal notranslate"><span class="pre">y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214BoundaryConfig1zE"><code class="docutils literal notranslate"><span class="pre">z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214BoundaryConfig10all_closedEv"><code class="docutils literal notranslate"><span class="pre">all_closed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214BoundaryConfig12all_periodicEv"><code class="docutils literal notranslate"><span class="pre">all_periodic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214BoundaryConfig9channel_xEv"><code class="docutils literal notranslate"><span class="pre">channel_x()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214BoundaryConfig6open_xEv"><code class="docutils literal notranslate"><span class="pre">open_x()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#particle-injection">Particle Injection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par210inject_boxEvRK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">inject_box()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par211inject_gridEvRK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">inject_grid()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#statistics">Statistics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par217concentration_boxEdRK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">concentration_box()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par224concentration_past_planeEdRK18ConstParticlesViewI1TEi1T12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">concentration_past_plane()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par215count_by_statusE14ParticleCountsRK18ConstParticlesViewI1TE12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">count_by_status()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par28Moments3E"><code class="docutils literal notranslate"><span class="pre">par2::Moments3</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par28Moments37has_nanEv"><code class="docutils literal notranslate"><span class="pre">has_nan()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par28Moments34meanE"><code class="docutils literal notranslate"><span class="pre">mean</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par28Moments33varE"><code class="docutils literal notranslate"><span class="pre">var</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par28Moments3StE"><code class="docutils literal notranslate"><span class="pre">std</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4N4par214ParticleCountsE"><code class="docutils literal notranslate"><span class="pre">par2::ParticleCounts</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214ParticleCounts5totalE"><code class="docutils literal notranslate"><span class="pre">total</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214ParticleCounts6activeE"><code class="docutils literal notranslate"><span class="pre">active</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214ParticleCounts6exitedE"><code class="docutils literal notranslate"><span class="pre">exited</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par214ParticleCounts8inactiveE"><code class="docutils literal notranslate"><span class="pre">inactive</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par213StatsComputerE"><code class="docutils literal notranslate"><span class="pre">par2::StatsComputer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213StatsComputer13StatsComputerEi"><code class="docutils literal notranslate"><span class="pre">StatsComputer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213StatsComputerD0Ev"><code class="docutils literal notranslate"><span class="pre">~StatsComputer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213StatsComputer13StatsComputerERK13StatsComputer"><code class="docutils literal notranslate"><span class="pre">StatsComputer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213StatsComputeraSERK13StatsComputer"><code class="docutils literal notranslate"><span class="pre">operator=()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213StatsComputer13StatsComputerERR13StatsComputer"><code class="docutils literal notranslate"><span class="pre">StatsComputer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213StatsComputeraSERR13StatsComputer"><code class="docutils literal notranslate"><span class="pre">operator=()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213StatsComputer13compute_asyncERK18ConstParticlesViewI1TERK8GridDescI1TERK11StatsConfig12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">compute_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par213StatsComputer12fetch_resultEv"><code class="docutils literal notranslate"><span class="pre">fetch_result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par213StatsComputer8capacityEv"><code class="docutils literal notranslate"><span class="pre">capacity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par213StatsComputer5impl_E"><code class="docutils literal notranslate"><span class="pre">impl_</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4N4par211StatsConfigE"><code class="docutils literal notranslate"><span class="pre">par2::StatsConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par211StatsConfig13use_unwrappedE"><code class="docutils literal notranslate"><span class="pre">use_unwrapped</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par211StatsConfig18filter_active_onlyE"><code class="docutils literal notranslate"><span class="pre">filter_active_only</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par211StatsResultE"><code class="docutils literal notranslate"><span class="pre">par2::StatsResult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4NK4par211StatsResult5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par211StatsResult7momentsE"><code class="docutils literal notranslate"><span class="pre">moments</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par211StatsResult6countsE"><code class="docutils literal notranslate"><span class="pre">counts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par211StatsResult8computedE"><code class="docutils literal notranslate"><span class="pre">computed</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#i-o-helpers">I/O Helpers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4N4par22ioE"><code class="docutils literal notranslate"><span class="pre">par2::io</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par22io24download_positions_asyncE11cudaError_tR19HostParticlesBufferI1TERK18ConstParticlesViewI1TEi12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">download_positions_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par22io24download_unwrapped_asyncE11cudaError_tR19HostParticlesBufferI1TERK22UnwrappedPositionsViewI1TEi12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">download_unwrapped_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par22io19write_particles_csvEbRKNSt6stringERK19HostParticlesBufferI1TEi1Tbbb"><code class="docutils literal notranslate"><span class="pre">write_particles_csv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par22io25write_legacy_csv_snapshotEbRK18ConstParticlesViewI1TERKNSt6stringE12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">write_legacy_csv_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par22io17CsvSnapshotConfigE"><code class="docutils literal notranslate"><span class="pre">par2::io::CsvSnapshotConfig</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par22io17CsvSnapshotWriterE"><code class="docutils literal notranslate"><span class="pre">par2::io::CsvSnapshotWriter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par22io19HostParticlesBufferE"><code class="docutils literal notranslate"><span class="pre">par2::io::HostParticlesBuffer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4I0EN4par22io21PinnedParticlesBufferE"><code class="docutils literal notranslate"><span class="pre">par2::io::PinnedParticlesBuffer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#version">Version</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#c.PAR2_CORE_VERSION_MAJOR"><code class="docutils literal notranslate"><span class="pre">PAR2_CORE_VERSION_MAJOR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#c.PAR2_CORE_VERSION_MINOR"><code class="docutils literal notranslate"><span class="pre">PAR2_CORE_VERSION_MINOR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#c.PAR2_CORE_VERSION_PATCH"><code class="docutils literal notranslate"><span class="pre">PAR2_CORE_VERSION_PATCH</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#c.PAR2_CORE_VERSION_STRING"><code class="docutils literal notranslate"><span class="pre">PAR2_CORE_VERSION_STRING</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#_CPPv4N4par27VersionE"><code class="docutils literal notranslate"><span class="pre">par2::Version</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par27Version5majorE"><code class="docutils literal notranslate"><span class="pre">major</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par27Version5minorE"><code class="docutils literal notranslate"><span class="pre">minor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par27Version5patchE"><code class="docutils literal notranslate"><span class="pre">patch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/index.html#_CPPv4N4par27Version6stringE"><code class="docutils literal notranslate"><span class="pre">string</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#debug-policy">Debug Policy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#c.PAR2_DEBUG_LEVEL"><code class="docutils literal notranslate"><span class="pre">PAR2_DEBUG_LEVEL</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#c.PAR2_ENABLE_CUDA_CHECKS"><code class="docutils literal notranslate"><span class="pre">PAR2_ENABLE_CUDA_CHECKS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#c.PAR2_ENABLE_NAN_GUARDS"><code class="docutils literal notranslate"><span class="pre">PAR2_ENABLE_NAN_GUARDS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#c.PAR2_ENABLE_BOUNDS_CHECKS"><code class="docutils literal notranslate"><span class="pre">PAR2_ENABLE_BOUNDS_CHECKS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#c.PAR2_DEBUG_ONLY"><code class="docutils literal notranslate"><span class="pre">PAR2_DEBUG_ONLY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#c.PAR2_NAN_GUARD"><code class="docutils literal notranslate"><span class="pre">PAR2_NAN_GUARD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/index.html#c.PAR2_DEVICE_ASSERT"><code class="docutils literal notranslate"><span class="pre">PAR2_DEVICE_ASSERT</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/semantic_map.html">Semantic Map — Par2_Core Contracts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#public-api-tree">1  Public API Tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#engine-lifecycle-state-machine">2  Engine Lifecycle (State Machine)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#memory-contracts-gpu-native">3  Memory Contracts (GPU-Native)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#ownership-rules">3.1  Ownership Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#device-pointer-layout">3.2  Device Pointer Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#workspace-growth-policy">3.3  Workspace Growth Policy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#stream-and-event-semantics">4  Stream and Event Semantics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#stream-usage">4.1  Stream Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#event-integration">4.2  Event Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#execution-order-guarantee">4.3  Execution Order Guarantee</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#boundary-conditions">5  Boundary Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#per-axis-per-face-configuration">5.1  Per-Axis, Per-Face Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#closed-reflective">5.2  Closed (Reflective)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#periodic-wrap-around">5.3  Periodic (Wrap-Around)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#open-exit">5.4  Open (Exit)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#d-mode">5.5  2D Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#rng-and-determinism">6  RNG and Determinism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#initialization">6.1  Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#per-step-usage">6.2  Per-Step Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#reproducibility-guarantees">6.3  Reproducibility Guarantees</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#outputs-stats-and-snapshots">7  Outputs, Stats, and Snapshots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#position-data">7.1  Position Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#unwrapped-positions">7.2  Unwrapped Positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#statistics">7.3  Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#csv-snapshots">7.4  CSV Snapshots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#snapshot-timing">7.5  Snapshot Timing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#thread-safety">8  Thread Safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#rwpt-algorithm-mathematical-formulation">9  RWPT Algorithm (Mathematical Formulation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#velocity-layout-and-interpolation">10  Velocity Layout and Interpolation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#staggered-mac-grid-facefield">10.1  Staggered MAC Grid (FaceField)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#linear-interpolation-interpolationmode-linear">10.2  Linear Interpolation (InterpolationMode::Linear)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#trilinear-interpolation-interpolationmode-trilinear">10.3  Trilinear Interpolation (InterpolationMode::Trilinear)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#corner-velocity-computation">10.4  Corner Velocity Computation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#dispersion-tensor-and-displacement-matrix">11  Dispersion Tensor and Displacement Matrix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#dispersion-tensor-d">11.1  Dispersion Tensor D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#displacement-matrix-b">11.2  Displacement Matrix B</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#zerovelocity-handling">11.3  Zero‑Velocity Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#specialcase-dispatching">11.4  Special‑Case Dispatching</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#nan-prevention-flag">11.5  <code class="docutils literal notranslate"><span class="pre">nan_prevention</span></code> Flag</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#drift-correction-algorithms">12  Drift Correction Algorithms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#trilinearonfly-mode">12.1  TrilinearOnFly Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#precomputed-mode-finite-differences">12.2  Precomputed Mode (Finite Differences)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#performance-contracts">13  Performance Contracts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#allocationfree-stepping">13.1  Allocation‑Free Stepping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#kernel-launch-configuration">13.2  Kernel Launch Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#memory-access-pattern">13.3  Memory Access Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#known-limitations">13.4  Known Limitations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../references.html#primary-reference">Primary reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references.html#equation-cross-reference">Equation cross-reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#rwpt-theory">RWPT theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#gpu-cuda">GPU / CUDA</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Par2_Core</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">User Guide</a></li>
      <li class="breadcrumb-item active">Pipeline Recipes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user/pipeline_recipes.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pipeline-recipes">
<h1>Pipeline Recipes<a class="headerlink" href="#pipeline-recipes" title="Link to this heading"></a></h1>
<p>Par2_Core is designed to slot into multi-solver GPU pipelines.
The engine <strong>never</strong> calls <code class="docutils literal notranslate"><span class="pre">cudaDeviceSynchronize()</span></code>.
All kernel work is enqueued on the engine’s CUDA stream and returns
immediately — the CPU is free to post work to other streams or do I/O.</p>
<p>This page provides two copy-pasteable integration patterns.</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#recipe-a-single-stream-simple" id="id4">Recipe A — Single stream (simple)</a></p>
<ul>
<li><p><a class="reference internal" href="#setup" id="id5">Setup</a></p></li>
<li><p><a class="reference internal" href="#hot-loop" id="id6">Hot loop</a></p></li>
<li><p><a class="reference internal" href="#key-points" id="id7">Key points</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#recipe-b-multi-stream-with-events" id="id8">Recipe B — Multi-stream with events</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id9">Setup</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id10">Hot loop</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id11">Key points</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#velocity-updates-between-steps" id="id12">Velocity updates between steps</a></p></li>
<li><p><a class="reference internal" href="#extracting-results" id="id13">Extracting results</a></p>
<ul>
<li><p><a class="reference internal" href="#positions" id="id14">Positions</a></p></li>
<li><p><a class="reference internal" href="#statistics" id="id15">Statistics</a></p></li>
<li><p><a class="reference internal" href="#unwrapped-positions-periodic-bc" id="id16">Unwrapped positions (periodic BC)</a></p></li>
</ul>
</li>
</ul>
</nav>
<hr class="docutils" />
<section id="recipe-a-single-stream-simple">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Recipe A — Single stream (simple)</a><a class="headerlink" href="#recipe-a-single-stream-simple" title="Link to this heading"></a></h2>
<p>Use this when there is <strong>one</strong> GPU solver feeding velocity to the engine
and no other solvers need to run concurrently.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Flow solver writes U/V/W  ──►  engine.step(dt)  ──►  read positions
                     ↕ all on the same stream ↕
</pre></div>
</div>
<section id="setup">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Setup</a><a class="headerlink" href="#setup" title="Link to this heading"></a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Engine on default stream (or your solver&#39;s stream)</span>
<span class="n">par2</span><span class="o">::</span><span class="n">TransportEngine</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">engine</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">config</span><span class="p">);</span>
<span class="n">engine</span><span class="p">.</span><span class="n">set_stream</span><span class="p">(</span><span class="n">my_stream</span><span class="p">);</span><span class="w">       </span><span class="c1">// optional</span>

<span class="n">engine</span><span class="p">.</span><span class="n">bind_velocity</span><span class="p">({</span><span class="n">d_U</span><span class="p">,</span><span class="w"> </span><span class="n">d_V</span><span class="p">,</span><span class="w"> </span><span class="n">d_W</span><span class="p">,</span><span class="w"> </span><span class="n">num_corners</span><span class="p">});</span>
<span class="n">engine</span><span class="p">.</span><span class="n">bind_particles</span><span class="p">({</span><span class="n">d_x</span><span class="p">,</span><span class="w"> </span><span class="n">d_y</span><span class="p">,</span><span class="w"> </span><span class="n">d_z</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">});</span>
<span class="n">engine</span><span class="p">.</span><span class="n">inject_box</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">,</span><span class="w"> </span><span class="n">z0</span><span class="p">,</span><span class="w"> </span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">y1</span><span class="p">,</span><span class="w"> </span><span class="n">z1</span><span class="p">);</span>
<span class="n">engine</span><span class="p">.</span><span class="n">prepare</span><span class="p">();</span><span class="w">                   </span><span class="c1">// allocations happen HERE</span>
</pre></div>
</div>
</section>
<section id="hot-loop">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Hot loop</a><a class="headerlink" href="#hot-loop" title="Link to this heading"></a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_steps</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Your solver writes velocity into d_U, d_V, d_W</span>
<span class="w">    </span><span class="c1">// (same stream — ordering is automatic)</span>
<span class="w">    </span><span class="n">flow_solver_kernel</span><span class="o">&lt;&lt;&lt;</span><span class="p">...,</span><span class="w"> </span><span class="n">my_stream</span><span class="o">&gt;&gt;&gt;</span><span class="p">(</span><span class="n">d_U</span><span class="p">,</span><span class="w"> </span><span class="n">d_V</span><span class="p">,</span><span class="w"> </span><span class="n">d_W</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>

<span class="w">    </span><span class="c1">// If using Trilinear or Precomputed drift: recompute derived fields</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">engine</span><span class="p">.</span><span class="n">needs_corner_update</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">engine</span><span class="p">.</span><span class="n">needs_drift_update</span><span class="p">())</span>
<span class="w">        </span><span class="n">engine</span><span class="p">.</span><span class="n">update_derived_fields</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Step — async, zero-alloc, returns immediately</span>
<span class="w">    </span><span class="n">engine</span><span class="p">.</span><span class="n">step</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Another kernel can consume d_x, d_y, d_z on the same stream</span>
<span class="w">    </span><span class="c1">// (positions are updated in-place after step completes on GPU)</span>
<span class="w">    </span><span class="n">reactive_kernel</span><span class="o">&lt;&lt;&lt;</span><span class="p">...,</span><span class="w"> </span><span class="n">my_stream</span><span class="o">&gt;&gt;&gt;</span><span class="p">(</span><span class="n">d_x</span><span class="p">,</span><span class="w"> </span><span class="n">d_y</span><span class="p">,</span><span class="w"> </span><span class="n">d_z</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
<span class="p">}</span>

<span class="c1">// Sync ONLY when the host needs results</span>
<span class="n">engine</span><span class="p">.</span><span class="n">synchronize</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="key-points">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Key points</a><a class="headerlink" href="#key-points" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">step()</span></code> <strong>does not synchronize</strong>. It enqueues a kernel and returns.</p></li>
<li><p>Everything on the same stream executes in FIFO order on the GPU — no
events needed.</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">engine.synchronize()</span></code> (or <code class="docutils literal notranslate"><span class="pre">cudaStreamSynchronize</span></code>)
<strong>only</strong> when the CPU must read results (stats, snapshot, end of run).</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="recipe-b-multi-stream-with-events">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Recipe B — Multi-stream with events</a><a class="headerlink" href="#recipe-b-multi-stream-with-events" title="Link to this heading"></a></h2>
<p>Use this when the flow solver and transport run on <strong>separate</strong> streams
so their GPU work can overlap.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>stream_flow:       ┌─ update_velocity ──► record(vel_ready) ─────────────────┐
                   │                                                          │
stream_transport:  │── wait(vel_ready) ──► update_derived ──► step(dt) ──►    │
                   │                          record(transport_done) ────┐    │
                   │                                                     │    │
stream_reactive:   └────────── wait(transport_done) ──► react_kernel ────┘    │
                                                                              │
                   └──────────────────── next iteration ──────────────────────┘
</pre></div>
</div>
<section id="id1">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Setup</a><a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create streams</span>
<span class="n">cudaStream_t</span><span class="w"> </span><span class="n">stream_flow</span><span class="p">,</span><span class="w"> </span><span class="n">stream_transport</span><span class="p">;</span>
<span class="n">cudaStreamCreate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">stream_flow</span><span class="p">);</span>
<span class="n">cudaStreamCreate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">stream_transport</span><span class="p">);</span>

<span class="c1">// Create events (disable timing for lower overhead)</span>
<span class="n">cudaEvent_t</span><span class="w"> </span><span class="n">vel_ready</span><span class="p">,</span><span class="w"> </span><span class="n">transport_done</span><span class="p">;</span>
<span class="n">cudaEventCreateWithFlags</span><span class="p">(</span><span class="o">&amp;</span><span class="n">vel_ready</span><span class="p">,</span><span class="w">       </span><span class="n">cudaEventDisableTiming</span><span class="p">);</span>
<span class="n">cudaEventCreateWithFlags</span><span class="p">(</span><span class="o">&amp;</span><span class="n">transport_done</span><span class="p">,</span><span class="w">  </span><span class="n">cudaEventDisableTiming</span><span class="p">);</span>

<span class="c1">// Assign transport stream to engine</span>
<span class="n">engine</span><span class="p">.</span><span class="n">set_stream</span><span class="p">(</span><span class="n">stream_transport</span><span class="p">);</span>
<span class="n">engine</span><span class="p">.</span><span class="n">prepare</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="id2">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Hot loop</a><a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_steps</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// (a) Flow solver updates velocity on stream_flow</span>
<span class="w">    </span><span class="n">flow_kernel</span><span class="o">&lt;&lt;&lt;</span><span class="p">...,</span><span class="w"> </span><span class="n">stream_flow</span><span class="o">&gt;&gt;&gt;</span><span class="p">(</span><span class="n">d_U</span><span class="p">,</span><span class="w"> </span><span class="n">d_V</span><span class="p">,</span><span class="w"> </span><span class="n">d_W</span><span class="p">,</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
<span class="w">    </span><span class="n">cudaEventRecord</span><span class="p">(</span><span class="n">vel_ready</span><span class="p">,</span><span class="w"> </span><span class="n">stream_flow</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// (b) Transport waits for velocity, then steps</span>
<span class="w">    </span><span class="n">engine</span><span class="p">.</span><span class="n">wait_event</span><span class="p">(</span><span class="n">vel_ready</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">engine</span><span class="p">.</span><span class="n">needs_corner_update</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">engine</span><span class="p">.</span><span class="n">needs_drift_update</span><span class="p">())</span>
<span class="w">        </span><span class="n">engine</span><span class="p">.</span><span class="n">update_derived_fields</span><span class="p">();</span>

<span class="w">    </span><span class="n">engine</span><span class="p">.</span><span class="n">step</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
<span class="w">    </span><span class="n">engine</span><span class="p">.</span><span class="n">record_event</span><span class="p">(</span><span class="n">transport_done</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// (c) Optional: another solver waits for transport</span>
<span class="w">    </span><span class="c1">// cudaStreamWaitEvent(stream_reactive, transport_done, 0);</span>
<span class="p">}</span>

<span class="n">engine</span><span class="p">.</span><span class="n">synchronize</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Key points</a><a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">engine.wait_event(evt)</span></code> is a GPU-side dependency — the <strong>CPU never
blocks</strong>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">engine.record_event(evt)</span></code> marks completion on the transport stream
so downstream streams can wait on it.</p></li>
<li><p>The CPU posts all work and moves on immediately. Synchronize only for
host-side reads.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cudaEventCreateWithFlags(...,</span> <span class="pre">cudaEventDisableTiming)</span></code> skips the
timing circuitry → lower overhead for pure ordering events.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="velocity-updates-between-steps">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Velocity updates between steps</a><a class="headerlink" href="#velocity-updates-between-steps" title="Link to this heading"></a></h2>
<p>When velocity changes between steps (time-dependent flow), the engine
must update internal derived fields before the next <code class="docutils literal notranslate"><span class="pre">step()</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// After velocity changes on GPU:</span>
<span class="n">engine</span><span class="p">.</span><span class="n">bind_velocity</span><span class="p">({</span><span class="n">d_U</span><span class="p">,</span><span class="w"> </span><span class="n">d_V</span><span class="p">,</span><span class="w"> </span><span class="n">d_W</span><span class="p">,</span><span class="w"> </span><span class="n">num_corners</span><span class="p">});</span><span class="w">  </span><span class="c1">// re-bind</span>
<span class="n">engine</span><span class="p">.</span><span class="n">update_derived_fields</span><span class="p">();</span><span class="w">                        </span><span class="c1">// recompute corners / drift</span>
<span class="n">engine</span><span class="p">.</span><span class="n">step</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
</pre></div>
</div>
<p>When the velocity pointers <strong>do not change</strong> (same buffers, new values
written by a kernel), <code class="docutils literal notranslate"><span class="pre">bind_velocity</span></code> is not needed — but
<code class="docutils literal notranslate"><span class="pre">update_derived_fields()</span></code> is still required if
<code class="docutils literal notranslate"><span class="pre">needs_corner_update()</span></code> or <code class="docutils literal notranslate"><span class="pre">needs_drift_update()</span></code> returns <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">update_derived_fields()</span></code> is async and zero-alloc. It is safe to
call on every iteration — it is a no-op when the engine uses
<code class="docutils literal notranslate"><span class="pre">InterpolationMode::Linear</span></code> with <code class="docutils literal notranslate"><span class="pre">DriftCorrectionMode::None</span></code>.</p>
</div>
</section>
<hr class="docutils" />
<section id="extracting-results">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Extracting results</a><a class="headerlink" href="#extracting-results" title="Link to this heading"></a></h2>
<section id="positions">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Positions</a><a class="headerlink" href="#positions" title="Link to this heading"></a></h3>
<p>Particle positions live <strong>in your device buffers</strong> (<code class="docutils literal notranslate"><span class="pre">d_x</span></code>, <code class="docutils literal notranslate"><span class="pre">d_y</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_z</span></code>). After synchronizing the transport stream:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span><span class="p">.</span><span class="n">synchronize</span><span class="p">();</span><span class="w">   </span><span class="c1">// or cudaStreamSynchronize(transport_stream)</span>

<span class="c1">// Option A: direct cudaMemcpy</span>
<span class="n">cudaMemcpy</span><span class="p">(</span><span class="n">h_x</span><span class="p">,</span><span class="w"> </span><span class="n">d_x</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">),</span><span class="w"> </span><span class="n">cudaMemcpyDeviceToHost</span><span class="p">);</span>

<span class="c1">// Option B: async with pinned memory (preferred for HPC)</span>
<span class="n">cudaMemcpyAsync</span><span class="p">(</span><span class="n">h_x</span><span class="p">,</span><span class="w"> </span><span class="n">d_x</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">),</span>
<span class="w">                </span><span class="n">cudaMemcpyDeviceToHost</span><span class="p">,</span><span class="w"> </span><span class="n">transport_stream</span><span class="p">);</span>
<span class="n">cudaStreamSynchronize</span><span class="p">(</span><span class="n">transport_stream</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="statistics">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Statistics</a><a class="headerlink" href="#statistics" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">StatsComputer</span></code> performs GPU reductions — only 6 doubles (mean + var,
per axis) are copied to the host:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">par2</span><span class="o">::</span><span class="n">StatsComputer</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stats</span><span class="p">(</span><span class="n">N</span><span class="p">);</span><span class="w">   </span><span class="c1">// pre-allocates reduction buffers</span>
<span class="n">par2</span><span class="o">::</span><span class="n">StatsConfig</span><span class="w"> </span><span class="n">cfg</span><span class="p">;</span>
<span class="n">cfg</span><span class="p">.</span><span class="n">filter_active_only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">          </span><span class="c1">// skip exited particles</span>

<span class="n">stats</span><span class="p">.</span><span class="n">compute_async</span><span class="p">(</span><span class="n">engine</span><span class="p">.</span><span class="n">particles</span><span class="p">(),</span><span class="w"> </span><span class="n">grid</span><span class="p">,</span><span class="w"> </span><span class="n">cfg</span><span class="p">,</span><span class="w"> </span><span class="n">transport_stream</span><span class="p">);</span>
<span class="n">cudaStreamSynchronize</span><span class="p">(</span><span class="n">transport_stream</span><span class="p">);</span>
<span class="k">auto</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stats</span><span class="p">.</span><span class="n">fetch_result</span><span class="p">();</span>
<span class="c1">// r.moments.mean[0], r.moments.var[0], r.moments.std[0], ...</span>
</pre></div>
</div>
</section>
<section id="unwrapped-positions-periodic-bc">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Unwrapped positions (periodic BC)</a><a class="headerlink" href="#unwrapped-positions-periodic-bc" title="Link to this heading"></a></h3>
<p>With periodic boundaries, particles wrap around the domain. To recover
continuous trajectories:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Allocate once</span>
<span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">d_xu</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">d_yu</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">d_zu</span><span class="p">;</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_xu</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_yu</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_zu</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
<span class="n">par2</span><span class="o">::</span><span class="n">UnwrappedPositionsView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unwrap</span><span class="p">{</span><span class="n">d_xu</span><span class="p">,</span><span class="w"> </span><span class="n">d_yu</span><span class="p">,</span><span class="w"> </span><span class="n">d_zu</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">};</span>

<span class="c1">// After each step (or when needed):</span>
<span class="n">engine</span><span class="p">.</span><span class="n">compute_unwrapped_positions</span><span class="p">(</span><span class="n">unwrap</span><span class="p">);</span>
<span class="n">engine</span><span class="p">.</span><span class="n">synchronize</span><span class="p">();</span>
<span class="c1">// d_xu now contains: x + wrapX * Lx</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="memory_contract.html" class="btn btn-neutral float-right" title="Memory Contract" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Par2_Core contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>