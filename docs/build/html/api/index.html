

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; Par2_Core Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "displayMath": [["$$", "$$"], ["\\[", "\\]"]]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Semantic Map — Par2_Core Contracts" href="../dev/semantic_map.html" />
    <link rel="prev" title="Performance Notes" href="../hpc/performance_notes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Par2_Core
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/quickstart.html">Quick Start</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/quickstart.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/quickstart.html#build-the-library">Build the library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/quickstart.html#build-with-examples">Build with examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/quickstart.html#link-from-your-own-cmake-project">Link from your own CMake project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/quickstart.html#minimal-code">Minimal code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/quickstart.html#cmake-options-reference">CMake options reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/pipeline_recipes.html">Pipeline Recipes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/pipeline_recipes.html#recipe-a-single-stream-simple">Recipe A — Single stream (simple)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/pipeline_recipes.html#setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/pipeline_recipes.html#hot-loop">Hot loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/pipeline_recipes.html#key-points">Key points</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/pipeline_recipes.html#recipe-b-multi-stream-with-events">Recipe B — Multi-stream with events</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/pipeline_recipes.html#id1">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/pipeline_recipes.html#id2">Hot loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/pipeline_recipes.html#id3">Key points</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/pipeline_recipes.html#velocity-updates-between-steps">Velocity updates between steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/pipeline_recipes.html#extracting-results">Extracting results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/pipeline_recipes.html#positions">Positions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/pipeline_recipes.html#statistics">Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/pipeline_recipes.html#unwrapped-positions-periodic-bc">Unwrapped positions (periodic BC)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/memory_contract.html">Memory Contract</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/memory_contract.html#core-principle-views-are-non-owning">Core principle: views are non-owning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/memory_contract.html#velocity-fields">Velocity fields</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/memory_contract.html#layout">Layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/memory_contract.html#allocation">Allocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/memory_contract.html#lifetime">Lifetime</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/memory_contract.html#particles">Particles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/memory_contract.html#layout-structure-of-arrays-soa">Layout: Structure of Arrays (SoA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/memory_contract.html#id1">Allocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/memory_contract.html#id2">Lifetime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/memory_contract.html#status-array-open-bc">Status array (Open BC)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/memory_contract.html#wrap-counters-periodic-bc">Wrap counters (Periodic BC)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/memory_contract.html#unwrapped-positions">Unwrapped positions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/memory_contract.html#what-they-are">What they are</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/memory_contract.html#how-to-compute">How to compute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/memory_contract.html#cost">Cost</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/memory_contract.html#engine-owned-temporaries">Engine-owned temporaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/memory_contract.html#prohibitions">Prohibitions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/performance_tips.html">Performance Tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user/performance_tips.html#prepare-once-step-many">1. <code class="docutils literal notranslate"><span class="pre">prepare()</span></code> once, <code class="docutils literal notranslate"><span class="pre">step()</span></code> many</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/performance_tips.html#reuse-engine-and-workspace">2. Reuse engine and workspace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/performance_tips.html#no-allocs-no-syncs-in-step">3. No allocs, no syncs in <code class="docutils literal notranslate"><span class="pre">step()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/performance_tips.html#streams-and-events-beat-global-sync">4. Streams and events beat global sync</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/performance_tips.html#know-the-hotspots">5. Know the hotspots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user/performance_tips.html#cuda-tips">6. CUDA tips</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user/performance_tips.html#cudamallocasync-for-workspace"><code class="docutils literal notranslate"><span class="pre">cudaMallocAsync</span></code> for workspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/performance_tips.html#avoid-unnecessary-atomics">Avoid unnecessary atomics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/performance_tips.html#prefer-soa">Prefer SoA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/performance_tips.html#pinned-host-memory-for-snapshots">Pinned host memory for snapshots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user/performance_tips.html#block-size">Block size</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user/performance_tips.html#debug-vs-release">7. Debug vs release</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Scientific Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../theory/rwpt.html">RWPT: From ADE to Stochastic Particles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/rwpt.html#the-advectiondispersion-equation">The Advection–Dispersion Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/rwpt.html#equivalent-ito-sde">Equivalent Itô SDE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../theory/rwpt.html#the-drift-vector">The drift vector</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../theory/rwpt.html#itotaylor-stepping-scheme">Itô–Taylor Stepping Scheme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/rwpt.html#per-particle-kernel-algorithm">Per-particle kernel algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/rwpt.html#source">Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/rwpt.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory/dispersion_tensor.html">Dispersion Tensor</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/dispersion_tensor.html#eigenvalues">Eigenvalues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/dispersion_tensor.html#displacement-matrix-mathbf-b">Displacement Matrix <span class="math notranslate nohighlight">\(\mathbf{B}\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/dispersion_tensor.html#special-case-dispatching">Special-Case Dispatching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/dispersion_tensor.html#zero-velocity-handling">Zero-Velocity Handling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory/displacement_matrix.html">Displacement Matrix <span class="math notranslate nohighlight">\(\mathbf{B}\)</span></a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#algebraic-setup">Algebraic setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#eigenvalues">Eigenvalues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#eigenvectors">Eigenvectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#gamma-coefficients-and-assembly">Gamma coefficients and assembly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#special-cases">Special cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#zero-velocity-handling">Zero-velocity handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#hpc-motivation">HPC motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/displacement_matrix.html#source">Source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory/drift_correction.html">Drift Correction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/drift_correction.html#par2-core-modes">Par2_Core Modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../theory/drift_correction.html#trilinearonfly-derivatives">TrilinearOnFly Derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../theory/drift_correction.html#precomputed-finite-difference-stencil">Precomputed Finite-Difference Stencil</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../theory/drift_correction.html#source">Source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory/interpolation.html">Velocity Interpolation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/interpolation.html#linear-face-centred">Linear (Face-Centred)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/interpolation.html#trilinear-corner-based">Trilinear (Corner-Based)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/interpolation.html#choosing-a-mode">Choosing a Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/interpolation.html#source">Source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory/boundaries.html">Boundary Conditions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/boundaries.html#wrap-counters-periodic">Wrap Counters (Periodic)</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">HPC / GPU Architecture</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hpc/memory_layout.html">Memory Layout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hpc/memory_layout.html#grid-indexing">Grid Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/memory_layout.html#particle-storage-soa">Particle Storage (SoA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/memory_layout.html#velocity-views-zero-copy">Velocity Views (Zero-Copy)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/streams_events.html">CUDA Streams &amp; Events</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hpc/streams_events.html#stream-ownership">Stream Ownership</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/streams_events.html#event-based-synchronisation">Event-Based Synchronisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/streams_events.html#double-buffered-velocity-pattern">Double-Buffered Velocity Pattern</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/workspace_allocs.html">Workspace Allocations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hpc/workspace_allocs.html#prepare-vs-step"><code class="docutils literal notranslate"><span class="pre">prepare()</span></code> vs <code class="docutils literal notranslate"><span class="pre">step()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/workspace_allocs.html#what-prepare-allocates">What <code class="docutils literal notranslate"><span class="pre">prepare()</span></code> Allocates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/workspace_allocs.html#growth-policy">Growth Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/workspace_allocs.html#cudamallocasync-cuda-11-2"><code class="docutils literal notranslate"><span class="pre">cudaMallocAsync</span></code> (CUDA ≥ 11.2)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/rng_reproducibility.html">RNG &amp; Reproducibility</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hpc/rng_reproducibility.html#random-number-generation">Random Number Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/rng_reproducibility.html#seeding">Seeding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/rng_reproducibility.html#reproducibility-guarantees">Reproducibility Guarantees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/rng_reproducibility.html#correlation-risks">Correlation risks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/performance_notes.html">Performance Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hpc/performance_notes.html#kernel-block-size">Kernel Block Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/performance_notes.html#arithmetic-intensity">Arithmetic Intensity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/performance_notes.html#debug-vs-release">Debug vs Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/performance_notes.html#allocation-free-stepping">Allocation-Free Stepping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hpc/performance_notes.html#known-limitations">Known Limitations</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-to-integrate-tl-dr">How to integrate (TL;DR)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#core-engine">Core Engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv44par2"><code class="docutils literal notranslate"><span class="pre">par2</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE"><code class="docutils literal notranslate"><span class="pre">par2::TransportEngine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par26detailE"><code class="docutils literal notranslate"><span class="pre">par2::detail</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#types-configuration">Types &amp; Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N4par212BoundaryTypeE"><code class="docutils literal notranslate"><span class="pre">BoundaryType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212BoundaryType6ClosedE"><code class="docutils literal notranslate"><span class="pre">Closed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212BoundaryType8PeriodicE"><code class="docutils literal notranslate"><span class="pre">Periodic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212BoundaryType4OpenE"><code class="docutils literal notranslate"><span class="pre">Open</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N4par217InterpolationModeE"><code class="docutils literal notranslate"><span class="pre">InterpolationMode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par217InterpolationMode6LinearE"><code class="docutils literal notranslate"><span class="pre">Linear</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par217InterpolationMode9TrilinearE"><code class="docutils literal notranslate"><span class="pre">Trilinear</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N4par219DriftCorrectionModeE"><code class="docutils literal notranslate"><span class="pre">DriftCorrectionMode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par219DriftCorrectionMode4NoneE"><code class="docutils literal notranslate"><span class="pre">None</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par219DriftCorrectionMode11PrecomputedE"><code class="docutils literal notranslate"><span class="pre">Precomputed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par219DriftCorrectionMode14TrilinearOnFlyE"><code class="docutils literal notranslate"><span class="pre">TrilinearOnFly</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N4par214ParticleStatusE"><code class="docutils literal notranslate"><span class="pre">ParticleStatus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214ParticleStatus6ActiveE"><code class="docutils literal notranslate"><span class="pre">Active</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214ParticleStatus6ExitedE"><code class="docutils literal notranslate"><span class="pre">Exited</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214ParticleStatus8InactiveE"><code class="docutils literal notranslate"><span class="pre">Inactive</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N4par212EngineConfigE"><code class="docutils literal notranslate"><span class="pre">par2::EngineConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212EngineConfig18interpolation_modeE"><code class="docutils literal notranslate"><span class="pre">interpolation_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212EngineConfig10drift_modeE"><code class="docutils literal notranslate"><span class="pre">drift_mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212EngineConfig8rng_seedE"><code class="docutils literal notranslate"><span class="pre">rng_seed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212EngineConfig17kernel_block_sizeE"><code class="docutils literal notranslate"><span class="pre">kernel_block_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212EngineConfig12debug_checksE"><code class="docutils literal notranslate"><span class="pre">debug_checks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212EngineConfig14nan_preventionE"><code class="docutils literal notranslate"><span class="pre">nan_prevention</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par29StepStatsE"><code class="docutils literal notranslate"><span class="pre">par2::StepStats</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par29StepStats16active_particlesE"><code class="docutils literal notranslate"><span class="pre">active_particles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par29StepStats16exited_particlesE"><code class="docutils literal notranslate"><span class="pre">exited_particles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par29StepStats16max_displacementE"><code class="docutils literal notranslate"><span class="pre">max_displacement</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par215TransportParamsE"><code class="docutils literal notranslate"><span class="pre">par2::TransportParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par215TransportParams14has_dispersionEv"><code class="docutils literal notranslate"><span class="pre">has_dispersion()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par215TransportParams19molecular_diffusionE"><code class="docutils literal notranslate"><span class="pre">molecular_diffusion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par215TransportParams7alpha_lE"><code class="docutils literal notranslate"><span class="pre">alpha_l</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par215TransportParams7alpha_tE"><code class="docutils literal notranslate"><span class="pre">alpha_t</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#grid">Grid</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T"><code class="docutils literal notranslate"><span class="pre">make_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par217make_uniform_gridE8GridDescI1TEiii1T1T1T1T"><code class="docutils literal notranslate"><span class="pre">make_uniform_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE"><code class="docutils literal notranslate"><span class="pre">par2::GridDesc</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par28GridDesc9num_cellsEv"><code class="docutils literal notranslate"><span class="pre">num_cells()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par28GridDesc11num_cornersEv"><code class="docutils literal notranslate"><span class="pre">num_corners()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par28GridDesc8length_xEv"><code class="docutils literal notranslate"><span class="pre">length_x()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par28GridDesc8length_yEv"><code class="docutils literal notranslate"><span class="pre">length_y()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par28GridDesc8length_zEv"><code class="docutils literal notranslate"><span class="pre">length_z()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par28GridDesc11cell_volumeEv"><code class="docutils literal notranslate"><span class="pre">cell_volume()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par28GridDesc13domain_volumeEv"><code class="docutils literal notranslate"><span class="pre">domain_volume()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par28GridDesc5is_2dEv"><code class="docutils literal notranslate"><span class="pre">is_2d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par28GridDesc5x_maxEv"><code class="docutils literal notranslate"><span class="pre">x_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par28GridDesc5y_maxEv"><code class="docutils literal notranslate"><span class="pre">y_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par28GridDesc5z_maxEv"><code class="docutils literal notranslate"><span class="pre">z_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par28GridDesc2nxE"><code class="docutils literal notranslate"><span class="pre">nx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par28GridDesc2nyE"><code class="docutils literal notranslate"><span class="pre">ny</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par28GridDesc2nzE"><code class="docutils literal notranslate"><span class="pre">nz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par28GridDesc2dxE"><code class="docutils literal notranslate"><span class="pre">dx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par28GridDesc2dyE"><code class="docutils literal notranslate"><span class="pre">dy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par28GridDesc2dzE"><code class="docutils literal notranslate"><span class="pre">dz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par28GridDesc2pxE"><code class="docutils literal notranslate"><span class="pre">px</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par28GridDesc2pyE"><code class="docutils literal notranslate"><span class="pre">py</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par28GridDesc2pzE"><code class="docutils literal notranslate"><span class="pre">pz</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#views-zero-copy-binding">Views (Zero-Copy Binding)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par215ConstDeviceSpanE"><code class="docutils literal notranslate"><span class="pre">ConstDeviceSpan</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE"><code class="docutils literal notranslate"><span class="pre">par2::ConstParticlesView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par218ConstParticlesView5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par218ConstParticlesView18ConstParticlesViewEv"><code class="docutils literal notranslate"><span class="pre">ConstParticlesView()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par218ConstParticlesView18ConstParticlesViewERK13ParticlesViewI1TE"><code class="docutils literal notranslate"><span class="pre">ConstParticlesView()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par218ConstParticlesView1xE"><code class="docutils literal notranslate"><span class="pre">x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par218ConstParticlesView1yE"><code class="docutils literal notranslate"><span class="pre">y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par218ConstParticlesView1zE"><code class="docutils literal notranslate"><span class="pre">z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par218ConstParticlesView1nE"><code class="docutils literal notranslate"><span class="pre">n</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par218ConstParticlesView6statusE"><code class="docutils literal notranslate"><span class="pre">status</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par218ConstParticlesView5wrapXE"><code class="docutils literal notranslate"><span class="pre">wrapX</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par218ConstParticlesView5wrapYE"><code class="docutils literal notranslate"><span class="pre">wrapY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par218ConstParticlesView5wrapZE"><code class="docutils literal notranslate"><span class="pre">wrapZ</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par210DeviceSpanE"><code class="docutils literal notranslate"><span class="pre">par2::DeviceSpan</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par210DeviceSpan5emptyEv"><code class="docutils literal notranslate"><span class="pre">empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par210DeviceSpan5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par210DeviceSpan4dataE"><code class="docutils literal notranslate"><span class="pre">data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par210DeviceSpan4sizeE"><code class="docutils literal notranslate"><span class="pre">size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par219DriftCorrectionViewE"><code class="docutils literal notranslate"><span class="pre">par2::DriftCorrectionView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par219DriftCorrectionView5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par219DriftCorrectionView3dcxE"><code class="docutils literal notranslate"><span class="pre">dcx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par219DriftCorrectionView3dcyE"><code class="docutils literal notranslate"><span class="pre">dcy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par219DriftCorrectionView3dczE"><code class="docutils literal notranslate"><span class="pre">dcz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par219DriftCorrectionView4sizeE"><code class="docutils literal notranslate"><span class="pre">size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par213ParticlesViewE"><code class="docutils literal notranslate"><span class="pre">par2::ParticlesView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par213ParticlesView5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par213ParticlesView10has_statusEv"><code class="docutils literal notranslate"><span class="pre">has_status()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par213ParticlesView10has_wrap_xEv"><code class="docutils literal notranslate"><span class="pre">has_wrap_x()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par213ParticlesView10has_wrap_yEv"><code class="docutils literal notranslate"><span class="pre">has_wrap_y()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par213ParticlesView10has_wrap_zEv"><code class="docutils literal notranslate"><span class="pre">has_wrap_z()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par213ParticlesView12has_any_wrapEv"><code class="docutils literal notranslate"><span class="pre">has_any_wrap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213ParticlesView1xE"><code class="docutils literal notranslate"><span class="pre">x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213ParticlesView1yE"><code class="docutils literal notranslate"><span class="pre">y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213ParticlesView1zE"><code class="docutils literal notranslate"><span class="pre">z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213ParticlesView1nE"><code class="docutils literal notranslate"><span class="pre">n</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213ParticlesView6statusE"><code class="docutils literal notranslate"><span class="pre">status</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213ParticlesView5wrapXE"><code class="docutils literal notranslate"><span class="pre">wrapX</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213ParticlesView5wrapYE"><code class="docutils literal notranslate"><span class="pre">wrapY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213ParticlesView5wrapZE"><code class="docutils literal notranslate"><span class="pre">wrapZ</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par222UnwrappedPositionsViewE"><code class="docutils literal notranslate"><span class="pre">par2::UnwrappedPositionsView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par222UnwrappedPositionsView5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par222UnwrappedPositionsView3x_uE"><code class="docutils literal notranslate"><span class="pre">x_u</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par222UnwrappedPositionsView3y_uE"><code class="docutils literal notranslate"><span class="pre">y_u</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par222UnwrappedPositionsView3z_uE"><code class="docutils literal notranslate"><span class="pre">z_u</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par222UnwrappedPositionsView8capacityE"><code class="docutils literal notranslate"><span class="pre">capacity</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#velocity-layout">Velocity Layout</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par212VelocityViewE"><code class="docutils literal notranslate"><span class="pre">VelocityView</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par218CornerVelocityViewE"><code class="docutils literal notranslate"><span class="pre">CornerVelocityView</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N4par28merge_idEiiiii"><code class="docutils literal notranslate"><span class="pre">merge_id()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N4par210field_sizeEiii"><code class="docutils literal notranslate"><span class="pre">field_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par210field_sizeE6size_tRK8GridDescI1TE"><code class="docutils literal notranslate"><span class="pre">field_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I00EN4par219validate_face_fieldEvRK13FaceFieldViewI1TERK8GridDescI5GridTE"><code class="docutils literal notranslate"><span class="pre">validate_face_field()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I00EN4par221validate_corner_fieldEvRK15CornerFieldViewI1TERK8GridDescI5GridTE"><code class="docutils literal notranslate"><span class="pre">validate_corner_field()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par215CornerFieldViewE"><code class="docutils literal notranslate"><span class="pre">par2::CornerFieldView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par215CornerFieldView5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0ENK4par215CornerFieldView12matches_gridEbRK8GridDescI5GridTE"><code class="docutils literal notranslate"><span class="pre">matches_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par215CornerFieldView2UcE"><code class="docutils literal notranslate"><span class="pre">Uc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par215CornerFieldView2VcE"><code class="docutils literal notranslate"><span class="pre">Vc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par215CornerFieldView2WcE"><code class="docutils literal notranslate"><span class="pre">Wc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par215CornerFieldView4sizeE"><code class="docutils literal notranslate"><span class="pre">size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par213FaceFieldViewE"><code class="docutils literal notranslate"><span class="pre">par2::FaceFieldView</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par213FaceFieldView5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0ENK4par213FaceFieldView12matches_gridEbRK8GridDescI5GridTE"><code class="docutils literal notranslate"><span class="pre">matches_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213FaceFieldView1UE"><code class="docutils literal notranslate"><span class="pre">U</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213FaceFieldView1VE"><code class="docutils literal notranslate"><span class="pre">V</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213FaceFieldView1WE"><code class="docutils literal notranslate"><span class="pre">W</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213FaceFieldView4sizeE"><code class="docutils literal notranslate"><span class="pre">size</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#boundary-conditions">Boundary Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par212AxisBoundaryE"><code class="docutils literal notranslate"><span class="pre">par2::AxisBoundary</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212AxisBoundary2loE"><code class="docutils literal notranslate"><span class="pre">lo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212AxisBoundary2hiE"><code class="docutils literal notranslate"><span class="pre">hi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212AxisBoundary9symmetricE12BoundaryType"><code class="docutils literal notranslate"><span class="pre">symmetric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212AxisBoundary6closedEv"><code class="docutils literal notranslate"><span class="pre">closed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212AxisBoundary8periodicEv"><code class="docutils literal notranslate"><span class="pre">periodic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par212AxisBoundary4openEv"><code class="docutils literal notranslate"><span class="pre">open()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE"><code class="docutils literal notranslate"><span class="pre">par2::BoundaryConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par214BoundaryConfig12has_periodicEv"><code class="docutils literal notranslate"><span class="pre">has_periodic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par214BoundaryConfig8has_openEv"><code class="docutils literal notranslate"><span class="pre">has_open()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214BoundaryConfig1xE"><code class="docutils literal notranslate"><span class="pre">x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214BoundaryConfig1yE"><code class="docutils literal notranslate"><span class="pre">y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214BoundaryConfig1zE"><code class="docutils literal notranslate"><span class="pre">z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214BoundaryConfig10all_closedEv"><code class="docutils literal notranslate"><span class="pre">all_closed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214BoundaryConfig12all_periodicEv"><code class="docutils literal notranslate"><span class="pre">all_periodic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214BoundaryConfig9channel_xEv"><code class="docutils literal notranslate"><span class="pre">channel_x()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214BoundaryConfig6open_xEv"><code class="docutils literal notranslate"><span class="pre">open_x()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#particle-injection">Particle Injection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par210inject_boxEvRK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">inject_box()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par211inject_gridEvRK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">inject_grid()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#statistics">Statistics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par217concentration_boxEdRK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">concentration_box()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par224concentration_past_planeEdRK18ConstParticlesViewI1TEi1T12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">concentration_past_plane()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par215count_by_statusE14ParticleCountsRK18ConstParticlesViewI1TE12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">count_by_status()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E"><code class="docutils literal notranslate"><span class="pre">par2::Moments3</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par28Moments37has_nanEv"><code class="docutils literal notranslate"><span class="pre">has_nan()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par28Moments34meanE"><code class="docutils literal notranslate"><span class="pre">mean</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par28Moments33varE"><code class="docutils literal notranslate"><span class="pre">var</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par28Moments3StE"><code class="docutils literal notranslate"><span class="pre">std</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N4par214ParticleCountsE"><code class="docutils literal notranslate"><span class="pre">par2::ParticleCounts</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214ParticleCounts5totalE"><code class="docutils literal notranslate"><span class="pre">total</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214ParticleCounts6activeE"><code class="docutils literal notranslate"><span class="pre">active</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214ParticleCounts6exitedE"><code class="docutils literal notranslate"><span class="pre">exited</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par214ParticleCounts8inactiveE"><code class="docutils literal notranslate"><span class="pre">inactive</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par213StatsComputerE"><code class="docutils literal notranslate"><span class="pre">par2::StatsComputer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213StatsComputer13StatsComputerEi"><code class="docutils literal notranslate"><span class="pre">StatsComputer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213StatsComputerD0Ev"><code class="docutils literal notranslate"><span class="pre">~StatsComputer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213StatsComputer13StatsComputerERK13StatsComputer"><code class="docutils literal notranslate"><span class="pre">StatsComputer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213StatsComputeraSERK13StatsComputer"><code class="docutils literal notranslate"><span class="pre">operator=()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213StatsComputer13StatsComputerERR13StatsComputer"><code class="docutils literal notranslate"><span class="pre">StatsComputer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213StatsComputeraSERR13StatsComputer"><code class="docutils literal notranslate"><span class="pre">operator=()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213StatsComputer13compute_asyncERK18ConstParticlesViewI1TERK8GridDescI1TERK11StatsConfig12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">compute_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par213StatsComputer12fetch_resultEv"><code class="docutils literal notranslate"><span class="pre">fetch_result()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par213StatsComputer8capacityEv"><code class="docutils literal notranslate"><span class="pre">capacity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par213StatsComputer5impl_E"><code class="docutils literal notranslate"><span class="pre">impl_</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N4par211StatsConfigE"><code class="docutils literal notranslate"><span class="pre">par2::StatsConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par211StatsConfig13use_unwrappedE"><code class="docutils literal notranslate"><span class="pre">use_unwrapped</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par211StatsConfig18filter_active_onlyE"><code class="docutils literal notranslate"><span class="pre">filter_active_only</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN4par211StatsResultE"><code class="docutils literal notranslate"><span class="pre">par2::StatsResult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK4par211StatsResult5validEv"><code class="docutils literal notranslate"><span class="pre">valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par211StatsResult7momentsE"><code class="docutils literal notranslate"><span class="pre">moments</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par211StatsResult6countsE"><code class="docutils literal notranslate"><span class="pre">counts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par211StatsResult8computedE"><code class="docutils literal notranslate"><span class="pre">computed</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#i-o-helpers">I/O Helpers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N4par22ioE"><code class="docutils literal notranslate"><span class="pre">par2::io</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN4par22io24download_positions_asyncE11cudaError_tR19HostParticlesBufferI1TERK18ConstParticlesViewI1TEi12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">download_positions_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN4par22io24download_unwrapped_asyncE11cudaError_tR19HostParticlesBufferI1TERK22UnwrappedPositionsViewI1TEi12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">download_unwrapped_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN4par22io19write_particles_csvEbRKNSt6stringERK19HostParticlesBufferI1TEi1Tbbb"><code class="docutils literal notranslate"><span class="pre">write_particles_csv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN4par22io25write_legacy_csv_snapshotEbRK18ConstParticlesViewI1TERKNSt6stringE12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">write_legacy_csv_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par22io17CsvSnapshotConfigE"><code class="docutils literal notranslate"><span class="pre">par2::io::CsvSnapshotConfig</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN4par22io17CsvSnapshotWriterE"><code class="docutils literal notranslate"><span class="pre">par2::io::CsvSnapshotWriter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN4par22io19HostParticlesBufferE"><code class="docutils literal notranslate"><span class="pre">par2::io::HostParticlesBuffer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN4par22io21PinnedParticlesBufferE"><code class="docutils literal notranslate"><span class="pre">par2::io::PinnedParticlesBuffer</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#version">Version</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#c.PAR2_CORE_VERSION_MAJOR"><code class="docutils literal notranslate"><span class="pre">PAR2_CORE_VERSION_MAJOR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.PAR2_CORE_VERSION_MINOR"><code class="docutils literal notranslate"><span class="pre">PAR2_CORE_VERSION_MINOR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.PAR2_CORE_VERSION_PATCH"><code class="docutils literal notranslate"><span class="pre">PAR2_CORE_VERSION_PATCH</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.PAR2_CORE_VERSION_STRING"><code class="docutils literal notranslate"><span class="pre">PAR2_CORE_VERSION_STRING</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N4par27VersionE"><code class="docutils literal notranslate"><span class="pre">par2::Version</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par27Version5majorE"><code class="docutils literal notranslate"><span class="pre">major</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par27Version5minorE"><code class="docutils literal notranslate"><span class="pre">minor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par27Version5patchE"><code class="docutils literal notranslate"><span class="pre">patch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N4par27Version6stringE"><code class="docutils literal notranslate"><span class="pre">string</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#debug-policy">Debug Policy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#c.PAR2_DEBUG_LEVEL"><code class="docutils literal notranslate"><span class="pre">PAR2_DEBUG_LEVEL</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.PAR2_ENABLE_CUDA_CHECKS"><code class="docutils literal notranslate"><span class="pre">PAR2_ENABLE_CUDA_CHECKS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.PAR2_ENABLE_NAN_GUARDS"><code class="docutils literal notranslate"><span class="pre">PAR2_ENABLE_NAN_GUARDS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.PAR2_ENABLE_BOUNDS_CHECKS"><code class="docutils literal notranslate"><span class="pre">PAR2_ENABLE_BOUNDS_CHECKS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.PAR2_DEBUG_ONLY"><code class="docutils literal notranslate"><span class="pre">PAR2_DEBUG_ONLY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.PAR2_NAN_GUARD"><code class="docutils literal notranslate"><span class="pre">PAR2_NAN_GUARD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.PAR2_DEVICE_ASSERT"><code class="docutils literal notranslate"><span class="pre">PAR2_DEVICE_ASSERT</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/semantic_map.html">Semantic Map — Par2_Core Contracts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#public-api-tree">1  Public API Tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#engine-lifecycle-state-machine">2  Engine Lifecycle (State Machine)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#memory-contracts-gpu-native">3  Memory Contracts (GPU-Native)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#ownership-rules">3.1  Ownership Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#device-pointer-layout">3.2  Device Pointer Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#workspace-growth-policy">3.3  Workspace Growth Policy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#stream-and-event-semantics">4  Stream and Event Semantics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#stream-usage">4.1  Stream Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#event-integration">4.2  Event Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#execution-order-guarantee">4.3  Execution Order Guarantee</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#boundary-conditions">5  Boundary Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#per-axis-per-face-configuration">5.1  Per-Axis, Per-Face Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#closed-reflective">5.2  Closed (Reflective)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#periodic-wrap-around">5.3  Periodic (Wrap-Around)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#open-exit">5.4  Open (Exit)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#d-mode">5.5  2D Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#rng-and-determinism">6  RNG and Determinism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#initialization">6.1  Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#per-step-usage">6.2  Per-Step Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#reproducibility-guarantees">6.3  Reproducibility Guarantees</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#outputs-stats-and-snapshots">7  Outputs, Stats, and Snapshots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#position-data">7.1  Position Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#unwrapped-positions">7.2  Unwrapped Positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#statistics">7.3  Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#csv-snapshots">7.4  CSV Snapshots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#snapshot-timing">7.5  Snapshot Timing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#thread-safety">8  Thread Safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#rwpt-algorithm-mathematical-formulation">9  RWPT Algorithm (Mathematical Formulation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#velocity-layout-and-interpolation">10  Velocity Layout and Interpolation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#staggered-mac-grid-facefield">10.1  Staggered MAC Grid (FaceField)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#linear-interpolation-interpolationmode-linear">10.2  Linear Interpolation (InterpolationMode::Linear)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#trilinear-interpolation-interpolationmode-trilinear">10.3  Trilinear Interpolation (InterpolationMode::Trilinear)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#corner-velocity-computation">10.4  Corner Velocity Computation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#dispersion-tensor-and-displacement-matrix">11  Dispersion Tensor and Displacement Matrix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#dispersion-tensor-d">11.1  Dispersion Tensor D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#displacement-matrix-b">11.2  Displacement Matrix B</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#zerovelocity-handling">11.3  Zero‑Velocity Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#specialcase-dispatching">11.4  Special‑Case Dispatching</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#nan-prevention-flag">11.5  <code class="docutils literal notranslate"><span class="pre">nan_prevention</span></code> Flag</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#drift-correction-algorithms">12  Drift Correction Algorithms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#trilinearonfly-mode">12.1  TrilinearOnFly Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#precomputed-mode-finite-differences">12.2  Precomputed Mode (Finite Differences)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev/semantic_map.html#performance-contracts">13  Performance Contracts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#allocationfree-stepping">13.1  Allocation‑Free Stepping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#kernel-launch-configuration">13.2  Kernel Launch Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#memory-access-pattern">13.3  Memory Access Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev/semantic_map.html#known-limitations">13.4  Known Limitations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../references.html#primary-reference">Primary reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references.html#equation-cross-reference">Equation cross-reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#rwpt-theory">RWPT theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#gpu-cuda">GPU / CUDA</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Par2_Core</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading"></a></h1>
<p>This section is auto-generated from the C++ headers in <code class="docutils literal notranslate"><span class="pre">include/par2_core/</span></code>
using Doxygen + Breathe.</p>
<section id="how-to-integrate-tl-dr">
<h2>How to integrate (TL;DR)<a class="headerlink" href="#how-to-integrate-tl-dr" title="Link to this heading"></a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;par2_core/par2_core.hpp&gt;</span>

<span class="c1">// 1. Grid + physics + boundary</span>
<span class="k">auto</span><span class="w"> </span><span class="n">grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">par2</span><span class="o">::</span><span class="n">make_grid</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="w"> </span><span class="n">ny</span><span class="p">,</span><span class="w"> </span><span class="n">nz</span><span class="p">,</span><span class="w"> </span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="n">dy</span><span class="p">,</span><span class="w"> </span><span class="n">dz</span><span class="p">);</span>
<span class="n">par2</span><span class="o">::</span><span class="n">TransportParams</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">params</span><span class="p">{</span><span class="n">Dm</span><span class="p">,</span><span class="w"> </span><span class="n">alphaL</span><span class="p">,</span><span class="w"> </span><span class="n">alphaT</span><span class="p">};</span>
<span class="k">auto</span><span class="w"> </span><span class="n">bc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">par2</span><span class="o">::</span><span class="n">BoundaryConfig</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;::</span><span class="n">all_closed</span><span class="p">();</span>

<span class="c1">// 2. Engine (configure once)</span>
<span class="n">par2</span><span class="o">::</span><span class="n">EngineConfig</span><span class="w"> </span><span class="n">cfg</span><span class="p">;</span>
<span class="n">cfg</span><span class="p">.</span><span class="n">interpolation_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">par2</span><span class="o">::</span><span class="n">InterpolationMode</span><span class="o">::</span><span class="n">Linear</span><span class="p">;</span>
<span class="n">cfg</span><span class="p">.</span><span class="n">drift_mode</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">par2</span><span class="o">::</span><span class="n">DriftCorrectionMode</span><span class="o">::</span><span class="n">TrilinearOnFly</span><span class="p">;</span>
<span class="n">par2</span><span class="o">::</span><span class="n">TransportEngine</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">engine</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">cfg</span><span class="p">);</span>

<span class="c1">// 3. Bind device-resident data (zero-copy)</span>
<span class="n">engine</span><span class="p">.</span><span class="n">set_stream</span><span class="p">(</span><span class="n">my_stream</span><span class="p">);</span>
<span class="n">engine</span><span class="p">.</span><span class="n">bind_velocity</span><span class="p">({</span><span class="n">d_U</span><span class="p">,</span><span class="w"> </span><span class="n">d_V</span><span class="p">,</span><span class="w"> </span><span class="n">d_W</span><span class="p">,</span><span class="w"> </span><span class="n">grid</span><span class="p">.</span><span class="n">num_corners</span><span class="p">()});</span>
<span class="n">engine</span><span class="p">.</span><span class="n">bind_particles</span><span class="p">({</span><span class="n">d_x</span><span class="p">,</span><span class="w"> </span><span class="n">d_y</span><span class="p">,</span><span class="w"> </span><span class="n">d_z</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">});</span>
<span class="n">engine</span><span class="p">.</span><span class="n">inject_box</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="w"> </span><span class="n">y0</span><span class="p">,</span><span class="w"> </span><span class="n">z0</span><span class="p">,</span><span class="w"> </span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">y1</span><span class="p">,</span><span class="w"> </span><span class="n">z1</span><span class="p">);</span>

<span class="c1">// 4. Prepare (one-time allocs: RNG, workspace)</span>
<span class="n">engine</span><span class="p">.</span><span class="n">prepare</span><span class="p">();</span>

<span class="c1">// 5. Hot loop — async, zero-alloc, zero-sync</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_steps</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">engine</span><span class="p">.</span><span class="n">update_derived_fields</span><span class="p">();</span><span class="w">  </span><span class="c1">// after velocity changes</span>
<span class="w">    </span><span class="n">engine</span><span class="p">.</span><span class="n">step</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">engine</span><span class="p">.</span><span class="n">synchronize</span><span class="p">();</span><span class="w">  </span><span class="c1">// sync when host needs results</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../user/pipeline_recipes.html"><span class="doc">Pipeline Recipes</span></a> for multi-stream patterns and
<a class="reference internal" href="../user/memory_contract.html"><span class="doc">Memory Contract</span></a> for ownership rules.</p>
</section>
<section id="core-engine">
<h2>Core Engine<a class="headerlink" href="#core-engine" title="Link to this heading"></a></h2>
<p>TransportEngine - GPU particle tracking engine. </p>
<p>This is the main public interface for Par2_Core. The engine:<ul class="simple">
<li><p>Binds to user-provided GPU velocity fields (no copy)</p></li>
<li><p>Binds to user-provided GPU particle arrays (no copy)</p></li>
<li><p>Executes RWPT steps asynchronously on a CUDA stream</p></li>
<li><p>Provides particle injection utilities</p></li>
</ul>
</p>
<p><dl class="simple">
<dt><strong>Copyright</strong></dt><dd><p>Par2_Core - GPU-native transport engine </p>
</dd>
</dl>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All device pointers passed to bind_* must remain valid for the lifetime of the binding (until next bind or engine destruction).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The engine does NOT call cudaDeviceSynchronize() in the hot path. Synchronization is the caller’s responsibility.</p>
</div>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv44par2">
<span id="_CPPv34par2"></span><span id="_CPPv24par2"></span><span id="par2"></span><span class="target" id="namespacepar2"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">par2</span></span></span><a class="headerlink" href="#_CPPv44par2" title="Link to this definition"></a><br /></dt>
<dd><dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par215TransportEngineE">
<span id="_CPPv3I0EN4par215TransportEngineE"></span><span id="_CPPv2I0EN4par215TransportEngineE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classpar2_1_1TransportEngine"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TransportEngine</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par215TransportEngineE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;transport_engine.hpp&gt;</em></div>
<p>GPU-native particle tracking engine. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type (float or double)</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine15TransportEngineERK8GridDescI1TERK15TransportParamsI1TERK14BoundaryConfigI1TERK12EngineConfig">
<span id="_CPPv3N4par215TransportEngine15TransportEngineERK8GridDescI1TERK15TransportParamsI1TERK14BoundaryConfigI1TERK12EngineConfig"></span><span id="_CPPv2N4par215TransportEngine15TransportEngineERK8GridDescI1TERK15TransportParamsI1TERK14BoundaryConfigI1TERK12EngineConfig"></span><span id="par2::TransportEngine::TransportEngine__GridDesc:T:CR.TransportParams:T:CR.BoundaryConfig:T:CR.EngineConfigCR"></span><span class="target" id="classpar2_1_1TransportEngine_1ad50e83cc6ed8bb68b07379e2663a7836"></span><span class="sig-name descname"><span class="n"><span class="pre">TransportEngine</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc"><span class="n"><span class="pre">GridDesc</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grid</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par215TransportParamsE" title="par2::TransportParams"><span class="n"><span class="pre">TransportParams</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE" title="par2::BoundaryConfig"><span class="n"><span class="pre">BoundaryConfig</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bc</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par212EngineConfigE" title="par2::EngineConfig"><span class="n"><span class="pre">EngineConfig</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">config</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par212EngineConfigE" title="par2::EngineConfig"><span class="n"><span class="pre">EngineConfig</span></span></a><span class="p"><span class="pre">{</span></span><span class="p"><span class="pre">}</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine15TransportEngineERK8GridDescI1TERK15TransportParamsI1TERK14BoundaryConfigI1TERK12EngineConfig" title="Link to this definition"></a><br /></dt>
<dd><p>Construct a transport engine. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> – Grid descriptor (geometry) </p></li>
<li><p><strong>params</strong> – Transport parameters (diffusion, dispersivity) </p></li>
<li><p><strong>bc</strong> – Boundary conditions </p></li>
<li><p><strong>config</strong> – Engine configuration</p></li>
</ul>
</dd>
<dt class="field-even">Throws<span class="colon">:</span></dt>
<dd class="field-even"><p><span><span class="cpp-expr sig sig-inline cpp"><span class="n">std</span><span class="p">::</span><span class="n">runtime_error</span></span></span> – if CUDA initialization fails </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngineD0Ev">
<span id="_CPPv3N4par215TransportEngineD0Ev"></span><span id="_CPPv2N4par215TransportEngineD0Ev"></span><span id="par2::TransportEngine::~TransportEngine"></span><span class="target" id="classpar2_1_1TransportEngine_1a2383c36aa2ee4ad0a64d9080aefba631"></span><span class="sig-name descname"><span class="n"><span class="pre">~TransportEngine</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngineD0Ev" title="Link to this definition"></a><br /></dt>
<dd><p>Destructor - releases CUDA resources. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine15TransportEngineERK15TransportEngine">
<span id="_CPPv3N4par215TransportEngine15TransportEngineERK15TransportEngine"></span><span id="_CPPv2N4par215TransportEngine15TransportEngineERK15TransportEngine"></span><span id="par2::TransportEngine::TransportEngine__TransportEngineCR"></span><span class="target" id="classpar2_1_1TransportEngine_1a4f43bb8e9b41ef56bbfe527e581db931"></span><span class="sig-name descname"><span class="n"><span class="pre">TransportEngine</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par215TransportEngine15TransportEngineERK15TransportEngine" title="par2::TransportEngine::TransportEngine"><span class="n"><span class="pre">TransportEngine</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N4par215TransportEngine15TransportEngineERK15TransportEngine" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngineaSERK15TransportEngine">
<span id="_CPPv3N4par215TransportEngineaSERK15TransportEngine"></span><span id="_CPPv2N4par215TransportEngineaSERK15TransportEngine"></span><span id="par2::TransportEngine::assign-operator__TransportEngineCR"></span><span class="target" id="classpar2_1_1TransportEngine_1aae804abaff03a2be45e657b1e5ad1030"></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine"><span class="n"><span class="pre">TransportEngine</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine"><span class="n"><span class="pre">TransportEngine</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N4par215TransportEngineaSERK15TransportEngine" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine15TransportEngineERR15TransportEngine">
<span id="_CPPv3N4par215TransportEngine15TransportEngineERR15TransportEngine"></span><span id="_CPPv2N4par215TransportEngine15TransportEngineERR15TransportEngine"></span><span id="par2::TransportEngine::TransportEngine__TransportEngineRR"></span><span class="target" id="classpar2_1_1TransportEngine_1adcacb981976e59e322c9e4571d62d498"></span><span class="sig-name descname"><span class="n"><span class="pre">TransportEngine</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N4par215TransportEngine15TransportEngineERR15TransportEngine" title="par2::TransportEngine::TransportEngine"><span class="n"><span class="pre">TransportEngine</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par215TransportEngine15TransportEngineERR15TransportEngine" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngineaSERR15TransportEngine">
<span id="_CPPv3N4par215TransportEngineaSERR15TransportEngine"></span><span id="_CPPv2N4par215TransportEngineaSERR15TransportEngine"></span><span id="par2::TransportEngine::assign-operator__TransportEngineRR"></span><span class="target" id="classpar2_1_1TransportEngine_1a5f44ae90b3832391dbab05c391312dfa"></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine"><span class="n"><span class="pre">TransportEngine</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine"><span class="n"><span class="pre">TransportEngine</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par215TransportEngineaSERR15TransportEngine" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine10set_streamE12cudaStream_t">
<span id="_CPPv3N4par215TransportEngine10set_streamE12cudaStream_t"></span><span id="_CPPv2N4par215TransportEngine10set_streamE12cudaStream_t"></span><span id="par2::TransportEngine::set_stream__cudaStream_t"></span><span class="target" id="classpar2_1_1TransportEngine_1a626e300583384da22ec9a637c9b1b255"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_stream</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par215TransportEngine10set_streamE12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Set the CUDA stream for all operations. </p>
<p>
All subsequent operations (step, inject, etc.) will use this stream. The engine does NOT own the stream - caller must manage its lifetime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stream</strong> – CUDA stream (nullptr for default stream)</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportEngine6streamEv">
<span id="_CPPv3NK4par215TransportEngine6streamEv"></span><span id="_CPPv2NK4par215TransportEngine6streamEv"></span><span id="par2::TransportEngine::streamC"></span><span class="target" id="classpar2_1_1TransportEngine_1a7c2fb73be13c916d078720da1d98087a"></span><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">stream</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportEngine6streamEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get the current CUDA stream. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine13bind_velocityERK12VelocityViewI1TE">
<span id="_CPPv3N4par215TransportEngine13bind_velocityERK12VelocityViewI1TE"></span><span id="_CPPv2N4par215TransportEngine13bind_velocityERK12VelocityViewI1TE"></span><span id="par2::TransportEngine::bind_velocity__VelocityView:T:CR"></span><span class="target" id="classpar2_1_1TransportEngine_1acf68d4ffc86aaee00660117d01427f92"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bind_velocity</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par212VelocityViewE" title="par2::VelocityView"><span class="n"><span class="pre">VelocityView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">vel</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine13bind_velocityERK12VelocityViewI1TE" title="Link to this definition"></a><br /></dt>
<dd><p>Bind velocity field (device pointers). </p>
<p>
The engine does NOT copy this data — operates directly on user buffers. The buffers must remain valid until the next <a class="reference internal" href="#classpar2_1_1TransportEngine_1acf68d4ffc86aaee00660117d01427f92"><span class="std std-ref">bind_velocity()</span></a> call or engine destruction.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>After calling this, you must call <a class="reference internal" href="#classpar2_1_1TransportEngine_1affb69d449a3c1e5f05da35a8459defcc"><span class="std std-ref">update_derived_fields()</span></a> before the next <a class="reference internal" href="#classpar2_1_1TransportEngine_1afa6a9cd031dc86fa4b40444bf532b59a"><span class="std std-ref">step()</span></a> if using Trilinear interpolation or on-the-fly drift correction. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Clears any previous <a class="reference internal" href="#classpar2_1_1TransportEngine_1a3e54b01b268455f4a5962e9fc62798e8"><span class="std std-ref">bind_corner_velocity()</span></a> external binding. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vel</strong> – Velocity view with device pointers to U, V, W arrays</p>
</dd>
<dt class="field-even">Pre<span class="colon">:</span></dt>
<dd class="field-even"><p>vel.size == grid.num_corners() (= (nx+1)*(ny+1)*(nz+1)) </p>
</dd>
<dt class="field-odd">Pre<span class="colon">:</span></dt>
<dd class="field-odd"><p>All pointers are valid device memory </p>
</dd>
<dt class="field-even">Post<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#classpar2_1_1TransportEngine_1a54a6150f822240a32fb1e5fc07edbc78"><span class="std std-ref">needs_corner_update()</span></a> == true </p>
</dd>
<dt class="field-odd">Post<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#classpar2_1_1TransportEngine_1a90ad66fcd78e43673b98ef3af44a819d"><span class="std std-ref">needs_drift_update()</span></a> == true (if using Precomputed drift)</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine20bind_corner_velocityERK18CornerVelocityViewI1TE">
<span id="_CPPv3N4par215TransportEngine20bind_corner_velocityERK18CornerVelocityViewI1TE"></span><span id="_CPPv2N4par215TransportEngine20bind_corner_velocityERK18CornerVelocityViewI1TE"></span><span id="par2::TransportEngine::bind_corner_velocity__CornerVelocityView:T:CR"></span><span class="target" id="classpar2_1_1TransportEngine_1a3e54b01b268455f4a5962e9fc62798e8"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bind_corner_velocity</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par218CornerVelocityViewE" title="par2::CornerVelocityView"><span class="n"><span class="pre">CornerVelocityView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cvel</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine20bind_corner_velocityERK18CornerVelocityViewI1TE" title="Link to this definition"></a><br /></dt>
<dd><p>Bind external corner velocity field (for trilinear mode). </p>
<p>
Use this when you have <strong>pre-computed</strong> corner velocities (e.g., from MODFLOW/MT3DMS output). When bound, <code class="docutils literal notranslate"><a class="reference internal" href="#classpar2_1_1TransportEngine_1affb69d449a3c1e5f05da35a8459defcc"><span class="std std-ref"><span class="pre">update_derived_fields()</span></span></a></code> will skip the internal corner computation and use these values instead.</p>
<p>If not bound, call <code class="docutils literal notranslate"><a class="reference internal" href="#classpar2_1_1TransportEngine_1affb69d449a3c1e5f05da35a8459defcc"><span class="std std-ref"><span class="pre">update_derived_fields()</span></span></a></code> after <code class="docutils literal notranslate"><a class="reference internal" href="#classpar2_1_1TransportEngine_1acf68d4ffc86aaee00660117d01427f92"><span class="std std-ref"><span class="pre">bind_velocity()</span></span></a></code> to compute corner velocities from the face field automatically.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>External binding takes priority over internal computation. Call <code class="docutils literal notranslate"><a class="reference internal" href="#classpar2_1_1TransportEngine_1acf68d4ffc86aaee00660117d01427f92"><span class="std std-ref"><span class="pre">bind_velocity()</span></span></a></code> again to clear external binding and revert to internal computation. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cvel</strong> – Corner velocity view with (nx+1)×(ny+1)×(nz+1) grid</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine14bind_particlesERK13ParticlesViewI1TE">
<span id="_CPPv3N4par215TransportEngine14bind_particlesERK13ParticlesViewI1TE"></span><span id="_CPPv2N4par215TransportEngine14bind_particlesERK13ParticlesViewI1TE"></span><span id="par2::TransportEngine::bind_particles__ParticlesView:T:CR"></span><span class="target" id="classpar2_1_1TransportEngine_1ae44759dc107d28f9d43904c8ba66c1a1"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bind_particles</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par213ParticlesViewE" title="par2::ParticlesView"><span class="n"><span class="pre">ParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">particles</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine14bind_particlesERK13ParticlesViewI1TE" title="Link to this definition"></a><br /></dt>
<dd><p>Bind particle arrays (device pointers). </p>
<p>
The engine writes to these arrays during <a class="reference internal" href="#classpar2_1_1TransportEngine_1afa6a9cd031dc86fa4b40444bf532b59a"><span class="std std-ref">step()</span></a> and inject_*().</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The particle arrays must remain valid until the next <a class="reference internal" href="#classpar2_1_1TransportEngine_1ae44759dc107d28f9d43904c8ba66c1a1"><span class="std std-ref">bind_particles()</span></a> call or engine destruction. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If particles.status / wrapX/Y/Z are nullptr and the boundary config requires them, call <a class="reference internal" href="#classpar2_1_1TransportEngine_1a34d0552a0f43862cba2fb3c80a0e7341"><span class="std std-ref">ensure_tracking_arrays()</span></a> or <a class="reference internal" href="#classpar2_1_1TransportEngine_1ad6789ef1a213665542e57b2f693d5653"><span class="std std-ref">prepare()</span></a> to auto-allocate. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>particles</strong> – Particle view with device pointers to x, y, z arrays</p>
</dd>
<dt class="field-even">Pre<span class="colon">:</span></dt>
<dd class="field-even"><p>particles.n &lt;= allocated size of arrays </p>
</dd>
<dt class="field-odd">Pre<span class="colon">:</span></dt>
<dd class="field-odd"><p>All pointers are valid device memory </p>
</dd>
<dt class="field-even">Post<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#classpar2_1_1TransportEngine_1a48a0c43bedd7d095602672855a24cdbe"><span class="std std-ref">is_prepared()</span></a> == false — you must call <a class="reference internal" href="#classpar2_1_1TransportEngine_1ad6789ef1a213665542e57b2f693d5653"><span class="std std-ref">prepare()</span></a> before <a class="reference internal" href="#classpar2_1_1TransportEngine_1afa6a9cd031dc86fa4b40444bf532b59a"><span class="std std-ref">step()</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine21bind_drift_correctionERK19DriftCorrectionViewI1TE">
<span id="_CPPv3N4par215TransportEngine21bind_drift_correctionERK19DriftCorrectionViewI1TE"></span><span id="_CPPv2N4par215TransportEngine21bind_drift_correctionERK19DriftCorrectionViewI1TE"></span><span id="par2::TransportEngine::bind_drift_correction__DriftCorrectionView:T:CR"></span><span class="target" id="classpar2_1_1TransportEngine_1affb783f13b196cfb841020bfc71ae962"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bind_drift_correction</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par219DriftCorrectionViewE" title="par2::DriftCorrectionView"><span class="n"><span class="pre">DriftCorrectionView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine21bind_drift_correctionERK19DriftCorrectionViewI1TE" title="Link to this definition"></a><br /></dt>
<dd><p>Bind precomputed drift correction field. </p>
<p>
Only used when config.drift_correction == <a class="reference internal" href="#namespacepar2_1a2e9b0a2b6e4d6f65763b00f8c87aa181a04021d95a37003c16d27a38d407e3304"><span class="std std-ref">DriftCorrectionMode::Precomputed</span></a>. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dc</strong> – Drift correction view</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine21update_derived_fieldsE12cudaStream_t">
<span id="_CPPv3N4par215TransportEngine21update_derived_fieldsE12cudaStream_t"></span><span id="_CPPv2N4par215TransportEngine21update_derived_fieldsE12cudaStream_t"></span><span id="par2::TransportEngine::update_derived_fields__cudaStream_t"></span><span class="target" id="classpar2_1_1TransportEngine_1affb69d449a3c1e5f05da35a8459defcc"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">update_derived_fields</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine21update_derived_fieldsE12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Update derived fields (corner velocity) from face velocity. </p>
<p><strong>IMPORTANT</strong>: Call this after changing U/V/W when using:<ul class="simple">
<li><p><a class="reference internal" href="#namespacepar2_1a7c8f4da66964574b306027d770c0f963a969a7b6f1f3951ef293b3ff281dc293d"><span class="std std-ref">InterpolationMode::Trilinear</span></a></p></li>
<li><p><a class="reference internal" href="#namespacepar2_1a2e9b0a2b6e4d6f65763b00f8c87aa181aba8be745c90c7d1c79753cd7dda9b925"><span class="std std-ref">DriftCorrectionMode::TrilinearOnFly</span></a></p></li>
</ul>
</p>
<p>If you bound an external corner velocity via <a class="reference internal" href="#classpar2_1_1TransportEngine_1a3e54b01b268455f4a5962e9fc62798e8"><span class="std std-ref">bind_corner_velocity()</span></a>, this call is a no-op (external binding takes priority).</p>
<p>This is ASYNC: kernel launches on stream, returns immediately. No cudaDeviceSynchronize() inside. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stream</strong> – CUDA stream for the computation (default: engine stream)</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportEngine19needs_corner_updateEv">
<span id="_CPPv3NK4par215TransportEngine19needs_corner_updateEv"></span><span id="_CPPv2NK4par215TransportEngine19needs_corner_updateEv"></span><span id="par2::TransportEngine::needs_corner_updateC"></span><span class="target" id="classpar2_1_1TransportEngine_1a54a6150f822240a32fb1e5fc07edbc78"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">needs_corner_update</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportEngine19needs_corner_updateEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if corner velocity needs update. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>true if <a class="reference internal" href="#classpar2_1_1TransportEngine_1affb69d449a3c1e5f05da35a8459defcc"><span class="std std-ref">update_derived_fields()</span></a> should be called </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportEngine18needs_drift_updateEv">
<span id="_CPPv3NK4par215TransportEngine18needs_drift_updateEv"></span><span id="_CPPv2NK4par215TransportEngine18needs_drift_updateEv"></span><span id="par2::TransportEngine::needs_drift_updateC"></span><span class="target" id="classpar2_1_1TransportEngine_1a90ad66fcd78e43673b98ef3af44a819d"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">needs_drift_update</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportEngine18needs_drift_updateEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if precomputed drift needs update. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>true if <a class="reference internal" href="#classpar2_1_1TransportEngine_1affb69d449a3c1e5f05da35a8459defcc"><span class="std std-ref">update_derived_fields()</span></a> should be called (Precomputed mode) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine4stepE1T">
<span id="_CPPv3N4par215TransportEngine4stepE1T"></span><span id="_CPPv2N4par215TransportEngine4stepE1T"></span><span id="par2::TransportEngine::step__T"></span><span class="target" id="classpar2_1_1TransportEngine_1afa6a9cd031dc86fa4b40444bf532b59a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">step</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine4stepE1T" title="Link to this definition"></a><br /></dt>
<dd><p>Execute one RWPT step. </p>
<p>
This is ASYNC: the kernel is launched on the configured stream and returns immediately. NO cudaDeviceSynchronize() inside. NO allocations occur — all workspace was set up in <a class="reference internal" href="#classpar2_1_1TransportEngine_1ad6789ef1a213665542e57b2f693d5653"><span class="std std-ref">prepare()</span></a>.</p>
<p>After return, particle positions are updated (on GPU). Particles with <a class="reference internal" href="#namespacepar2_1a7c204ae8d485714ee4a7935edc563101a268ce394e277db759f5d6ee76c59f0e7"><span class="std std-ref">ParticleStatus::Exited</span></a> are skipped.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Calling <a class="reference internal" href="#classpar2_1_1TransportEngine_1afa6a9cd031dc86fa4b40444bf532b59a"><span class="std std-ref">step()</span></a> without <a class="reference internal" href="#classpar2_1_1TransportEngine_1ad6789ef1a213665542e57b2f693d5653"><span class="std std-ref">prepare()</span></a> causes an assertion failure in debug builds or undefined behavior in release. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dt</strong> – Time step size</p>
</dd>
<dt class="field-even">Pre<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#classpar2_1_1TransportEngine_1a798a9da31d5ac9ca77516a7be0db3156"><span class="std std-ref">has_velocity()</span></a> == true </p>
</dd>
<dt class="field-odd">Pre<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#classpar2_1_1TransportEngine_1ac5e8147446a0af95cb63ff980d458dad"><span class="std std-ref">has_particles()</span></a> == true </p>
</dd>
<dt class="field-even">Pre<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#classpar2_1_1TransportEngine_1a48a0c43bedd7d095602672855a24cdbe"><span class="std std-ref">is_prepared()</span></a> == true (call <a class="reference internal" href="#classpar2_1_1TransportEngine_1ad6789ef1a213665542e57b2f693d5653"><span class="std std-ref">prepare()</span></a> first) </p>
</dd>
<dt class="field-odd">Pre<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#classpar2_1_1TransportEngine_1a54a6150f822240a32fb1e5fc07edbc78"><span class="std std-ref">needs_corner_update()</span></a> == false </p>
</dd>
<dt class="field-even">Pre<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#classpar2_1_1TransportEngine_1a90ad66fcd78e43673b98ef3af44a819d"><span class="std std-ref">needs_drift_update()</span></a> == false </p>
</dd>
<dt class="field-odd">Pre<span class="colon">:</span></dt>
<dd class="field-odd"><p>dt &gt; 0</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine7advanceE1Ti">
<span id="_CPPv3N4par215TransportEngine7advanceE1Ti"></span><span id="_CPPv2N4par215TransportEngine7advanceE1Ti"></span><span id="par2::TransportEngine::advance__T.i"></span><span class="target" id="classpar2_1_1TransportEngine_1a451d1dbcba471fe55d2ee0f63ad3f075"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">advance</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_steps</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine7advanceE1Ti" title="Link to this definition"></a><br /></dt>
<dd><p>Execute multiple RWPT steps. </p>
<p>
Equivalent to calling step(dt) num_steps times. All steps run on the same stream without intermediate syncs. No allocations, no synchronization during the loop. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> – Time step size per step </p></li>
<li><p><strong>num_steps</strong> – Number of steps to execute</p></li>
</ul>
</dd>
<dt class="field-even">Pre<span class="colon">:</span></dt>
<dd class="field-even"><p>Same preconditions as <a class="reference internal" href="#classpar2_1_1TransportEngine_1afa6a9cd031dc86fa4b40444bf532b59a"><span class="std std-ref">step()</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine10inject_boxE1T1T1T1T1T1Tii">
<span id="_CPPv3N4par215TransportEngine10inject_boxE1T1T1T1T1T1Tii"></span><span id="_CPPv2N4par215TransportEngine10inject_boxE1T1T1T1T1T1Tii"></span><span id="par2::TransportEngine::inject_box__T.T.T.T.T.T.i.i"></span><span class="target" id="classpar2_1_1TransportEngine_1ac104270e0963816b21585e33f89be79f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inject_box</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">x0</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">y0</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">z0</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">x1</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">y1</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">z1</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">first_particle</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">count</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="o"><span class="pre">-</span></span><span class="m"><span class="pre">1</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine10inject_boxE1T1T1T1T1T1Tii" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize particles uniformly in a box. </p>
<p>
Particles are distributed uniformly within [x0,x1] x [y0,y1] x [z0,z1]. This uses a deterministic pattern based on particle index.</p>
<p>
This is ASYNC: kernel launched on configured stream. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0, y0, z0</strong> – Minimum corner of box </p></li>
<li><p><strong>x1, y1, z1</strong> – Maximum corner of box </p></li>
<li><p><strong>first_particle</strong> – Starting index (default: 0) </p></li>
<li><p><strong>count</strong> – Number of particles to initialize (default: all bound)</p></li>
</ul>
</dd>
<dt class="field-even">Pre<span class="colon">:</span></dt>
<dd class="field-even"><p>Particles are bound </p>
</dd>
<dt class="field-odd">Pre<span class="colon">:</span></dt>
<dd class="field-odd"><p>Box is within domain (no validation - user responsibility)</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportEngine4gridEv">
<span id="_CPPv3NK4par215TransportEngine4gridEv"></span><span id="_CPPv2NK4par215TransportEngine4gridEv"></span><span id="par2::TransportEngine::gridC"></span><span class="target" id="classpar2_1_1TransportEngine_1a597eab8aa3e35e1dd3a28f4334009ee2"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc"><span class="n"><span class="pre">GridDesc</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">grid</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportEngine4gridEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get the grid descriptor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportEngine6paramsEv">
<span id="_CPPv3NK4par215TransportEngine6paramsEv"></span><span id="_CPPv2NK4par215TransportEngine6paramsEv"></span><span id="par2::TransportEngine::paramsC"></span><span class="target" id="classpar2_1_1TransportEngine_1abefeecf8f9983638017cef5616200492"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par215TransportParamsE" title="par2::TransportParams"><span class="n"><span class="pre">TransportParams</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">params</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportEngine6paramsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get the transport parameters. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportEngine8boundaryEv">
<span id="_CPPv3NK4par215TransportEngine8boundaryEv"></span><span id="_CPPv2NK4par215TransportEngine8boundaryEv"></span><span id="par2::TransportEngine::boundaryC"></span><span class="target" id="classpar2_1_1TransportEngine_1a37523a6ad247099d71507f459fe5a017"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE" title="par2::BoundaryConfig"><span class="n"><span class="pre">BoundaryConfig</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">boundary</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportEngine8boundaryEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get the boundary configuration. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportEngine6configEv">
<span id="_CPPv3NK4par215TransportEngine6configEv"></span><span id="_CPPv2NK4par215TransportEngine6configEv"></span><span id="par2::TransportEngine::configC"></span><span class="target" id="classpar2_1_1TransportEngine_1aa55b61239f51e746237574c86efe58d8"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par212EngineConfigE" title="par2::EngineConfig"><span class="n"><span class="pre">EngineConfig</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">config</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportEngine6configEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get the engine configuration. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportEngine13num_particlesEv">
<span id="_CPPv3NK4par215TransportEngine13num_particlesEv"></span><span id="_CPPv2NK4par215TransportEngine13num_particlesEv"></span><span id="par2::TransportEngine::num_particlesC"></span><span class="target" id="classpar2_1_1TransportEngine_1afc86ab33f59e50210d839abe96e1ae1e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_particles</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportEngine13num_particlesEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get number of bound particles. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportEngine12has_velocityEv">
<span id="_CPPv3NK4par215TransportEngine12has_velocityEv"></span><span id="_CPPv2NK4par215TransportEngine12has_velocityEv"></span><span id="par2::TransportEngine::has_velocityC"></span><span class="target" id="classpar2_1_1TransportEngine_1a798a9da31d5ac9ca77516a7be0db3156"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_velocity</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportEngine12has_velocityEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if velocity is bound. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportEngine13has_particlesEv">
<span id="_CPPv3NK4par215TransportEngine13has_particlesEv"></span><span id="_CPPv2NK4par215TransportEngine13has_particlesEv"></span><span id="par2::TransportEngine::has_particlesC"></span><span class="target" id="classpar2_1_1TransportEngine_1ac5e8147446a0af95cb63ff980d458dad"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_particles</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportEngine13has_particlesEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if particles are bound. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine22ensure_tracking_arraysEv">
<span id="_CPPv3N4par215TransportEngine22ensure_tracking_arraysEv"></span><span id="_CPPv2N4par215TransportEngine22ensure_tracking_arraysEv"></span><span id="par2::TransportEngine::ensure_tracking_arrays"></span><span class="target" id="classpar2_1_1TransportEngine_1a34d0552a0f43862cba2fb3c80a0e7341"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ensure_tracking_arrays</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine22ensure_tracking_arraysEv" title="Link to this definition"></a><br /></dt>
<dd><p>Ensure tracking arrays are allocated for boundary conditions. </p>
<p>Call this after <a class="reference internal" href="#classpar2_1_1TransportEngine_1ae44759dc107d28f9d43904c8ba66c1a1"><span class="std std-ref">bind_particles()</span></a> if using:<ul class="simple">
<li><p>Open BC: allocates status array if not provided by user</p></li>
<li><p>Periodic BC: allocates wrapX/Y/Z if not provided by user</p></li>
</ul>
</p>
<p>
This is NOT called automatically to avoid hidden allocations. Safe to call multiple times — no-op if already allocated. User-provided buffers in <a class="reference internal" href="#structpar2_1_1ParticlesView"><span class="std std-ref">ParticlesView</span></a> take priority (not overwritten).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Also called internally by <a class="reference internal" href="#classpar2_1_1TransportEngine_1ad6789ef1a213665542e57b2f693d5653"><span class="std std-ref">prepare()</span></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Pre<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#classpar2_1_1TransportEngine_1ac5e8147446a0af95cb63ff980d458dad"><span class="std std-ref">has_particles()</span></a> == true</p>
</dd>
<dt class="field-even">Throws<span class="colon">:</span></dt>
<dd class="field-even"><p><span><span class="cpp-expr sig sig-inline cpp"><span class="n">std</span><span class="p">::</span><span class="n">runtime_error</span></span></span> – if allocation fails </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine7prepareE12cudaStream_t">
<span id="_CPPv3N4par215TransportEngine7prepareE12cudaStream_t"></span><span id="_CPPv2N4par215TransportEngine7prepareE12cudaStream_t"></span><span id="par2::TransportEngine::prepare__cudaStream_t"></span><span class="target" id="classpar2_1_1TransportEngine_1ad6789ef1a213665542e57b2f693d5653"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">prepare</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine7prepareE12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Prepare engine for simulation (allocate + initialize workspace). </p>
<p><strong>MUST be called after <a class="reference internal" href="#classpar2_1_1TransportEngine_1ae44759dc107d28f9d43904c8ba66c1a1"><span class="std std-ref">bind_particles()</span></a> and before <a class="reference internal" href="#classpar2_1_1TransportEngine_1afa6a9cd031dc86fa4b40444bf532b59a"><span class="std std-ref">step()</span></a>/advance()</strong>.</p>
<p>
This method:<ul class="simple">
<li><p>Allocates RNG states if needed (one-time or grow)</p></li>
<li><p>Initializes RNG states with kernel (seed from <a class="reference internal" href="#structpar2_1_1EngineConfig_1a5f1ee14667cb8cfd5629b3ba0b3520d9"><span class="std std-ref">EngineConfig::rng_seed</span></a>)</p></li>
<li><p>Calls <a class="reference internal" href="#classpar2_1_1TransportEngine_1a34d0552a0f43862cba2fb3c80a0e7341"><span class="std std-ref">ensure_tracking_arrays()</span></a> for Open/Periodic BC</p></li>
<li><p>Computes corner velocity if trilinear mode and face velocity bound</p></li>
</ul>
</p>
<p>All allocations use cudaMallocAsync when available (CUDA 11.2+). After <a class="reference internal" href="#classpar2_1_1TransportEngine_1ad6789ef1a213665542e57b2f693d5653"><span class="std std-ref">prepare()</span></a>, <a class="reference internal" href="#classpar2_1_1TransportEngine_1afa6a9cd031dc86fa4b40444bf532b59a"><span class="std std-ref">step()</span></a>/advance() will NOT allocate.</p>
<dl class="field-list simple">
<dt class="field-odd">Pre<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#classpar2_1_1TransportEngine_1ac5e8147446a0af95cb63ff980d458dad"><span class="std std-ref">has_particles()</span></a> == true </p>
</dd>
<dt class="field-even">Post<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#classpar2_1_1TransportEngine_1a48a0c43bedd7d095602672855a24cdbe"><span class="std std-ref">is_prepared()</span></a> == true </p>
</dd>
<dt class="field-odd">Post<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#classpar2_1_1TransportEngine_1afa6a9cd031dc86fa4b40444bf532b59a"><span class="std std-ref">step()</span></a> and <a class="reference internal" href="#classpar2_1_1TransportEngine_1a451d1dbcba471fe55d2ee0f63ad3f075"><span class="std std-ref">advance()</span></a> can be called without allocations</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>stream</strong> – CUDA stream for allocation/init kernels (default: engine stream)</p>
</dd>
<dt class="field-odd">Throws<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><span class="cpp-expr sig sig-inline cpp"><span class="n">std</span><span class="p">::</span><span class="n">runtime_error</span></span></span> – if allocation fails</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportEngine11is_preparedEv">
<span id="_CPPv3NK4par215TransportEngine11is_preparedEv"></span><span id="_CPPv2NK4par215TransportEngine11is_preparedEv"></span><span id="par2::TransportEngine::is_preparedC"></span><span class="target" id="classpar2_1_1TransportEngine_1a48a0c43bedd7d095602672855a24cdbe"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_prepared</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportEngine11is_preparedEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if engine is prepared for stepping. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>true if <a class="reference internal" href="#classpar2_1_1TransportEngine_1ad6789ef1a213665542e57b2f693d5653"><span class="std std-ref">prepare()</span></a> has been called and RNG states are ready </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine11synchronizeEv">
<span id="_CPPv3N4par215TransportEngine11synchronizeEv"></span><span id="_CPPv2N4par215TransportEngine11synchronizeEv"></span><span id="par2::TransportEngine::synchronize"></span><span class="target" id="classpar2_1_1TransportEngine_1a4a740df188604ac7655428afdd44650c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">synchronize</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine11synchronizeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Synchronize the engine stream (wait for all pending work). </p>
<p>Equivalent to cudaStreamSynchronize(stream()), but preferred for clarity. Use this to wait for <a class="reference internal" href="#classpar2_1_1TransportEngine_1afa6a9cd031dc86fa4b40444bf532b59a"><span class="std std-ref">step()</span></a>/advance() to complete.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the ONLY synchronization point the engine exposes. The engine NEVER calls cudaDeviceSynchronize() internally. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Throws<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><span class="cpp-expr sig sig-inline cpp"><span class="n">std</span><span class="p">::</span><span class="n">runtime_error</span></span></span> – if synchronization fails</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine12record_eventE11cudaEvent_t">
<span id="_CPPv3N4par215TransportEngine12record_eventE11cudaEvent_t"></span><span id="_CPPv2N4par215TransportEngine12record_eventE11cudaEvent_t"></span><span id="par2::TransportEngine::record_event__cudaEvent_t"></span><span class="target" id="classpar2_1_1TransportEngine_1aec74ff569be592641fedd6286ac3888d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">record_event</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">cudaEvent_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">event</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine12record_eventE11cudaEvent_t" title="Link to this definition"></a><br /></dt>
<dd><p>Record a CUDA event on the engine stream. </p>
<p>
Use this for fine-grained pipeline synchronization without blocking: <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span><span class="p">.</span><span class="n">step</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
<span class="n">engine</span><span class="p">.</span><span class="n">record_event</span><span class="p">(</span><span class="n">done_event</span><span class="p">);</span>
<span class="c1">// Other solver can cudaStreamWaitEvent(its_stream, done_event, 0);</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>event</strong> – Pre-created CUDA event</p>
</dd>
<dt class="field-even">Throws<span class="colon">:</span></dt>
<dd class="field-even"><p><span><span class="cpp-expr sig sig-inline cpp"><span class="n">std</span><span class="p">::</span><span class="n">runtime_error</span></span></span> – if event recording fails </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine10wait_eventE11cudaEvent_t">
<span id="_CPPv3N4par215TransportEngine10wait_eventE11cudaEvent_t"></span><span id="_CPPv2N4par215TransportEngine10wait_eventE11cudaEvent_t"></span><span id="par2::TransportEngine::wait_event__cudaEvent_t"></span><span class="target" id="classpar2_1_1TransportEngine_1a0d9b39f75639df294f3173d66b8ce35e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">wait_event</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">cudaEvent_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">event</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine10wait_eventE11cudaEvent_t" title="Link to this definition"></a><br /></dt>
<dd><p>Wait for an external event before continuing. </p>
<p>
Makes the engine stream wait for an event from another stream: <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Flow solver records event after updating velocity</span>
<span class="n">cudaEventRecord</span><span class="p">(</span><span class="n">vel_ready</span><span class="p">,</span><span class="w"> </span><span class="n">flow_stream</span><span class="p">);</span>
<span class="c1">// Transport waits for velocity before stepping</span>
<span class="n">engine</span><span class="p">.</span><span class="n">wait_event</span><span class="p">(</span><span class="n">vel_ready</span><span class="p">);</span>
<span class="n">engine</span><span class="p">.</span><span class="n">step</span><span class="p">(</span><span class="n">dt</span><span class="p">);</span>
</pre></div>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This does NOT block the CPU - the wait happens on the GPU. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>event</strong> – External CUDA event to wait on</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportEngine9particlesEv">
<span id="_CPPv3NK4par215TransportEngine9particlesEv"></span><span id="_CPPv2NK4par215TransportEngine9particlesEv"></span><span id="par2::TransportEngine::particlesC"></span><span class="target" id="classpar2_1_1TransportEngine_1a989b022a19f3990fa324493280521832"></span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView"><span class="n"><span class="pre">ConstParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">particles</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportEngine9particlesEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get read-only view of current particle data (device pointers). </p>
<p>Returns the bound particle view with:<ul class="simple">
<li><p>x, y, z: wrapped positions on device</p></li>
<li><p>status: particle status (if tracking enabled)</p></li>
<li><p>wrapX/Y/Z: wrap counters (if periodic BC with tracking)</p></li>
</ul>
</p>
<p><strong>Important</strong>: The returned pointers are device memory. To read on CPU:<ol class="upperalpha simple">
<li><p>Call engine.synchronize() to ensure <a class="reference internal" href="#classpar2_1_1TransportEngine_1afa6a9cd031dc86fa4b40444bf532b59a"><span class="std std-ref">step()</span></a> completed</p></li>
<li><p>Use cudaMemcpy to copy to host</p></li>
</ol>
</p>
<p>Or use <a class="reference internal" href="#classpar2_1_1TransportEngine_1a49909c7eff5f21b0b37df8baa37613b8"><span class="std std-ref">compute_unwrapped_positions()</span></a> + download helpers for full workflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#structpar2_1_1ConstParticlesView"><span class="std std-ref">ConstParticlesView</span></a> with device pointers (read-only) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine27compute_unwrapped_positionsE22UnwrappedPositionsViewI1TE12cudaStream_t">
<span id="_CPPv3N4par215TransportEngine27compute_unwrapped_positionsE22UnwrappedPositionsViewI1TE12cudaStream_t"></span><span id="_CPPv2N4par215TransportEngine27compute_unwrapped_positionsE22UnwrappedPositionsViewI1TE12cudaStream_t"></span><span id="par2::TransportEngine::compute_unwrapped_positions__UnwrappedPositionsView:T:.cudaStream_t"></span><span class="target" id="classpar2_1_1TransportEngine_1a49909c7eff5f21b0b37df8baa37613b8"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compute_unwrapped_positions</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN4par222UnwrappedPositionsViewE" title="par2::UnwrappedPositionsView"><span class="n"><span class="pre">UnwrappedPositionsView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par215TransportEngine27compute_unwrapped_positionsE22UnwrappedPositionsViewI1TE12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Compute unwrapped (continuous) positions on-demand. </p>
<p>For periodic BC, particles wrap around the domain. This kernel computes the continuous positions:</p>
<p>x_u = x + wrapX * Lx y_u = y + wrapY * Ly z_u = z + wrapZ * Lz</p>
<p>If an axis is not periodic or wrapCount is nullptr, the wrapped position is copied directly (x_u = x).</p>
<p>
This is ASYNC: kernel launches on stream, returns immediately. No allocations, no sync.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> – Output view (user-allocated device arrays, capacity &gt;= n) </p></li>
<li><p><strong>stream</strong> – CUDA stream (default: engine stream)</p></li>
</ul>
</dd>
<dt class="field-even">Pre<span class="colon">:</span></dt>
<dd class="field-even"><p>out.capacity &gt;= <a class="reference internal" href="#classpar2_1_1TransportEngine_1afc86ab33f59e50210d839abe96e1ae1e"><span class="std std-ref">num_particles()</span></a></p>
</dd>
<dt class="field-odd">Pre<span class="colon">:</span></dt>
<dd class="field-odd"><p>All output pointers are valid device memory</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-private-members">Private Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportEngine5impl_E">
<span id="_CPPv3N4par215TransportEngine5impl_E"></span><span id="_CPPv2N4par215TransportEngine5impl_E"></span><span id="par2::TransportEngine::impl___std::unique_ptr:detail::EngineImpl:T::"></span><span class="target" id="classpar2_1_1TransportEngine_1a719d195ca4f764cf10d674c67496cadb"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N4par26detailE" title="par2::detail"><span class="n"><span class="pre">detail</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">EngineImpl</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportEngineE" title="par2::TransportEngine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">impl_</span></span></span><a class="headerlink" href="#_CPPv4N4par215TransportEngine5impl_E" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4par26detailE">
<span id="_CPPv3N4par26detailE"></span><span id="_CPPv2N4par26detailE"></span><span id="par2::detail"></span><span class="target" id="namespacepar2_1_1detail"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">detail</span></span></span><a class="headerlink" href="#_CPPv4N4par26detailE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="types-configuration">
<h2>Types &amp; Configuration<a class="headerlink" href="#types-configuration" title="Link to this heading"></a></h2>
<p>Core types for Par2_Core transport engine. </p>
<p>This header defines the fundamental types used throughout the API:<ul class="simple">
<li><p>Boundary conditions (per-axis)</p></li>
<li><p>Transport parameters (diffusion, dispersivity)</p></li>
<li><p>Engine configuration</p></li>
</ul>
</p>
<p><dl class="simple">
<dt><strong>Copyright</strong></dt><dd><p>Par2_Core - GPU-native transport engine </p>
</dd>
</dl>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This header is intentionally lightweight - no CUDA runtime, no Thrust, no heavy dependencies.</p>
</div>
<dl class="cpp type">
<dt class="sig sig-object cpp">
<span class="target" id="namespacepar2"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">par2</span></span></span><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N4par212BoundaryTypeE">
<span id="_CPPv3N4par212BoundaryTypeE"></span><span id="_CPPv2N4par212BoundaryTypeE"></span><span class="target" id="namespacepar2_1ae51033452f837621e98dd86a6977f72e"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BoundaryType</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><a class="headerlink" href="#_CPPv4N4par212BoundaryTypeE" title="Link to this definition"></a><br /></dt>
<dd><p>Boundary condition type for a single axis. </p>
<p>Applied per-face (lo/hi) via <a class="reference internal" href="#structpar2_1_1AxisBoundary"><span class="std std-ref">AxisBoundary</span></a>. See boundary.hpp for full config.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#structpar2_1_1AxisBoundary"><span class="std std-ref">AxisBoundary</span></a>, <a class="reference internal" href="#structpar2_1_1BoundaryConfig"><span class="std std-ref">BoundaryConfig</span></a></p>
</div>
</p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4par212BoundaryType6ClosedE">
<span id="_CPPv3N4par212BoundaryType6ClosedE"></span><span id="_CPPv2N4par212BoundaryType6ClosedE"></span><span class="target" id="namespacepar2_1ae51033452f837621e98dd86a6977f72ea03f4a47830f97377a35321051685071e"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Closed</span></span></span><a class="headerlink" href="#_CPPv4N4par212BoundaryType6ClosedE" title="Link to this definition"></a><br /></dt>
<dd><p>Reflective boundary (displacement rejection). </p>
<p>If the proposed new position exits the domain (strict inequality: lo &lt; x &lt; hi), the <strong>entire displacement is zeroed</strong> and the particle stays at its current position. This is a rejection scheme, not a bounce/reflection scheme. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4par212BoundaryType8PeriodicE">
<span id="_CPPv3N4par212BoundaryType8PeriodicE"></span><span id="_CPPv2N4par212BoundaryType8PeriodicE"></span><span class="target" id="namespacepar2_1ae51033452f837621e98dd86a6977f72eacdcc32a064503184053bd2018d1c0e7e"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Periodic</span></span></span><a class="headerlink" href="#_CPPv4N4par212BoundaryType8PeriodicE" title="Link to this definition"></a><br /></dt>
<dd><p>Wrap-around: position wraps modulo domain length. </p>
<p>Both lo and hi faces of the axis must be set to Periodic. A wrap counter (int32_t) tracks net domain crossings. Wrapped domain is [lo, hi).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires status/wrap arrays to be allocated (via ensure_tracking_arrays() or prepare()) for wrap counting. </p>
</div>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4par212BoundaryType4OpenE">
<span id="_CPPv3N4par212BoundaryType4OpenE"></span><span id="_CPPv2N4par212BoundaryType4OpenE"></span><span class="target" id="namespacepar2_1ae51033452f837621e98dd86a6977f72eac3bf447eabe632720a3aa1a7ce401274"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Open</span></span></span><a class="headerlink" href="#_CPPv4N4par212BoundaryType4OpenE" title="Link to this definition"></a><br /></dt>
<dd><p>Allow exit: particle flagged as Exited. </p>
<p>If the new position exits the domain, the particle retains its current position and is marked <a class="reference internal" href="#namespacepar2_1a7c204ae8d485714ee4a7935edc563101a268ce394e277db759f5d6ee76c59f0e7"><span class="std std-ref">ParticleStatus::Exited</span></a>. Exited particles are skipped in subsequent step() calls.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires status array to be allocated (auto-allocated by prepare() / ensure_tracking_arrays()). </p>
</div>
</dd></dl>

</dd></dl>

<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N4par217InterpolationModeE">
<span id="_CPPv3N4par217InterpolationModeE"></span><span id="_CPPv2N4par217InterpolationModeE"></span><span class="target" id="namespacepar2_1a7c8f4da66964574b306027d770c0f963"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InterpolationMode</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><a class="headerlink" href="#_CPPv4N4par217InterpolationModeE" title="Link to this definition"></a><br /></dt>
<dd><p>Velocity interpolation mode. </p>
<p>Controls how velocity is sampled at particle positions.</p>
<p><ul class="simple">
<li><p><strong>Linear</strong>: Face-centered bilinear interpolation (faster)</p></li>
<li><p><strong>Trilinear</strong>: Corner-based trilinear interpolation (smoother)</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Legacy PAR² uses Linear interpolation ALWAYS. The YAML “interpolation” field in legacy configs controls the DRIFT mode, not velocity interpolation. </p>
</div>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4par217InterpolationMode6LinearE">
<span id="_CPPv3N4par217InterpolationMode6LinearE"></span><span id="_CPPv2N4par217InterpolationMode6LinearE"></span><span class="target" id="namespacepar2_1a7c8f4da66964574b306027d770c0f963a32a843da6ea40ab3b17a3421ccdf671b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Linear</span></span></span><a class="headerlink" href="#_CPPv4N4par217InterpolationMode6LinearE" title="Link to this definition"></a><br /></dt>
<dd><p>Face-centered linear interpolation (faster) </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4par217InterpolationMode9TrilinearE">
<span id="_CPPv3N4par217InterpolationMode9TrilinearE"></span><span id="_CPPv2N4par217InterpolationMode9TrilinearE"></span><span class="target" id="namespacepar2_1a7c8f4da66964574b306027d770c0f963a969a7b6f1f3951ef293b3ff281dc293d"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Trilinear</span></span></span><a class="headerlink" href="#_CPPv4N4par217InterpolationMode9TrilinearE" title="Link to this definition"></a><br /></dt>
<dd><p>Corner-based trilinear interpolation (smoother) </p>
</dd></dl>

</dd></dl>

<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N4par219DriftCorrectionModeE">
<span id="_CPPv3N4par219DriftCorrectionModeE"></span><span id="_CPPv2N4par219DriftCorrectionModeE"></span><span class="target" id="namespacepar2_1a2e9b0a2b6e4d6f65763b00f8c87aa181"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DriftCorrectionMode</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><a class="headerlink" href="#_CPPv4N4par219DriftCorrectionModeE" title="Link to this definition"></a><br /></dt>
<dd><p>Drift correction computation mode. </p>
<p>The drift correction term (div(D)) arises from the Fokker-Planck equation and compensates for the spatial variation of the dispersion tensor D. Without this term, particles would accumulate in low-dispersion regions.</p>
<p><strong>The dispersion tensor D is defined as:</strong> <div class="math notranslate nohighlight">
\[
  D_{ij} = (\alpha_T |v| + D_m) \delta_{ij} + (\alpha_L - \alpha_T) \frac{v_i v_j}{|v|}
\]</div>
</p>
<p><strong>The drift correction term is:</strong> <div class="math notranslate nohighlight">
\[
  v_{drift,i} = \sum_j \frac{\partial D_{ij}}{\partial x_j}
\]</div>
</p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4par219DriftCorrectionMode4NoneE">
<span id="_CPPv3N4par219DriftCorrectionMode4NoneE"></span><span id="_CPPv2N4par219DriftCorrectionMode4NoneE"></span><span class="target" id="namespacepar2_1a2e9b0a2b6e4d6f65763b00f8c87aa181a6adf97f83acf6453d4a6a4b1070f3754"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">None</span></span></span><a class="headerlink" href="#_CPPv4N4par219DriftCorrectionMode4NoneE" title="Link to this definition"></a><br /></dt>
<dd><p>No drift correction (only valid if dispersion is zero) </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4par219DriftCorrectionMode11PrecomputedE">
<span id="_CPPv3N4par219DriftCorrectionMode11PrecomputedE"></span><span id="_CPPv2N4par219DriftCorrectionMode11PrecomputedE"></span><span class="target" id="namespacepar2_1a2e9b0a2b6e4d6f65763b00f8c87aa181a04021d95a37003c16d27a38d407e3304"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Precomputed</span></span></span><a class="headerlink" href="#_CPPv4N4par219DriftCorrectionMode11PrecomputedE" title="Link to this definition"></a><br /></dt>
<dd><p>Use precomputed cell-centered div(D) field (legacy: “finite difference”) </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4par219DriftCorrectionMode14TrilinearOnFlyE">
<span id="_CPPv3N4par219DriftCorrectionMode14TrilinearOnFlyE"></span><span id="_CPPv2N4par219DriftCorrectionMode14TrilinearOnFlyE"></span><span class="target" id="namespacepar2_1a2e9b0a2b6e4d6f65763b00f8c87aa181aba8be745c90c7d1c79753cd7dda9b925"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TrilinearOnFly</span></span></span><a class="headerlink" href="#_CPPv4N4par219DriftCorrectionMode14TrilinearOnFlyE" title="Link to this definition"></a><br /></dt>
<dd><p>Compute div(D) on-the-fly via trilinear derivatives (legacy: “trilinear”) </p>
</dd></dl>

</dd></dl>

<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N4par214ParticleStatusE">
<span id="_CPPv3N4par214ParticleStatusE"></span><span id="_CPPv2N4par214ParticleStatusE"></span><span class="target" id="namespacepar2_1a7c204ae8d485714ee4a7935edc563101"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ParticleStatus</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><a class="headerlink" href="#_CPPv4N4par214ParticleStatusE" title="Link to this definition"></a><br /></dt>
<dd><p>Status flags for particles. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4par214ParticleStatus6ActiveE">
<span id="_CPPv3N4par214ParticleStatus6ActiveE"></span><span id="_CPPv2N4par214ParticleStatus6ActiveE"></span><span class="target" id="namespacepar2_1a7c204ae8d485714ee4a7935edc563101a4d3d769b812b6faa6b76e1a8abaece2d"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Active</span></span></span><a class="headerlink" href="#_CPPv4N4par214ParticleStatus6ActiveE" title="Link to this definition"></a><br /></dt>
<dd><p>Particle is active in simulation. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4par214ParticleStatus6ExitedE">
<span id="_CPPv3N4par214ParticleStatus6ExitedE"></span><span id="_CPPv2N4par214ParticleStatus6ExitedE"></span><span class="target" id="namespacepar2_1a7c204ae8d485714ee4a7935edc563101a268ce394e277db759f5d6ee76c59f0e7"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Exited</span></span></span><a class="headerlink" href="#_CPPv4N4par214ParticleStatus6ExitedE" title="Link to this definition"></a><br /></dt>
<dd><p>Particle exited via open boundary. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4par214ParticleStatus8InactiveE">
<span id="_CPPv3N4par214ParticleStatus8InactiveE"></span><span id="_CPPv2N4par214ParticleStatus8InactiveE"></span><span class="target" id="namespacepar2_1a7c204ae8d485714ee4a7935edc563101a3cab03c00dbd11bc3569afa0748013f0"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Inactive</span></span></span><a class="headerlink" href="#_CPPv4N4par214ParticleStatus8InactiveE" title="Link to this definition"></a><br /></dt>
<dd><p>Particle slot is unused. </p>
</dd></dl>

</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4par212EngineConfigE">
<span id="_CPPv3N4par212EngineConfigE"></span><span id="_CPPv2N4par212EngineConfigE"></span><span id="par2::EngineConfig"></span><span class="target" id="structpar2_1_1EngineConfig"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">EngineConfig</span></span></span><a class="headerlink" href="#_CPPv4N4par212EngineConfigE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;types.hpp&gt;</em></div>
<p>Engine runtime configuration. </p>
<p>Configures the algorithm modes for RWPT simulation:</p>
<p><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>interpolation_mode   </p></th>
<th class="head"><p>drift_mode   </p></th>
<th class="head"><p>Description    </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Linear   </p></td>
<td><p>Precomputed   </p></td>
<td><p>Fast, good for steady flow    </p></td>
</tr>
<tr class="row-odd"><td><p>Linear   </p></td>
<td><p>TrilinearOnFly   </p></td>
<td><p>Accurate drift, linear v    </p></td>
</tr>
<tr class="row-even"><td><p>Trilinear   </p></td>
<td><p>TrilinearOnFly   </p></td>
<td><p>Full legacy parity (smoothest)    </p></td>
</tr>
<tr class="row-odd"><td><p>Trilinear   </p></td>
<td><p>Precomputed   </p></td>
<td><p>Valid but uncommon   </p></td>
</tr>
</tbody>
</table>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par212EngineConfig18interpolation_modeE">
<span id="_CPPv3N4par212EngineConfig18interpolation_modeE"></span><span id="_CPPv2N4par212EngineConfig18interpolation_modeE"></span><span id="par2::EngineConfig::interpolation_mode__InterpolationMode"></span><span class="target" id="structpar2_1_1EngineConfig_1a4dcaf47758f162d8f489eab1aad73e47"></span><a class="reference internal" href="#_CPPv4N4par217InterpolationModeE" title="par2::InterpolationMode"><span class="n"><span class="pre">InterpolationMode</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interpolation_mode</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par217InterpolationModeE" title="par2::InterpolationMode"><span class="n"><span class="pre">InterpolationMode</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4par217InterpolationMode6LinearE" title="par2::InterpolationMode::Linear"><span class="n"><span class="pre">Linear</span></span></a><a class="headerlink" href="#_CPPv4N4par212EngineConfig18interpolation_modeE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par212EngineConfig10drift_modeE">
<span id="_CPPv3N4par212EngineConfig10drift_modeE"></span><span id="_CPPv2N4par212EngineConfig10drift_modeE"></span><span id="par2::EngineConfig::drift_mode__DriftCorrectionMode"></span><span class="target" id="structpar2_1_1EngineConfig_1a19e775dd5696c06c55096c8d27c09d82"></span><a class="reference internal" href="#_CPPv4N4par219DriftCorrectionModeE" title="par2::DriftCorrectionMode"><span class="n"><span class="pre">DriftCorrectionMode</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">drift_mode</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par219DriftCorrectionModeE" title="par2::DriftCorrectionMode"><span class="n"><span class="pre">DriftCorrectionMode</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4par219DriftCorrectionMode14TrilinearOnFlyE" title="par2::DriftCorrectionMode::TrilinearOnFly"><span class="n"><span class="pre">TrilinearOnFly</span></span></a><a class="headerlink" href="#_CPPv4N4par212EngineConfig10drift_modeE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par212EngineConfig8rng_seedE">
<span id="_CPPv3N4par212EngineConfig8rng_seedE"></span><span id="_CPPv2N4par212EngineConfig8rng_seedE"></span><span id="par2::EngineConfig::rng_seed__uint64_t"></span><span class="target" id="structpar2_1_1EngineConfig_1a5f1ee14667cb8cfd5629b3ba0b3520d9"></span><span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rng_seed</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">12345ULL</span></span><a class="headerlink" href="#_CPPv4N4par212EngineConfig8rng_seedE" title="Link to this definition"></a><br /></dt>
<dd><p>Seed for curand XORWOW initialization. </p>
<p>Each particle gets independent curandState_t initialized via curand_init(seed, particle_index, 0, &amp;state).</p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par212EngineConfig17kernel_block_sizeE">
<span id="_CPPv3N4par212EngineConfig17kernel_block_sizeE"></span><span id="_CPPv2N4par212EngineConfig17kernel_block_sizeE"></span><span id="par2::EngineConfig::kernel_block_size__i"></span><span class="target" id="structpar2_1_1EngineConfig_1a4f0d4554d0c526cfd680d2569449034f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kernel_block_size</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">256</span></span><a class="headerlink" href="#_CPPv4N4par212EngineConfig17kernel_block_sizeE" title="Link to this definition"></a><br /></dt>
<dd><p>Block size for CUDA kernels (0 = auto-select) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par212EngineConfig12debug_checksE">
<span id="_CPPv3N4par212EngineConfig12debug_checksE"></span><span id="_CPPv2N4par212EngineConfig12debug_checksE"></span><span id="par2::EngineConfig::debug_checks__b"></span><span class="target" id="structpar2_1_1EngineConfig_1ab81902eb1552d990b0902dcd6574abb4"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">debug_checks</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4par212EngineConfig12debug_checksE" title="Link to this definition"></a><br /></dt>
<dd><p>Enable runtime debug checks (default: false). </p>
<p>When true, the engine checks for CUDA errors after kernel launches. This adds a cudaPeekAtLastError() call per launch (no sync, but overhead).</p>
<p>For HPC builds, prefer compile-time control via PAR2_DEBUG_LEVEL.</p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Deprecated:</span></em></dt>
<dd><p>Use PAR2_DEBUG_LEVEL compile-time flag for zero-overhead debug. </p>
</dd></dl>

</p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par212EngineConfig14nan_preventionE">
<span id="_CPPv3N4par212EngineConfig14nan_preventionE"></span><span id="_CPPv2N4par212EngineConfig14nan_preventionE"></span><span id="par2::EngineConfig::nan_prevention__b"></span><span class="target" id="structpar2_1_1EngineConfig_1a7b4639e46d29f167ab4151d01b1bfbea"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nan_prevention</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><a class="headerlink" href="#_CPPv4N4par212EngineConfig14nan_preventionE" title="Link to this definition"></a><br /></dt>
<dd><p>Enable extra NaN-prevention guards (default: true = safe). </p>
<p>When true (default), applies tolerance checks in places where legacy PAR² could produce NaN due to division by zero (e.g., D tensor computation in Precomputed drift mode when |v| ≈ 0).</p>
<p>When false (legacy-strict), disables these guards to match legacy behavior exactly. Use only for regression testing against original PAR².</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This creates a branch per particle in the kernel. For maximum HPC performance with known-safe velocity fields, set to false.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The tolerance in TrilinearOnFly mode exists in legacy and is NOT affected by this flag. </p>
</div>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par29StepStatsE">
<span id="_CPPv3I0EN4par29StepStatsE"></span><span id="_CPPv2I0EN4par29StepStatsE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1StepStats"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StepStats</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par29StepStatsE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;types.hpp&gt;</em></div>
<p>Summary statistics from simulation step. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par29StepStats16active_particlesE">
<span id="_CPPv3N4par29StepStats16active_particlesE"></span><span id="_CPPv2N4par29StepStats16active_particlesE"></span><span id="par2::StepStats::active_particles__i"></span><span class="target" id="structpar2_1_1StepStats_1a512d0b852b43a6119c968f3d7d90ab1b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">active_particles</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par29StepStats16active_particlesE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par29StepStats16exited_particlesE">
<span id="_CPPv3N4par29StepStats16exited_particlesE"></span><span id="_CPPv2N4par29StepStats16exited_particlesE"></span><span id="par2::StepStats::exited_particles__i"></span><span class="target" id="structpar2_1_1StepStats_1ab47b8de0f4d850c890cc435660f83c8f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">exited_particles</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par29StepStats16exited_particlesE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par29StepStats16max_displacementE">
<span id="_CPPv3N4par29StepStats16max_displacementE"></span><span id="_CPPv2N4par29StepStats16max_displacementE"></span><span id="par2::StepStats::max_displacement__T"></span><span class="target" id="structpar2_1_1StepStats_1a7c29864ad3d5deceb9cd64a1f7767efa"></span><a class="reference internal" href="#_CPPv4I0EN4par29StepStatsE" title="par2::StepStats::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">max_displacement</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par29StepStatsE" title="par2::StepStats::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par29StepStats16max_displacementE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par215TransportParamsE">
<span id="_CPPv3I0EN4par215TransportParamsE"></span><span id="_CPPv2I0EN4par215TransportParamsE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1TransportParams"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TransportParams</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par215TransportParamsE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;types.hpp&gt;</em></div>
<p>Physical transport parameters for RWPT. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Units must be consistent across all inputs:<ul class="simple">
<li><p>If grid is in meters, diffusion is m²/s, dispersivity is m</p></li>
<li><p>Velocity field must have units of length/time </p></li>
</ul>
</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type (float or double)</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215TransportParams14has_dispersionEv">
<span id="_CPPv3NK4par215TransportParams14has_dispersionEv"></span><span id="_CPPv2NK4par215TransportParams14has_dispersionEv"></span><span id="par2::TransportParams::has_dispersionCCE"></span><span class="target" id="structpar2_1_1TransportParams_1a667b24825526fb59874376ccf22259cf"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_dispersion</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215TransportParams14has_dispersionEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if any dispersion is enabled. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportParams19molecular_diffusionE">
<span id="_CPPv3N4par215TransportParams19molecular_diffusionE"></span><span id="_CPPv2N4par215TransportParams19molecular_diffusionE"></span><span id="par2::TransportParams::molecular_diffusion__T"></span><span class="target" id="structpar2_1_1TransportParams_1adb0ad03a6b5713d4bc80d322c7f615b9"></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportParamsE" title="par2::TransportParams::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">molecular_diffusion</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par215TransportParamsE" title="par2::TransportParams::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par215TransportParams19molecular_diffusionE" title="Link to this definition"></a><br /></dt>
<dd><p>Effective molecular diffusion coefficient [L²/T]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportParams7alpha_lE">
<span id="_CPPv3N4par215TransportParams7alpha_lE"></span><span id="_CPPv2N4par215TransportParams7alpha_lE"></span><span id="par2::TransportParams::alpha_l__T"></span><span class="target" id="structpar2_1_1TransportParams_1a0e930c4ffd743cc0fa8062569ba51b57"></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportParamsE" title="par2::TransportParams::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">alpha_l</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par215TransportParamsE" title="par2::TransportParams::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par215TransportParams7alpha_lE" title="Link to this definition"></a><br /></dt>
<dd><p>Longitudinal dispersivity [L]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par215TransportParams7alpha_tE">
<span id="_CPPv3N4par215TransportParams7alpha_tE"></span><span id="_CPPv2N4par215TransportParams7alpha_tE"></span><span id="par2::TransportParams::alpha_t__T"></span><span class="target" id="structpar2_1_1TransportParams_1a8a0a1001fbf7a19d2741057eeb4c86c2"></span><a class="reference internal" href="#_CPPv4I0EN4par215TransportParamsE" title="par2::TransportParams::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">alpha_t</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par215TransportParamsE" title="par2::TransportParams::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par215TransportParams7alpha_tE" title="Link to this definition"></a><br /></dt>
<dd><p>Transverse dispersivity [L]. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="grid">
<h2>Grid<a class="headerlink" href="#grid" title="Link to this heading"></a></h2>
<p>Grid descriptor for Par2_Core. </p>
<p>Defines the computational grid geometry without storing any data. This is a lightweight POD struct that can be passed by value to kernels.</p>
<p><dl class="simple">
<dt><strong>Copyright</strong></dt><dd><p>Par2_Core - GPU-native transport engine </p>
</dd>
</dl>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Layout convention follows legacy PAR²:<ul class="simple">
<li><p>Cell indexing: id = idz * (ny * nx) + idy * nx + idx</p></li>
<li><p>Face/corner fields: (nx+1) * (ny+1) * (nz+1) elements</p></li>
<li><p>Origin (px,py,pz) is the corner of cell (0,0,0), not its center</p></li>
</ul>
</p>
</div>
<dl class="cpp type">
<dt class="sig sig-object cpp">
<span class="target" id="namespacepar2"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">par2</span></span></span><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T">
<span id="_CPPv3I0EN4par29make_gridEiii1T1T1T1T1T1T"></span><span id="_CPPv2I0EN4par29make_gridEiii1T1T1T1T1T1T"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1afb55ec367056066af329d25184ae68c5"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc"><span class="n"><span class="pre">GridDesc</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T" title="par2::make_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">make_grid</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nx</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ny</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nz</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T" title="par2::make_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">dx</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T" title="par2::make_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">dy</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T" title="par2::make_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">dz</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T" title="par2::make_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">px</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T" title="par2::make_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T" title="par2::make_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">py</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T" title="par2::make_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T" title="par2::make_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pz</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T" title="par2::make_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4I0EN4par29make_gridE8GridDescI1TEiii1T1T1T1T1T1T" title="Link to this definition"></a><br /></dt>
<dd><p>Create a uniform grid descriptor. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nx, ny, nz</strong> – Number of cells in each direction </p></li>
<li><p><strong>dx, dy, dz</strong> – Cell sizes </p></li>
<li><p><strong>px, py, pz</strong> – Origin coordinates (default: 0,0,0) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par217make_uniform_gridE8GridDescI1TEiii1T1T1T1T">
<span id="_CPPv3I0EN4par217make_uniform_gridEiii1T1T1T1T"></span><span id="_CPPv2I0EN4par217make_uniform_gridEiii1T1T1T1T"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1a8d9deed7320c41adfe7d35338362443f"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc"><span class="n"><span class="pre">GridDesc</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par217make_uniform_gridE8GridDescI1TEiii1T1T1T1T" title="par2::make_uniform_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">make_uniform_grid</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nx</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ny</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nz</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par217make_uniform_gridE8GridDescI1TEiii1T1T1T1T" title="par2::make_uniform_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">cell_size</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par217make_uniform_gridE8GridDescI1TEiii1T1T1T1T" title="par2::make_uniform_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">px</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par217make_uniform_gridE8GridDescI1TEiii1T1T1T1T" title="par2::make_uniform_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par217make_uniform_gridE8GridDescI1TEiii1T1T1T1T" title="par2::make_uniform_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">py</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par217make_uniform_gridE8GridDescI1TEiii1T1T1T1T" title="par2::make_uniform_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par217make_uniform_gridE8GridDescI1TEiii1T1T1T1T" title="par2::make_uniform_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pz</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par217make_uniform_gridE8GridDescI1TEiii1T1T1T1T" title="par2::make_uniform_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4I0EN4par217make_uniform_gridE8GridDescI1TEiii1T1T1T1T" title="Link to this definition"></a><br /></dt>
<dd><p>Create a uniform grid with same cell size in all directions. </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par28GridDescE">
<span id="_CPPv3I0EN4par28GridDescE"></span><span id="_CPPv2I0EN4par28GridDescE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1GridDesc"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GridDesc</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par28GridDescE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;grid.hpp&gt;</em></div>
<p>Cartesian grid descriptor. </p>
<p>
Describes a uniform Cartesian grid with:<ul class="simple">
<li><p>nx × ny × nz cells</p></li>
<li><p>Cell sizes dx, dy, dz (uniform per axis)</p></li>
<li><p>Origin at (px, py, pz) — this is the <strong>corner</strong> of cell (0,0,0), not the cell center</p></li>
</ul>
</p>
<p>The domain spans:<ul class="simple">
<li><p>X: [px, px + nx*dx]</p></li>
<li><p>Y: [py, py + ny*dy]</p></li>
<li><p>Z: [pz, pz + nz*dz]</p></li>
</ul>
</p>
<p>For 2D simulations, set nz=1. The kernel forces Z displacement to zero and skips Z boundary checks when nz==1.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a lightweight POD struct that can be passed by value to CUDA kernels (no pointers, no dynamic memory). </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type (float or double)</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par28GridDesc9num_cellsEv">
<span id="_CPPv3NK4par28GridDesc9num_cellsEv"></span><span id="_CPPv2NK4par28GridDesc9num_cellsEv"></span><span id="par2::GridDesc::num_cellsCCE"></span><span class="target" id="structpar2_1_1GridDesc_1a7bf2cfb45d5472e916a86c7c470685ef"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_cells</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par28GridDesc9num_cellsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Total number of cells. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par28GridDesc11num_cornersEv">
<span id="_CPPv3NK4par28GridDesc11num_cornersEv"></span><span id="_CPPv2NK4par28GridDesc11num_cornersEv"></span><span id="par2::GridDesc::num_cornersCCE"></span><span class="target" id="structpar2_1_1GridDesc_1ab9e86379cff9d1130dfdd78d6f0ba546"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_corners</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par28GridDesc11num_cornersEv" title="Link to this definition"></a><br /></dt>
<dd><p>Size of face/corner field arrays: (nx+1)*(ny+1)*(nz+1) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par28GridDesc8length_xEv">
<span id="_CPPv3NK4par28GridDesc8length_xEv"></span><span id="_CPPv2NK4par28GridDesc8length_xEv"></span><span id="par2::GridDesc::length_xCCE"></span><span class="target" id="structpar2_1_1GridDesc_1a4ec430ad543048b8dca216c6df6c2272"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">length_x</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par28GridDesc8length_xEv" title="Link to this definition"></a><br /></dt>
<dd><p>Domain extent in X. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par28GridDesc8length_yEv">
<span id="_CPPv3NK4par28GridDesc8length_yEv"></span><span id="_CPPv2NK4par28GridDesc8length_yEv"></span><span id="par2::GridDesc::length_yCCE"></span><span class="target" id="structpar2_1_1GridDesc_1ab841928782deb261230168b0ed9b891a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">length_y</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par28GridDesc8length_yEv" title="Link to this definition"></a><br /></dt>
<dd><p>Domain extent in Y. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par28GridDesc8length_zEv">
<span id="_CPPv3NK4par28GridDesc8length_zEv"></span><span id="_CPPv2NK4par28GridDesc8length_zEv"></span><span id="par2::GridDesc::length_zCCE"></span><span class="target" id="structpar2_1_1GridDesc_1a59c0c1a922d5f5d68a695fcd3c3c4992"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">length_z</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par28GridDesc8length_zEv" title="Link to this definition"></a><br /></dt>
<dd><p>Domain extent in Z. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par28GridDesc11cell_volumeEv">
<span id="_CPPv3NK4par28GridDesc11cell_volumeEv"></span><span id="_CPPv2NK4par28GridDesc11cell_volumeEv"></span><span id="par2::GridDesc::cell_volumeCCE"></span><span class="target" id="structpar2_1_1GridDesc_1ae07dfc7d7aea0a354ea39e2372212e82"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cell_volume</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par28GridDesc11cell_volumeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Volume of a single cell. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par28GridDesc13domain_volumeEv">
<span id="_CPPv3NK4par28GridDesc13domain_volumeEv"></span><span id="_CPPv2NK4par28GridDesc13domain_volumeEv"></span><span id="par2::GridDesc::domain_volumeCCE"></span><span class="target" id="structpar2_1_1GridDesc_1a9ac2d2bb5d5b4d6a32d3f27bc787fb98"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">domain_volume</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par28GridDesc13domain_volumeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Total domain volume. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par28GridDesc5is_2dEv">
<span id="_CPPv3NK4par28GridDesc5is_2dEv"></span><span id="_CPPv2NK4par28GridDesc5is_2dEv"></span><span id="par2::GridDesc::is_2dCCE"></span><span class="target" id="structpar2_1_1GridDesc_1abcafee817e9d34778434d93b919da709"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_2d</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par28GridDesc5is_2dEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if this is a 2D grid (nz == 1) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par28GridDesc5x_maxEv">
<span id="_CPPv3NK4par28GridDesc5x_maxEv"></span><span id="_CPPv2NK4par28GridDesc5x_maxEv"></span><span id="par2::GridDesc::x_maxCCE"></span><span class="target" id="structpar2_1_1GridDesc_1a1aa60e995e105774b135e3036bba4b2d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">x_max</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par28GridDesc5x_maxEv" title="Link to this definition"></a><br /></dt>
<dd><p>Maximum coordinate in X. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par28GridDesc5y_maxEv">
<span id="_CPPv3NK4par28GridDesc5y_maxEv"></span><span id="_CPPv2NK4par28GridDesc5y_maxEv"></span><span id="par2::GridDesc::y_maxCCE"></span><span class="target" id="structpar2_1_1GridDesc_1ae9a615833c9017937fabf1ab9bc86dad"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">y_max</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par28GridDesc5y_maxEv" title="Link to this definition"></a><br /></dt>
<dd><p>Maximum coordinate in Y. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par28GridDesc5z_maxEv">
<span id="_CPPv3NK4par28GridDesc5z_maxEv"></span><span id="_CPPv2NK4par28GridDesc5z_maxEv"></span><span id="par2::GridDesc::z_maxCCE"></span><span class="target" id="structpar2_1_1GridDesc_1a6eae0ab953aa33fecb431b812d8efa7b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">z_max</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par28GridDesc5z_maxEv" title="Link to this definition"></a><br /></dt>
<dd><p>Maximum coordinate in Z. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par28GridDesc2nxE">
<span id="_CPPv3N4par28GridDesc2nxE"></span><span id="_CPPv2N4par28GridDesc2nxE"></span><span id="par2::GridDesc::nx__i"></span><span class="target" id="structpar2_1_1GridDesc_1a2abe9b3191dfb3b077aa10bc1bf86479"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nx</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv4N4par28GridDesc2nxE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of cells in X direction. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par28GridDesc2nyE">
<span id="_CPPv3N4par28GridDesc2nyE"></span><span id="_CPPv2N4par28GridDesc2nyE"></span><span id="par2::GridDesc::ny__i"></span><span class="target" id="structpar2_1_1GridDesc_1a6c2f59f87dbcc787636748f4aeddb997"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ny</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv4N4par28GridDesc2nyE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of cells in Y direction. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par28GridDesc2nzE">
<span id="_CPPv3N4par28GridDesc2nzE"></span><span id="_CPPv2N4par28GridDesc2nzE"></span><span id="par2::GridDesc::nz__i"></span><span class="target" id="structpar2_1_1GridDesc_1adf3c3c8bb21b9cffa5da6d476da445f5"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nz</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv4N4par28GridDesc2nzE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of cells in Z direction (1 for 2D) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par28GridDesc2dxE">
<span id="_CPPv3N4par28GridDesc2dxE"></span><span id="_CPPv2N4par28GridDesc2dxE"></span><span id="par2::GridDesc::dx__T"></span><span class="target" id="structpar2_1_1GridDesc_1a08c17ce77559b34c842a0f07b6ffecc5"></span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dx</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par28GridDesc2dxE" title="Link to this definition"></a><br /></dt>
<dd><p>Cell size in X direction. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par28GridDesc2dyE">
<span id="_CPPv3N4par28GridDesc2dyE"></span><span id="_CPPv2N4par28GridDesc2dyE"></span><span id="par2::GridDesc::dy__T"></span><span class="target" id="structpar2_1_1GridDesc_1a9116ec29aacb5aae053a1dd095ff4f65"></span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dy</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par28GridDesc2dyE" title="Link to this definition"></a><br /></dt>
<dd><p>Cell size in Y direction. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par28GridDesc2dzE">
<span id="_CPPv3N4par28GridDesc2dzE"></span><span id="_CPPv2N4par28GridDesc2dzE"></span><span id="par2::GridDesc::dz__T"></span><span class="target" id="structpar2_1_1GridDesc_1a7c1c6c8e3b6c9d7fb2f845cacc107aed"></span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dz</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par28GridDesc2dzE" title="Link to this definition"></a><br /></dt>
<dd><p>Cell size in Z direction. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par28GridDesc2pxE">
<span id="_CPPv3N4par28GridDesc2pxE"></span><span id="_CPPv2N4par28GridDesc2pxE"></span><span id="par2::GridDesc::px__T"></span><span class="target" id="structpar2_1_1GridDesc_1a92e43684a05381fcd91aafb26457b204"></span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">px</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par28GridDesc2pxE" title="Link to this definition"></a><br /></dt>
<dd><p>X-coordinate of origin. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par28GridDesc2pyE">
<span id="_CPPv3N4par28GridDesc2pyE"></span><span id="_CPPv2N4par28GridDesc2pyE"></span><span id="par2::GridDesc::py__T"></span><span class="target" id="structpar2_1_1GridDesc_1a89282173fe1c17dd52cb6d21f7a53d35"></span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">py</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par28GridDesc2pyE" title="Link to this definition"></a><br /></dt>
<dd><p>Y-coordinate of origin. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par28GridDesc2pzE">
<span id="_CPPv3N4par28GridDesc2pzE"></span><span id="_CPPv2N4par28GridDesc2pzE"></span><span id="par2::GridDesc::pz__T"></span><span class="target" id="structpar2_1_1GridDesc_1a9d9c209faaf795d357ce3f1379776d33"></span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pz</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par28GridDesc2pzE" title="Link to this definition"></a><br /></dt>
<dd><p>Z-coordinate of origin. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="views-zero-copy-binding">
<h2>Views (Zero-Copy Binding)<a class="headerlink" href="#views-zero-copy-binding" title="Link to this heading"></a></h2>
<p>Lightweight view types for GPU data (zero-copy binding). </p>
<p>These structs hold device pointers and sizes but do NOT own the memory. They enable the engine to operate on user-allocated GPU buffers directly, without copying data.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>velocity_layout.hpp for detailed velocity field layout documentation.</p>
</div>
<dl class="simple">
<dt><strong>Copyright</strong></dt><dd><p>Par2_Core - GPU-native transport engine </p>
</dd>
</dl>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>NO Thrust headers here - just raw pointers and sizes. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All pointers must point to device memory (cudaMalloc, etc.)</p>
</div>
<dl class="cpp type">
<dt class="sig sig-object cpp">
<span class="target" id="namespacepar2"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">par2</span></span></span><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par215ConstDeviceSpanE">
<span id="_CPPv3I0EN4par215ConstDeviceSpanE"></span><span id="_CPPv2I0EN4par215ConstDeviceSpanE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1ae3350f9b866313b2d6377e166241f2c0"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ConstDeviceSpan</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par210DeviceSpanE" title="par2::DeviceSpan"><span class="n"><span class="pre">DeviceSpan</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par215ConstDeviceSpanE" title="par2::ConstDeviceSpan::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I0EN4par215ConstDeviceSpanE" title="Link to this definition"></a><br /></dt>
<dd><p>Convenience alias for const views. </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par218ConstParticlesViewE">
<span id="_CPPv3I0EN4par218ConstParticlesViewE"></span><span id="_CPPv2I0EN4par218ConstParticlesViewE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1ConstParticlesView"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ConstParticlesView</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;views.hpp&gt;</em></div>
<p>Read-only view of particle positions. </p>
<p>Use this when you only need to read particle data (e.g., for statistics). </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par218ConstParticlesView5validEv">
<span id="_CPPv3NK4par218ConstParticlesView5validEv"></span><span id="_CPPv2NK4par218ConstParticlesView5validEv"></span><span id="par2::ConstParticlesView::validCCE"></span><span class="target" id="structpar2_1_1ConstParticlesView_1a6cfbcb682db6409528f2304d1811606f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">valid</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par218ConstParticlesView5validEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par218ConstParticlesView18ConstParticlesViewEv">
<span id="_CPPv3N4par218ConstParticlesView18ConstParticlesViewEv"></span><span id="_CPPv2N4par218ConstParticlesView18ConstParticlesViewEv"></span><span id="par2::ConstParticlesView::ConstParticlesView"></span><span class="target" id="structpar2_1_1ConstParticlesView_1a6691d9cd9a6b0a0ca047375f1840458b"></span><span class="sig-name descname"><span class="n"><span class="pre">ConstParticlesView</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N4par218ConstParticlesView18ConstParticlesViewEv" title="Link to this definition"></a><br /></dt>
<dd><p>Implicit conversion from mutable view. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par218ConstParticlesView18ConstParticlesViewERK13ParticlesViewI1TE">
<span id="_CPPv3N4par218ConstParticlesView18ConstParticlesViewERK13ParticlesViewI1TE"></span><span id="_CPPv2N4par218ConstParticlesView18ConstParticlesViewERK13ParticlesViewI1TE"></span><span id="par2::ConstParticlesView::ConstParticlesView__ParticlesView:T:CR"></span><span class="target" id="structpar2_1_1ConstParticlesView_1a2ac00a7f4d23850b5079c0e557decb01"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ConstParticlesView</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par213ParticlesViewE" title="par2::ParticlesView"><span class="n"><span class="pre">ParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">v</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par218ConstParticlesView18ConstParticlesViewERK13ParticlesViewI1TE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par218ConstParticlesView1xE">
<span id="_CPPv3N4par218ConstParticlesView1xE"></span><span id="_CPPv2N4par218ConstParticlesView1xE"></span><span id="par2::ConstParticlesView::x__TCP"></span><span class="target" id="structpar2_1_1ConstParticlesView_1a75e39ac7eca1d26c13f4f05b82f86dd3"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">x</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par218ConstParticlesView1xE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par218ConstParticlesView1yE">
<span id="_CPPv3N4par218ConstParticlesView1yE"></span><span id="_CPPv2N4par218ConstParticlesView1yE"></span><span id="par2::ConstParticlesView::y__TCP"></span><span class="target" id="structpar2_1_1ConstParticlesView_1aadef95124bd0e08d79630d658825500d"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">y</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par218ConstParticlesView1yE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par218ConstParticlesView1zE">
<span id="_CPPv3N4par218ConstParticlesView1zE"></span><span id="_CPPv2N4par218ConstParticlesView1zE"></span><span id="par2::ConstParticlesView::z__TCP"></span><span class="target" id="structpar2_1_1ConstParticlesView_1a8e28bec89373c72cccf8f07c15479e09"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">z</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par218ConstParticlesView1zE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par218ConstParticlesView1nE">
<span id="_CPPv3N4par218ConstParticlesView1nE"></span><span id="_CPPv2N4par218ConstParticlesView1nE"></span><span id="par2::ConstParticlesView::n__i"></span><span class="target" id="structpar2_1_1ConstParticlesView_1aae0d0dbff67b7c7b911f231db0cd23ba"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par218ConstParticlesView1nE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par218ConstParticlesView6statusE">
<span id="_CPPv3N4par218ConstParticlesView6statusE"></span><span id="_CPPv2N4par218ConstParticlesView6statusE"></span><span id="par2::ConstParticlesView::status__uint8_tCP"></span><span class="target" id="structpar2_1_1ConstParticlesView_1a499008086cabe34babfde8b3d13193e1"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">status</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par218ConstParticlesView6statusE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par218ConstParticlesView5wrapXE">
<span id="_CPPv3N4par218ConstParticlesView5wrapXE"></span><span id="_CPPv2N4par218ConstParticlesView5wrapXE"></span><span id="par2::ConstParticlesView::wrapX__int32_tCP"></span><span class="target" id="structpar2_1_1ConstParticlesView_1a9bbc2f7437d4d33b8ce5c1133a1e4128"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">wrapX</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par218ConstParticlesView5wrapXE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par218ConstParticlesView5wrapYE">
<span id="_CPPv3N4par218ConstParticlesView5wrapYE"></span><span id="_CPPv2N4par218ConstParticlesView5wrapYE"></span><span id="par2::ConstParticlesView::wrapY__int32_tCP"></span><span class="target" id="structpar2_1_1ConstParticlesView_1a166a3e21c1d21560867693e295cc168d"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">wrapY</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par218ConstParticlesView5wrapYE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par218ConstParticlesView5wrapZE">
<span id="_CPPv3N4par218ConstParticlesView5wrapZE"></span><span id="_CPPv2N4par218ConstParticlesView5wrapZE"></span><span id="par2::ConstParticlesView::wrapZ__int32_tCP"></span><span class="target" id="structpar2_1_1ConstParticlesView_1a0b3d7a3dd00cf1f76ad9e6847989ddef"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">wrapZ</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par218ConstParticlesView5wrapZE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par210DeviceSpanE">
<span id="_CPPv3I0EN4par210DeviceSpanE"></span><span id="_CPPv2I0EN4par210DeviceSpanE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1DeviceSpan"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DeviceSpan</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par210DeviceSpanE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;views.hpp&gt;</em></div>
<p>Non-owning view of a contiguous GPU array. </p>
<p>
Similar to std::span but for device memory. Does not manage lifetime. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Element type (may be const-qualified for read-only views)</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par210DeviceSpan5emptyEv">
<span id="_CPPv3NK4par210DeviceSpan5emptyEv"></span><span id="_CPPv2NK4par210DeviceSpan5emptyEv"></span><span id="par2::DeviceSpan::emptyCCE"></span><span class="target" id="structpar2_1_1DeviceSpan_1a23b1855c73cfe1a4e33c91e4ca0b8e83"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">empty</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par210DeviceSpan5emptyEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if the span is empty. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par210DeviceSpan5validEv">
<span id="_CPPv3NK4par210DeviceSpan5validEv"></span><span id="_CPPv2NK4par210DeviceSpan5validEv"></span><span id="par2::DeviceSpan::validCCE"></span><span class="target" id="structpar2_1_1DeviceSpan_1a5d64b8282d32b3ae2a85d9e0ba532fb5"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">valid</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par210DeviceSpan5validEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if the span is valid (non-null when size &gt; 0) </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par210DeviceSpan4dataE">
<span id="_CPPv3N4par210DeviceSpan4dataE"></span><span id="_CPPv2N4par210DeviceSpan4dataE"></span><span id="par2::DeviceSpan::data__TP"></span><span class="target" id="structpar2_1_1DeviceSpan_1a8e7b9e0ef1bd55f44f1c92ec9032fa49"></span><a class="reference internal" href="#_CPPv4I0EN4par210DeviceSpanE" title="par2::DeviceSpan::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">data</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par210DeviceSpan4dataE" title="Link to this definition"></a><br /></dt>
<dd><p>Pointer to device memory. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par210DeviceSpan4sizeE">
<span id="_CPPv3N4par210DeviceSpan4sizeE"></span><span id="_CPPv2N4par210DeviceSpan4sizeE"></span><span id="par2::DeviceSpan::size__s"></span><span class="target" id="structpar2_1_1DeviceSpan_1a8b5e514ae01e8c72a698666e6f688cac"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par210DeviceSpan4sizeE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of elements. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par219DriftCorrectionViewE">
<span id="_CPPv3I0EN4par219DriftCorrectionViewE"></span><span id="_CPPv2I0EN4par219DriftCorrectionViewE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1DriftCorrectionView"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DriftCorrectionView</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par219DriftCorrectionViewE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;views.hpp&gt;</em></div>
<p>View of precomputed drift correction field. </p>
<p>
This is the divergence of the dispersion tensor: div(D). Can be cell-centered or corner-centered depending on configuration. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par219DriftCorrectionView5validEv">
<span id="_CPPv3NK4par219DriftCorrectionView5validEv"></span><span id="_CPPv2NK4par219DriftCorrectionView5validEv"></span><span id="par2::DriftCorrectionView::validCCE"></span><span class="target" id="structpar2_1_1DriftCorrectionView_1ac11d93bf43c0621355442694ef26b12a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">valid</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par219DriftCorrectionView5validEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par219DriftCorrectionView3dcxE">
<span id="_CPPv3N4par219DriftCorrectionView3dcxE"></span><span id="_CPPv2N4par219DriftCorrectionView3dcxE"></span><span id="par2::DriftCorrectionView::dcx__TCP"></span><span class="target" id="structpar2_1_1DriftCorrectionView_1ab37bc84e8de736a427f2e7878f70a6dd"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par219DriftCorrectionViewE" title="par2::DriftCorrectionView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">dcx</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par219DriftCorrectionView3dcxE" title="Link to this definition"></a><br /></dt>
<dd><p>X-component of div(D) [device ptr]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par219DriftCorrectionView3dcyE">
<span id="_CPPv3N4par219DriftCorrectionView3dcyE"></span><span id="_CPPv2N4par219DriftCorrectionView3dcyE"></span><span id="par2::DriftCorrectionView::dcy__TCP"></span><span class="target" id="structpar2_1_1DriftCorrectionView_1a658507c5bd6149332920af485641af83"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par219DriftCorrectionViewE" title="par2::DriftCorrectionView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">dcy</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par219DriftCorrectionView3dcyE" title="Link to this definition"></a><br /></dt>
<dd><p>Y-component of div(D) [device ptr]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par219DriftCorrectionView3dczE">
<span id="_CPPv3N4par219DriftCorrectionView3dczE"></span><span id="_CPPv2N4par219DriftCorrectionView3dczE"></span><span id="par2::DriftCorrectionView::dcz__TCP"></span><span class="target" id="structpar2_1_1DriftCorrectionView_1a3774c012ba70a74eb68798cb903dacab"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par219DriftCorrectionViewE" title="par2::DriftCorrectionView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">dcz</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par219DriftCorrectionView3dczE" title="Link to this definition"></a><br /></dt>
<dd><p>Z-component of div(D) [device ptr]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par219DriftCorrectionView4sizeE">
<span id="_CPPv3N4par219DriftCorrectionView4sizeE"></span><span id="_CPPv2N4par219DriftCorrectionView4sizeE"></span><span id="par2::DriftCorrectionView::size__s"></span><span class="target" id="structpar2_1_1DriftCorrectionView_1a9f20ac12d837dbdd20a6e43eddc12c30"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par219DriftCorrectionView4sizeE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of elements per component. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par213ParticlesViewE">
<span id="_CPPv3I0EN4par213ParticlesViewE"></span><span id="_CPPv2I0EN4par213ParticlesViewE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1ParticlesView"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ParticlesView</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par213ParticlesViewE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;views.hpp&gt;</em></div>
<p>View of particle positions in Structure-of-Arrays (SoA) layout. </p>
<p>
Particle positions are stored as three separate arrays for better memory coalescing on GPU:<ul class="simple">
<li><p>x[i], y[i], z[i] = position of particle i</p></li>
</ul>
</p>
<p>Optionally includes:<ul class="simple">
<li><p>status: particle active/inactive flags</p></li>
<li><p>wrapX/Y/Z: wrap counters for periodic boundary (net crossings)</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Memory is NOT owned by this view - user is responsible for allocation. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For inject_box, arrays must be writable (non-const pointers).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type (float or double)</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par213ParticlesView5validEv">
<span id="_CPPv3NK4par213ParticlesView5validEv"></span><span id="_CPPv2NK4par213ParticlesView5validEv"></span><span id="par2::ParticlesView::validCCE"></span><span class="target" id="structpar2_1_1ParticlesView_1a3f15f5e4f0e407ad08aa2dd35664199a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">valid</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par213ParticlesView5validEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check basic validity. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par213ParticlesView10has_statusEv">
<span id="_CPPv3NK4par213ParticlesView10has_statusEv"></span><span id="_CPPv2NK4par213ParticlesView10has_statusEv"></span><span id="par2::ParticlesView::has_statusCCE"></span><span class="target" id="structpar2_1_1ParticlesView_1ab668da5080a445792977eb3207b4d672"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_status</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par213ParticlesView10has_statusEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if status tracking is enabled. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par213ParticlesView10has_wrap_xEv">
<span id="_CPPv3NK4par213ParticlesView10has_wrap_xEv"></span><span id="_CPPv2NK4par213ParticlesView10has_wrap_xEv"></span><span id="par2::ParticlesView::has_wrap_xCCE"></span><span class="target" id="structpar2_1_1ParticlesView_1a33b0a00d503ffdb8d825e67aa2573150"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_wrap_x</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par213ParticlesView10has_wrap_xEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if wrap tracking is available for an axis. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par213ParticlesView10has_wrap_yEv">
<span id="_CPPv3NK4par213ParticlesView10has_wrap_yEv"></span><span id="_CPPv2NK4par213ParticlesView10has_wrap_yEv"></span><span id="par2::ParticlesView::has_wrap_yCCE"></span><span class="target" id="structpar2_1_1ParticlesView_1aac702222a36dd0e8c5cf05cb17556cd6"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_wrap_y</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par213ParticlesView10has_wrap_yEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par213ParticlesView10has_wrap_zEv">
<span id="_CPPv3NK4par213ParticlesView10has_wrap_zEv"></span><span id="_CPPv2NK4par213ParticlesView10has_wrap_zEv"></span><span id="par2::ParticlesView::has_wrap_zCCE"></span><span class="target" id="structpar2_1_1ParticlesView_1abb3ee48bfc2432331b0d367e70a3177f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_wrap_z</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par213ParticlesView10has_wrap_zEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par213ParticlesView12has_any_wrapEv">
<span id="_CPPv3NK4par213ParticlesView12has_any_wrapEv"></span><span id="_CPPv2NK4par213ParticlesView12has_any_wrapEv"></span><span id="par2::ParticlesView::has_any_wrapCCE"></span><span class="target" id="structpar2_1_1ParticlesView_1acf04d03b39890877cae9608216703bb1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_any_wrap</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par213ParticlesView12has_any_wrapEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if any wrap tracking is enabled. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213ParticlesView1xE">
<span id="_CPPv3N4par213ParticlesView1xE"></span><span id="_CPPv2N4par213ParticlesView1xE"></span><span id="par2::ParticlesView::x__TP"></span><span class="target" id="structpar2_1_1ParticlesView_1ac73d1e1013a1756b602222362cb0d792"></span><a class="reference internal" href="#_CPPv4I0EN4par213ParticlesViewE" title="par2::ParticlesView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">x</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par213ParticlesView1xE" title="Link to this definition"></a><br /></dt>
<dd><p>X positions [device ptr, writable]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213ParticlesView1yE">
<span id="_CPPv3N4par213ParticlesView1yE"></span><span id="_CPPv2N4par213ParticlesView1yE"></span><span id="par2::ParticlesView::y__TP"></span><span class="target" id="structpar2_1_1ParticlesView_1ae4ba3b711cc6c1a332d545ac2cf9e44c"></span><a class="reference internal" href="#_CPPv4I0EN4par213ParticlesViewE" title="par2::ParticlesView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">y</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par213ParticlesView1yE" title="Link to this definition"></a><br /></dt>
<dd><p>Y positions [device ptr, writable]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213ParticlesView1zE">
<span id="_CPPv3N4par213ParticlesView1zE"></span><span id="_CPPv2N4par213ParticlesView1zE"></span><span id="par2::ParticlesView::z__TP"></span><span class="target" id="structpar2_1_1ParticlesView_1a0f36c78eb75940a727b768d475de4454"></span><a class="reference internal" href="#_CPPv4I0EN4par213ParticlesViewE" title="par2::ParticlesView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">z</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par213ParticlesView1zE" title="Link to this definition"></a><br /></dt>
<dd><p>Z positions [device ptr, writable]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213ParticlesView1nE">
<span id="_CPPv3N4par213ParticlesView1nE"></span><span id="_CPPv2N4par213ParticlesView1nE"></span><span id="par2::ParticlesView::n__i"></span><span class="target" id="structpar2_1_1ParticlesView_1a29198abc370d3f159300ec79a3c202f8"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par213ParticlesView1nE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of particles. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213ParticlesView6statusE">
<span id="_CPPv3N4par213ParticlesView6statusE"></span><span id="_CPPv2N4par213ParticlesView6statusE"></span><span id="par2::ParticlesView::status__uint8_tP"></span><span class="target" id="structpar2_1_1ParticlesView_1a9826b60a3b25ac80417981f9978474a8"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">status</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par213ParticlesView6statusE" title="Link to this definition"></a><br /></dt>
<dd><p>Particle status flags [device ptr, optional]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213ParticlesView5wrapXE">
<span id="_CPPv3N4par213ParticlesView5wrapXE"></span><span id="_CPPv2N4par213ParticlesView5wrapXE"></span><span id="par2::ParticlesView::wrapX__int32_tP"></span><span class="target" id="structpar2_1_1ParticlesView_1adfa283b7bcb86cbb2d39331946a00917"></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">wrapX</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par213ParticlesView5wrapXE" title="Link to this definition"></a><br /></dt>
<dd><p>X wrap count [device ptr, optional]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213ParticlesView5wrapYE">
<span id="_CPPv3N4par213ParticlesView5wrapYE"></span><span id="_CPPv2N4par213ParticlesView5wrapYE"></span><span id="par2::ParticlesView::wrapY__int32_tP"></span><span class="target" id="structpar2_1_1ParticlesView_1a42de71cb32c0c5c876c93e5aa0d93cc2"></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">wrapY</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par213ParticlesView5wrapYE" title="Link to this definition"></a><br /></dt>
<dd><p>Y wrap count [device ptr, optional]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213ParticlesView5wrapZE">
<span id="_CPPv3N4par213ParticlesView5wrapZE"></span><span id="_CPPv2N4par213ParticlesView5wrapZE"></span><span id="par2::ParticlesView::wrapZ__int32_tP"></span><span class="target" id="structpar2_1_1ParticlesView_1a921ba260f6e679596bd47a7375267ea9"></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">wrapZ</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par213ParticlesView5wrapZE" title="Link to this definition"></a><br /></dt>
<dd><p>Z wrap count [device ptr, optional]. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par222UnwrappedPositionsViewE">
<span id="_CPPv3I0EN4par222UnwrappedPositionsViewE"></span><span id="_CPPv2I0EN4par222UnwrappedPositionsViewE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1UnwrappedPositionsView"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">UnwrappedPositionsView</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par222UnwrappedPositionsViewE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;views.hpp&gt;</em></div>
<p>View of unwrapped (continuous) particle positions. </p>
<p>
Used as output for compute_unwrapped_positions(): x_u = x + wrapX * Lx y_u = y + wrapY * Ly z_u = z + wrapZ * Lz</p>
<p>The user must allocate these arrays before calling compute_unwrapped_positions. Size must be &gt;= num_particles. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par222UnwrappedPositionsView5validEv">
<span id="_CPPv3NK4par222UnwrappedPositionsView5validEv"></span><span id="_CPPv2NK4par222UnwrappedPositionsView5validEv"></span><span id="par2::UnwrappedPositionsView::validCCE"></span><span class="target" id="structpar2_1_1UnwrappedPositionsView_1a562f8fe03736a126ec54b68d8779b552"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">valid</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par222UnwrappedPositionsView5validEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par222UnwrappedPositionsView3x_uE">
<span id="_CPPv3N4par222UnwrappedPositionsView3x_uE"></span><span id="_CPPv2N4par222UnwrappedPositionsView3x_uE"></span><span id="par2::UnwrappedPositionsView::x_u__TP"></span><span class="target" id="structpar2_1_1UnwrappedPositionsView_1aee252d227c42a41ad457d9eec878ad13"></span><a class="reference internal" href="#_CPPv4I0EN4par222UnwrappedPositionsViewE" title="par2::UnwrappedPositionsView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">x_u</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par222UnwrappedPositionsView3x_uE" title="Link to this definition"></a><br /></dt>
<dd><p>Unwrapped X positions [device ptr, writable]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par222UnwrappedPositionsView3y_uE">
<span id="_CPPv3N4par222UnwrappedPositionsView3y_uE"></span><span id="_CPPv2N4par222UnwrappedPositionsView3y_uE"></span><span id="par2::UnwrappedPositionsView::y_u__TP"></span><span class="target" id="structpar2_1_1UnwrappedPositionsView_1a2ff21672915a1052d01ce26df1a3be31"></span><a class="reference internal" href="#_CPPv4I0EN4par222UnwrappedPositionsViewE" title="par2::UnwrappedPositionsView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">y_u</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par222UnwrappedPositionsView3y_uE" title="Link to this definition"></a><br /></dt>
<dd><p>Unwrapped Y positions [device ptr, writable]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par222UnwrappedPositionsView3z_uE">
<span id="_CPPv3N4par222UnwrappedPositionsView3z_uE"></span><span id="_CPPv2N4par222UnwrappedPositionsView3z_uE"></span><span id="par2::UnwrappedPositionsView::z_u__TP"></span><span class="target" id="structpar2_1_1UnwrappedPositionsView_1a7745574b3fbbdf9fbd0db822fe3407c8"></span><a class="reference internal" href="#_CPPv4I0EN4par222UnwrappedPositionsViewE" title="par2::UnwrappedPositionsView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">z_u</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par222UnwrappedPositionsView3z_uE" title="Link to this definition"></a><br /></dt>
<dd><p>Unwrapped Z positions [device ptr, writable]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par222UnwrappedPositionsView8capacityE">
<span id="_CPPv3N4par222UnwrappedPositionsView8capacityE"></span><span id="_CPPv2N4par222UnwrappedPositionsView8capacityE"></span><span id="par2::UnwrappedPositionsView::capacity__i"></span><span class="target" id="structpar2_1_1UnwrappedPositionsView_1aa6d678be9940354317dd4362e2cb8a63"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">capacity</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par222UnwrappedPositionsView8capacityE" title="Link to this definition"></a><br /></dt>
<dd><p>Allocated size (must be &gt;= n_particles) </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="velocity-layout">
<h2>Velocity Layout<a class="headerlink" href="#velocity-layout" title="Link to this heading"></a></h2>
<p>Velocity field layout contracts and views. </p>
<p>This header defines the <strong>canonical velocity field layouts</strong> for Par2_Core, documenting their memory organization, indexing schemes, and expected usage.</p>
<dl class="cpp type">
<dt class="sig sig-object cpp">
<span class="target" id="namespacepar2"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">par2</span></span></span><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par212VelocityViewE">
<span id="_CPPv3I0EN4par212VelocityViewE"></span><span id="_CPPv2I0EN4par212VelocityViewE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1a7f83eb45eb57c7110fb2f83369f17c03"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">VelocityView</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par213FaceFieldViewE" title="par2::FaceFieldView"><span class="n"><span class="pre">FaceFieldView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par212VelocityViewE" title="par2::VelocityView::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I0EN4par212VelocityViewE" title="Link to this definition"></a><br /></dt>
<dd><p>Alias: VelocityView is a <a class="reference internal" href="#structpar2_1_1FaceFieldView"><span class="std std-ref">FaceFieldView</span></a>. </p>
<p>The name <code class="docutils literal notranslate"><span class="pre">VelocityView</span></code> is kept for backwards compatibility. New code should prefer <code class="docutils literal notranslate"><a class="reference internal" href="#structpar2_1_1FaceFieldView"><span class="std std-ref"><span class="pre">FaceFieldView</span></span></a></code> for clarity.</p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Deprecated:</span></em></dt>
<dd><p>Use FaceFieldView&lt;T&gt; in new code. </p>
</dd></dl>

</p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par218CornerVelocityViewE">
<span id="_CPPv3I0EN4par218CornerVelocityViewE"></span><span id="_CPPv2I0EN4par218CornerVelocityViewE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1adcaef34a5fba7ed6b9a0bef9fd519046"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CornerVelocityView</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par215CornerFieldViewE" title="par2::CornerFieldView"><span class="n"><span class="pre">CornerFieldView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par218CornerVelocityViewE" title="par2::CornerVelocityView::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I0EN4par218CornerVelocityViewE" title="Link to this definition"></a><br /></dt>
<dd><p>Alias: CornerVelocityView is a <a class="reference internal" href="#structpar2_1_1CornerFieldView"><span class="std std-ref">CornerFieldView</span></a>. </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Deprecated:</span></em></dt>
<dd><p>Use CornerFieldView&lt;T&gt; in new code. </p>
</dd></dl>

</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par28merge_idEiiiii">
<span id="_CPPv3N4par28merge_idEiiiii"></span><span id="_CPPv2N4par28merge_idEiiiii"></span><span id="par2::merge_id__i.i.i.i.iCE"></span><span class="target" id="namespacepar2_1a3418d81ddd9dc28320621a3ade3760e6"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">merge_id</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ix</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">iy</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">iz</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nx</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ny</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par28merge_idEiiiii" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the merged linear index for a 3D point in legacy layout. </p>
<p>
This matches legacy PAR² <code class="docutils literal notranslate"><span class="pre">facefield::mergeId()</span></code>: <div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">iz</span> <span class="o">*</span> <span class="p">(</span><span class="n">ny</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">nx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">iy</span> <span class="o">*</span> <span class="p">(</span><span class="n">nx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ix</span>
</pre></div>
</div>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ix</strong> – X index (0 to nx inclusive) </p></li>
<li><p><strong>iy</strong> – Y index (0 to ny inclusive) </p></li>
<li><p><strong>iz</strong> – Z index (0 to nz inclusive) </p></li>
<li><p><strong>nx</strong> – Number of cells in X </p></li>
<li><p><strong>ny</strong> – Number of cells in Y </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Linear index for arrays of size (nx+1)*(ny+1)*(nz+1)</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par210field_sizeEiii">
<span id="_CPPv3N4par210field_sizeEiii"></span><span id="_CPPv2N4par210field_sizeEiii"></span><span id="par2::field_size__i.i.iCE"></span><span class="target" id="namespacepar2_1a9df49898861da6df112626217994392e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">field_size</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nx</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ny</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nz</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par210field_sizeEiii" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the expected array size for a face/corner field. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nx</strong> – Number of cells in X </p></li>
<li><p><strong>ny</strong> – Number of cells in Y </p></li>
<li><p><strong>nz</strong> – Number of cells in Z </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(nx+1) * (ny+1) * (nz+1) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par210field_sizeE6size_tRK8GridDescI1TE">
<span id="_CPPv3I0EN4par210field_sizeERK8GridDescI1TE"></span><span id="_CPPv2I0EN4par210field_sizeERK8GridDescI1TE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1a2691b6c86b488eb7032b4611fa1ba982"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">field_size</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc"><span class="n"><span class="pre">GridDesc</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par210field_sizeE6size_tRK8GridDescI1TE" title="par2::field_size::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grid</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4I0EN4par210field_sizeE6size_tRK8GridDescI1TE" title="Link to this definition"></a><br /></dt>
<dd><p>Compute expected field size from grid descriptor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4par219validate_face_fieldEvRK13FaceFieldViewI1TERK8GridDescI5GridTE">
<span id="_CPPv3I00EN4par219validate_face_fieldERK13FaceFieldViewI1TERK8GridDescI5GridTE"></span><span id="_CPPv2I00EN4par219validate_face_fieldERK13FaceFieldViewI1TERK8GridDescI5GridTE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GridT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1ae02a56f80f564eb73fd3fda24f473113"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">validate_face_field</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par213FaceFieldViewE" title="par2::FaceFieldView"><span class="n"><span class="pre">FaceFieldView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4par219validate_face_fieldEvRK13FaceFieldViewI1TERK8GridDescI5GridTE" title="par2::validate_face_field::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc"><span class="n"><span class="pre">GridDesc</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4par219validate_face_fieldEvRK13FaceFieldViewI1TERK8GridDescI5GridTE" title="par2::validate_face_field::GridT"><span class="n"><span class="pre">GridT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4par219validate_face_fieldEvRK13FaceFieldViewI1TERK8GridDescI5GridTE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4par221validate_corner_fieldEvRK15CornerFieldViewI1TERK8GridDescI5GridTE">
<span id="_CPPv3I00EN4par221validate_corner_fieldERK15CornerFieldViewI1TERK8GridDescI5GridTE"></span><span id="_CPPv2I00EN4par221validate_corner_fieldERK15CornerFieldViewI1TERK8GridDescI5GridTE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GridT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1a81293dc39b62d4a934c8b39ba3a08326"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">validate_corner_field</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par215CornerFieldViewE" title="par2::CornerFieldView"><span class="n"><span class="pre">CornerFieldView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4par221validate_corner_fieldEvRK15CornerFieldViewI1TERK8GridDescI5GridTE" title="par2::validate_corner_field::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc"><span class="n"><span class="pre">GridDesc</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4par221validate_corner_fieldEvRK15CornerFieldViewI1TERK8GridDescI5GridTE" title="par2::validate_corner_field::GridT"><span class="n"><span class="pre">GridT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4par221validate_corner_fieldEvRK15CornerFieldViewI1TERK8GridDescI5GridTE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par215CornerFieldViewE">
<span id="_CPPv3I0EN4par215CornerFieldViewE"></span><span id="_CPPv2I0EN4par215CornerFieldViewE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1CornerFieldView"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CornerFieldView</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par215CornerFieldViewE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;velocity_layout.hpp&gt;</em></div>
<p>Non-owning view of a corner-centered velocity field. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par215CornerFieldView5validEv">
<span id="_CPPv3NK4par215CornerFieldView5validEv"></span><span id="_CPPv2NK4par215CornerFieldView5validEv"></span><span id="par2::CornerFieldView::validCCE"></span><span class="target" id="structpar2_1_1CornerFieldView_1a9733501eb61113567bd2310c302e3233"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">valid</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par215CornerFieldView5validEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4par215CornerFieldView12matches_gridEbRK8GridDescI5GridTE">
<span id="_CPPv3I0ENK4par215CornerFieldView12matches_gridERK8GridDescI5GridTE"></span><span id="_CPPv2I0ENK4par215CornerFieldView12matches_gridERK8GridDescI5GridTE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GridT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1CornerFieldView_1ad71b925924851ff6fe2953e0a139fb5d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">matches_grid</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc"><span class="n"><span class="pre">GridDesc</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0ENK4par215CornerFieldView12matches_gridEbRK8GridDescI5GridTE" title="par2::CornerFieldView::matches_grid::GridT"><span class="n"><span class="pre">GridT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grid</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4I0ENK4par215CornerFieldView12matches_gridEbRK8GridDescI5GridTE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par215CornerFieldView2UcE">
<span id="_CPPv3N4par215CornerFieldView2UcE"></span><span id="_CPPv2N4par215CornerFieldView2UcE"></span><span id="par2::CornerFieldView::Uc__TCP"></span><span class="target" id="structpar2_1_1CornerFieldView_1a8d980895e3df5f6ba4d62f489c5db8e9"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par215CornerFieldViewE" title="par2::CornerFieldView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Uc</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par215CornerFieldView2UcE" title="Link to this definition"></a><br /></dt>
<dd><p>X-component at corners [device ptr]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par215CornerFieldView2VcE">
<span id="_CPPv3N4par215CornerFieldView2VcE"></span><span id="_CPPv2N4par215CornerFieldView2VcE"></span><span id="par2::CornerFieldView::Vc__TCP"></span><span class="target" id="structpar2_1_1CornerFieldView_1ae628841736a90e5fc820bd1b40d435a7"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par215CornerFieldViewE" title="par2::CornerFieldView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Vc</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par215CornerFieldView2VcE" title="Link to this definition"></a><br /></dt>
<dd><p>Y-component at corners [device ptr]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par215CornerFieldView2WcE">
<span id="_CPPv3N4par215CornerFieldView2WcE"></span><span id="_CPPv2N4par215CornerFieldView2WcE"></span><span id="par2::CornerFieldView::Wc__TCP"></span><span class="target" id="structpar2_1_1CornerFieldView_1a9cea82f86239acfbfb949e92b9f7c9d5"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par215CornerFieldViewE" title="par2::CornerFieldView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Wc</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par215CornerFieldView2WcE" title="Link to this definition"></a><br /></dt>
<dd><p>Z-component at corners [device ptr]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par215CornerFieldView4sizeE">
<span id="_CPPv3N4par215CornerFieldView4sizeE"></span><span id="_CPPv2N4par215CornerFieldView4sizeE"></span><span id="par2::CornerFieldView::size__s"></span><span class="target" id="structpar2_1_1CornerFieldView_1a24dea1f9a20497f189ea5f983f43cb9f"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par215CornerFieldView4sizeE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of elements per component. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par213FaceFieldViewE">
<span id="_CPPv3I0EN4par213FaceFieldViewE"></span><span id="_CPPv2I0EN4par213FaceFieldViewE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1FaceFieldView"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FaceFieldView</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par213FaceFieldViewE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;velocity_layout.hpp&gt;</em></div>
<p>Non-owning view of a staggered velocity field (MAC grid layout). </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type (float or double)</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par213FaceFieldView5validEv">
<span id="_CPPv3NK4par213FaceFieldView5validEv"></span><span id="_CPPv2NK4par213FaceFieldView5validEv"></span><span id="par2::FaceFieldView::validCCE"></span><span class="target" id="structpar2_1_1FaceFieldView_1ae657102a5db89cb80d097807e5f60b64"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">valid</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par213FaceFieldView5validEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if all pointers are set and size is valid. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK4par213FaceFieldView12matches_gridEbRK8GridDescI5GridTE">
<span id="_CPPv3I0ENK4par213FaceFieldView12matches_gridERK8GridDescI5GridTE"></span><span id="_CPPv2I0ENK4par213FaceFieldView12matches_gridERK8GridDescI5GridTE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GridT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1FaceFieldView_1a0aa39d3492319bf1debf1bae21f7d7f4"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">matches_grid</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc"><span class="n"><span class="pre">GridDesc</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0ENK4par213FaceFieldView12matches_gridEbRK8GridDescI5GridTE" title="par2::FaceFieldView::matches_grid::GridT"><span class="n"><span class="pre">GridT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grid</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4I0ENK4par213FaceFieldView12matches_gridEbRK8GridDescI5GridTE" title="Link to this definition"></a><br /></dt>
<dd><p>Check if size matches expected for given grid. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213FaceFieldView1UE">
<span id="_CPPv3N4par213FaceFieldView1UE"></span><span id="_CPPv2N4par213FaceFieldView1UE"></span><span id="par2::FaceFieldView::U__TCP"></span><span class="target" id="structpar2_1_1FaceFieldView_1ab933d4c0f4412cb2a0bbdd6be9768cf4"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par213FaceFieldViewE" title="par2::FaceFieldView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par213FaceFieldView1UE" title="Link to this definition"></a><br /></dt>
<dd><p>X-component (face-centered on YZ planes) [device ptr]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213FaceFieldView1VE">
<span id="_CPPv3N4par213FaceFieldView1VE"></span><span id="_CPPv2N4par213FaceFieldView1VE"></span><span id="par2::FaceFieldView::V__TCP"></span><span class="target" id="structpar2_1_1FaceFieldView_1a7c44e636e180ff1e973a79e052897f2d"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par213FaceFieldViewE" title="par2::FaceFieldView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par213FaceFieldView1VE" title="Link to this definition"></a><br /></dt>
<dd><p>Y-component (face-centered on XZ planes) [device ptr]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213FaceFieldView1WE">
<span id="_CPPv3N4par213FaceFieldView1WE"></span><span id="_CPPv2N4par213FaceFieldView1WE"></span><span id="par2::FaceFieldView::W__TCP"></span><span class="target" id="structpar2_1_1FaceFieldView_1adf6e9512c186b65108888815399b39c9"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par213FaceFieldViewE" title="par2::FaceFieldView::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">W</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par213FaceFieldView1WE" title="Link to this definition"></a><br /></dt>
<dd><p>Z-component (face-centered on XY planes) [device ptr]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213FaceFieldView4sizeE">
<span id="_CPPv3N4par213FaceFieldView4sizeE"></span><span id="_CPPv2N4par213FaceFieldView4sizeE"></span><span id="par2::FaceFieldView::size__s"></span><span class="target" id="structpar2_1_1FaceFieldView_1a82b6a9cdc06fce36128dee4bc2de9212"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par213FaceFieldView4sizeE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of elements per component: (nx+1)(ny+1)(nz+1) </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="boundary-conditions">
<h2>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Link to this heading"></a></h2>
<p>Boundary condition configuration for Par2_Core. </p>
<p>Defines per-axis boundary conditions for particle tracking.</p>
<p><dl class="simple">
<dt><strong>Copyright</strong></dt><dd><p>Par2_Core - GPU-native transport engine </p>
</dd>
</dl>
</p>
<dl class="cpp type">
<dt class="sig sig-object cpp">
<span class="target" id="namespacepar2"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">par2</span></span></span><br /></dt>
<dd><dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par212AxisBoundaryE">
<span id="_CPPv3I0EN4par212AxisBoundaryE"></span><span id="_CPPv2I0EN4par212AxisBoundaryE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1AxisBoundary"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AxisBoundary</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par212AxisBoundaryE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;boundary.hpp&gt;</em></div>
<p>Boundary conditions for a single axis. </p>
<p>
Specifies behavior at both the low (min) and high (max) boundaries. For example, a pipe might have Periodic in X, Closed in Y and Z.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Domain validity uses strict inequalities: lo &lt; x &lt; hi (matching legacy PAR² CartesianGrid::validX/Y/Z). </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For Periodic BC, <strong>both</strong> lo and hi must be Periodic (symmetric periodic). Mixed periodic (e.g., lo=Periodic, hi=Closed) is treated as <strong>non-periodic</strong> for that axis.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par212AxisBoundary2loE">
<span id="_CPPv3N4par212AxisBoundary2loE"></span><span id="_CPPv2N4par212AxisBoundary2loE"></span><span id="par2::AxisBoundary::lo__BoundaryType"></span><span class="target" id="structpar2_1_1AxisBoundary_1a02809c9a84aa5686a9e4d06ab66aa44e"></span><a class="reference internal" href="#_CPPv4N4par212BoundaryTypeE" title="par2::BoundaryType"><span class="n"><span class="pre">BoundaryType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">lo</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par212BoundaryTypeE" title="par2::BoundaryType"><span class="n"><span class="pre">BoundaryType</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4par212BoundaryType6ClosedE" title="par2::BoundaryType::Closed"><span class="n"><span class="pre">Closed</span></span></a><a class="headerlink" href="#_CPPv4N4par212AxisBoundary2loE" title="Link to this definition"></a><br /></dt>
<dd><p>Behavior at min boundary. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par212AxisBoundary2hiE">
<span id="_CPPv3N4par212AxisBoundary2hiE"></span><span id="_CPPv2N4par212AxisBoundary2hiE"></span><span id="par2::AxisBoundary::hi__BoundaryType"></span><span class="target" id="structpar2_1_1AxisBoundary_1afc54aae576cc5b256fc16da0979e1783"></span><a class="reference internal" href="#_CPPv4N4par212BoundaryTypeE" title="par2::BoundaryType"><span class="n"><span class="pre">BoundaryType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hi</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par212BoundaryTypeE" title="par2::BoundaryType"><span class="n"><span class="pre">BoundaryType</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4par212BoundaryType6ClosedE" title="par2::BoundaryType::Closed"><span class="n"><span class="pre">Closed</span></span></a><a class="headerlink" href="#_CPPv4N4par212AxisBoundary2hiE" title="Link to this definition"></a><br /></dt>
<dd><p>Behavior at max boundary. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par212AxisBoundary9symmetricE12BoundaryType">
<span id="_CPPv3N4par212AxisBoundary9symmetricE12BoundaryType"></span><span id="_CPPv2N4par212AxisBoundary9symmetricE12BoundaryType"></span><span id="par2::AxisBoundary::symmetric__BoundaryTypeCE"></span><span class="target" id="structpar2_1_1AxisBoundary_1a193aff3bd593ac1b629a5982d34ca272"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par212AxisBoundaryE" title="par2::AxisBoundary"><span class="n"><span class="pre">AxisBoundary</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">symmetric</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N4par212BoundaryTypeE" title="par2::BoundaryType"><span class="n"><span class="pre">BoundaryType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">type</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par212AxisBoundary9symmetricE12BoundaryType" title="Link to this definition"></a><br /></dt>
<dd><p>Factory for symmetric boundary (same on both sides) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par212AxisBoundary6closedEv">
<span id="_CPPv3N4par212AxisBoundary6closedEv"></span><span id="_CPPv2N4par212AxisBoundary6closedEv"></span><span id="par2::AxisBoundary::closedCE"></span><span class="target" id="structpar2_1_1AxisBoundary_1af760dbd83823f117494bf82e5d61fcf7"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par212AxisBoundaryE" title="par2::AxisBoundary"><span class="n"><span class="pre">AxisBoundary</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">closed</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par212AxisBoundary6closedEv" title="Link to this definition"></a><br /></dt>
<dd><p>Factory for closed (reflective) boundaries. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par212AxisBoundary8periodicEv">
<span id="_CPPv3N4par212AxisBoundary8periodicEv"></span><span id="_CPPv2N4par212AxisBoundary8periodicEv"></span><span id="par2::AxisBoundary::periodicCE"></span><span class="target" id="structpar2_1_1AxisBoundary_1a9ad72f81de96125179053c5e1631a514"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par212AxisBoundaryE" title="par2::AxisBoundary"><span class="n"><span class="pre">AxisBoundary</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">periodic</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par212AxisBoundary8periodicEv" title="Link to this definition"></a><br /></dt>
<dd><p>Factory for periodic boundaries. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par212AxisBoundary4openEv">
<span id="_CPPv3N4par212AxisBoundary4openEv"></span><span id="_CPPv2N4par212AxisBoundary4openEv"></span><span id="par2::AxisBoundary::openCE"></span><span class="target" id="structpar2_1_1AxisBoundary_1a6b57c0c78a4b75851c2588c8172f9698"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par212AxisBoundaryE" title="par2::AxisBoundary"><span class="n"><span class="pre">AxisBoundary</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">open</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par212AxisBoundary4openEv" title="Link to this definition"></a><br /></dt>
<dd><p>Factory for open boundaries (particles can exit) </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par214BoundaryConfigE">
<span id="_CPPv3I0EN4par214BoundaryConfigE"></span><span id="_CPPv2I0EN4par214BoundaryConfigE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1BoundaryConfig"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BoundaryConfig</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par214BoundaryConfigE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;boundary.hpp&gt;</em></div>
<p>Complete boundary configuration for 3D domain. </p>
<p>
Combines boundary conditions for all three axes (six faces total). Default is closed (reflective) on all boundaries, matching legacy PAR² behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par214BoundaryConfig12has_periodicEv">
<span id="_CPPv3NK4par214BoundaryConfig12has_periodicEv"></span><span id="_CPPv2NK4par214BoundaryConfig12has_periodicEv"></span><span id="par2::BoundaryConfig::has_periodicCCE"></span><span class="target" id="structpar2_1_1BoundaryConfig_1a44574c6697d5b7ec33312cfe9c1c849e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_periodic</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par214BoundaryConfig12has_periodicEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if any boundary is periodic (affects domain wrapping) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par214BoundaryConfig8has_openEv">
<span id="_CPPv3NK4par214BoundaryConfig8has_openEv"></span><span id="_CPPv2NK4par214BoundaryConfig8has_openEv"></span><span id="par2::BoundaryConfig::has_openCCE"></span><span class="target" id="structpar2_1_1BoundaryConfig_1a5c126a72b9f0227501ccb6073a238000"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_open</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par214BoundaryConfig8has_openEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if any boundary is open (need to track exited particles) </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par214BoundaryConfig1xE">
<span id="_CPPv3N4par214BoundaryConfig1xE"></span><span id="_CPPv2N4par214BoundaryConfig1xE"></span><span id="par2::BoundaryConfig::x__AxisBoundary:T:"></span><span class="target" id="structpar2_1_1BoundaryConfig_1a5f04347d1177c8bc55da08025cd4a462"></span><a class="reference internal" href="#_CPPv4I0EN4par212AxisBoundaryE" title="par2::AxisBoundary"><span class="n"><span class="pre">AxisBoundary</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE" title="par2::BoundaryConfig::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">x</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par212AxisBoundaryE" title="par2::AxisBoundary"><span class="n"><span class="pre">AxisBoundary</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE" title="par2::BoundaryConfig::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par214BoundaryConfig1xE" title="Link to this definition"></a><br /></dt>
<dd><p>X-axis boundaries. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par214BoundaryConfig1yE">
<span id="_CPPv3N4par214BoundaryConfig1yE"></span><span id="_CPPv2N4par214BoundaryConfig1yE"></span><span id="par2::BoundaryConfig::y__AxisBoundary:T:"></span><span class="target" id="structpar2_1_1BoundaryConfig_1a361a7db5154ddfa9133b6cdc004ef3f9"></span><a class="reference internal" href="#_CPPv4I0EN4par212AxisBoundaryE" title="par2::AxisBoundary"><span class="n"><span class="pre">AxisBoundary</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE" title="par2::BoundaryConfig::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">y</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par212AxisBoundaryE" title="par2::AxisBoundary"><span class="n"><span class="pre">AxisBoundary</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE" title="par2::BoundaryConfig::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par214BoundaryConfig1yE" title="Link to this definition"></a><br /></dt>
<dd><p>Y-axis boundaries. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par214BoundaryConfig1zE">
<span id="_CPPv3N4par214BoundaryConfig1zE"></span><span id="_CPPv2N4par214BoundaryConfig1zE"></span><span id="par2::BoundaryConfig::z__AxisBoundary:T:"></span><span class="target" id="structpar2_1_1BoundaryConfig_1a8bc1b82c883061a8a6372491c9155b98"></span><a class="reference internal" href="#_CPPv4I0EN4par212AxisBoundaryE" title="par2::AxisBoundary"><span class="n"><span class="pre">AxisBoundary</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE" title="par2::BoundaryConfig::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">z</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par212AxisBoundaryE" title="par2::AxisBoundary"><span class="n"><span class="pre">AxisBoundary</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE" title="par2::BoundaryConfig::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">closed</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N4par214BoundaryConfig1zE" title="Link to this definition"></a><br /></dt>
<dd><p>Z-axis boundaries. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par214BoundaryConfig10all_closedEv">
<span id="_CPPv3N4par214BoundaryConfig10all_closedEv"></span><span id="_CPPv2N4par214BoundaryConfig10all_closedEv"></span><span id="par2::BoundaryConfig::all_closedCE"></span><span class="target" id="structpar2_1_1BoundaryConfig_1a4519cf579c4c3175ecf0c610c0a78043"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE" title="par2::BoundaryConfig"><span class="n"><span class="pre">BoundaryConfig</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">all_closed</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par214BoundaryConfig10all_closedEv" title="Link to this definition"></a><br /></dt>
<dd><p>All boundaries closed (reflective) - legacy default. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par214BoundaryConfig12all_periodicEv">
<span id="_CPPv3N4par214BoundaryConfig12all_periodicEv"></span><span id="_CPPv2N4par214BoundaryConfig12all_periodicEv"></span><span id="par2::BoundaryConfig::all_periodicCE"></span><span class="target" id="structpar2_1_1BoundaryConfig_1aebe4c041178f21dc0fd37db927ef7ff5"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE" title="par2::BoundaryConfig"><span class="n"><span class="pre">BoundaryConfig</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">all_periodic</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par214BoundaryConfig12all_periodicEv" title="Link to this definition"></a><br /></dt>
<dd><p>All boundaries periodic. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par214BoundaryConfig9channel_xEv">
<span id="_CPPv3N4par214BoundaryConfig9channel_xEv"></span><span id="_CPPv2N4par214BoundaryConfig9channel_xEv"></span><span id="par2::BoundaryConfig::channel_xCE"></span><span class="target" id="structpar2_1_1BoundaryConfig_1a2c14039bd7aee9f940d31c25a1e3f313"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE" title="par2::BoundaryConfig"><span class="n"><span class="pre">BoundaryConfig</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">channel_x</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par214BoundaryConfig9channel_xEv" title="Link to this definition"></a><br /></dt>
<dd><p>Periodic in X, closed in Y and Z (typical for channel flow) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par214BoundaryConfig6open_xEv">
<span id="_CPPv3N4par214BoundaryConfig6open_xEv"></span><span id="_CPPv2N4par214BoundaryConfig6open_xEv"></span><span id="par2::BoundaryConfig::open_xCE"></span><span class="target" id="structpar2_1_1BoundaryConfig_1a4fcc5be907a26875c84c15ed38151818"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par214BoundaryConfigE" title="par2::BoundaryConfig"><span class="n"><span class="pre">BoundaryConfig</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">open_x</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par214BoundaryConfig6open_xEv" title="Link to this definition"></a><br /></dt>
<dd><p>Open inlet (X-), open outlet (X+), closed lateral. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="particle-injection">
<h2>Particle Injection<a class="headerlink" href="#particle-injection" title="Link to this heading"></a></h2>
<p>Particle injection functions public API. </p>
<p>These functions initialize particle positions on the GPU without requiring host-device data transfers. The particles must already be allocated on device.</p>
<p><dl class="simple">
<dt><strong>Copyright</strong></dt><dd><p>Par2_Core - GPU-native transport engine </p>
</dd>
</dl>
</p>
<dl class="cpp type">
<dt class="sig sig-object cpp">
<span class="target" id="namespacepar2"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">par2</span></span></span><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par210inject_boxEvRK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t">
<span id="_CPPv3I0EN4par210inject_boxERK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t"></span><span id="_CPPv2I0EN4par210inject_boxERK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1a30900d048d64c7b0bb3891393943b727"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inject_box</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par213ParticlesViewE" title="par2::ParticlesView"><span class="n"><span class="pre">ParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par210inject_boxEvRK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t" title="par2::inject_box::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par210inject_boxEvRK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t" title="par2::inject_box::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">x0</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par210inject_boxEvRK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t" title="par2::inject_box::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">y0</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par210inject_boxEvRK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t" title="par2::inject_box::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">z0</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par210inject_boxEvRK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t" title="par2::inject_box::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">x1</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par210inject_boxEvRK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t" title="par2::inject_box::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">y1</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par210inject_boxEvRK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t" title="par2::inject_box::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">z1</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">seed</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">12345ULL</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN4par210inject_boxEvRK13ParticlesViewI1TE1T1T1T1T1T1Ty12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize particles uniformly distributed in a box. </p>
<p>
Particles are distributed uniformly within the box using a deterministic algorithm based on particle index and seed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the standalone function version. <a class="reference internal" href="#classpar2_1_1TransportEngine_1ac104270e0963816b21585e33f89be79f"><span class="std std-ref">TransportEngine::inject_box</span></a> provides the same functionality through the engine API. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type (float or double)</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>particles</strong> – Particle view (device pointers) </p></li>
<li><p><strong>x0, y0, z0</strong> – Minimum corner of box </p></li>
<li><p><strong>x1, y1, z1</strong> – Maximum corner of box </p></li>
<li><p><strong>seed</strong> – Random seed for reproducibility </p></li>
<li><p><strong>stream</strong> – CUDA stream (nullptr for default)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par211inject_gridEvRK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t">
<span id="_CPPv3I0EN4par211inject_gridERK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t"></span><span id="_CPPv2I0EN4par211inject_gridERK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1a56cf396b9bbc13ad93080a9144bfcbe9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inject_grid</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par213ParticlesViewE" title="par2::ParticlesView"><span class="n"><span class="pre">ParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par211inject_gridEvRK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t" title="par2::inject_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par211inject_gridEvRK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t" title="par2::inject_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">x0</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par211inject_gridEvRK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t" title="par2::inject_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">y0</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par211inject_gridEvRK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t" title="par2::inject_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">z0</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par211inject_gridEvRK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t" title="par2::inject_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">x1</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par211inject_gridEvRK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t" title="par2::inject_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">y1</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par211inject_gridEvRK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t" title="par2::inject_grid::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">z1</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nx</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ny</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nz</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN4par211inject_gridEvRK13ParticlesViewI1TE1T1T1T1T1T1Tiii12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize particles at regular grid positions within a box. </p>
<p>
Creates a regular grid of particles. Total particles = nx * ny * nz. If particles.n != nx*ny*nz, only min(particles.n, nx*ny*nz) are set.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Useful for debugging and visualization. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>particles</strong> – Particle view </p></li>
<li><p><strong>x0, y0, z0</strong> – Minimum corner </p></li>
<li><p><strong>x1, y1, z1</strong> – Maximum corner </p></li>
<li><p><strong>nx, ny, nz</strong> – Number of particles per axis </p></li>
<li><p><strong>stream</strong> – CUDA stream</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="namespacepar2_1a0eaccbf22f25d80ed8b516d5290792ad"></span><span class="sig-name descname"><span class="pre">template</span> <span class="pre">void</span> <span class="pre">inject_box&lt;</span> <span class="pre">float</span> <span class="pre">&gt;</span> <span class="pre">(const</span> <span class="pre">ParticlesView&lt;</span> <span class="pre">float</span> <span class="pre">&gt;</span> <span class="pre">&amp;,</span> <span class="pre">float,</span> <span class="pre">float,</span> <span class="pre">float,</span> <span class="pre">float,</span> <span class="pre">float,</span> <span class="pre">float,</span> <span class="pre">unsigned</span> <span class="pre">long</span> <span class="pre">long,</span> <span class="pre">cudaStream_t)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="namespacepar2_1ae8f95ea711d3188099c1acedef032594"></span><span class="sig-name descname"><span class="pre">template</span> <span class="pre">void</span> <span class="pre">inject_box&lt;</span> <span class="pre">double</span> <span class="pre">&gt;</span> <span class="pre">(const</span> <span class="pre">ParticlesView&lt;</span> <span class="pre">double</span> <span class="pre">&gt;</span> <span class="pre">&amp;,</span> <span class="pre">double,</span> <span class="pre">double,</span> <span class="pre">double,</span> <span class="pre">double,</span> <span class="pre">double,</span> <span class="pre">double,</span> <span class="pre">unsigned</span> <span class="pre">long</span> <span class="pre">long,</span> <span class="pre">cudaStream_t)</span></span></dt>
<dd></dd></dl>

</div>
</dd></dl>

</section>
<section id="statistics">
<h2>Statistics<a class="headerlink" href="#statistics" title="Link to this heading"></a></h2>
<p>Statistics utilities for Par2_Core. </p>
<p>GPU-accelerated computation of particle statistics:<ul class="simple">
<li><p>Position moments (mean, variance, standard deviation)</p></li>
<li><p>Status counts (active, exited, inactive)</p></li>
<li><p>Legacy-compatible functions (concentrationBox, concentrationAfterX)</p></li>
</ul>
</p>
<dl class="cpp type">
<dt class="sig sig-object cpp">
<span class="target" id="namespacepar2"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">par2</span></span></span><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par217concentration_boxEdRK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t">
<span id="_CPPv3I0EN4par217concentration_boxERK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t"></span><span id="_CPPv2I0EN4par217concentration_boxERK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1a770790c753e2c1e702444601a7d43f36"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">concentration_box</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView"><span class="n"><span class="pre">ConstParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par217concentration_boxEdRK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t" title="par2::concentration_box::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par217concentration_boxEdRK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t" title="par2::concentration_box::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">x0</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par217concentration_boxEdRK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t" title="par2::concentration_box::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">y0</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par217concentration_boxEdRK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t" title="par2::concentration_box::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">z0</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par217concentration_boxEdRK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t" title="par2::concentration_box::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">x1</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par217concentration_boxEdRK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t" title="par2::concentration_box::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">y1</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par217concentration_boxEdRK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t" title="par2::concentration_box::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">z1</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN4par217concentration_boxEdRK18ConstParticlesViewI1TE1T1T1T1T1T1T12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Count particles in a box region. </p>
<p>Equivalent to legacy <code class="docutils literal notranslate"><span class="pre">concentrationBox()</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function SYNCHRONIZES the stream internally. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Particles with any status are counted (no filtering). This matches legacy behavior. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This blocks the CPU until the stream completes. Unsuitable for the hot path in HPC pipelines. For async operation, use <a class="reference internal" href="#classpar2_1_1StatsComputer"><span class="std std-ref">StatsComputer</span></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>particles</strong> – Particle positions (device) </p></li>
<li><p><strong>x0, y0, z0</strong> – Minimum corner of box </p></li>
<li><p><strong>x1, y1, z1</strong> – Maximum corner of box </p></li>
<li><p><strong>stream</strong> – CUDA stream (nullptr = default stream)</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Fraction of particles inside box [0.0, 1.0]</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par224concentration_past_planeEdRK18ConstParticlesViewI1TEi1T12cudaStream_t">
<span id="_CPPv3I0EN4par224concentration_past_planeERK18ConstParticlesViewI1TEi1T12cudaStream_t"></span><span id="_CPPv2I0EN4par224concentration_past_planeERK18ConstParticlesViewI1TEi1T12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1a9bce5aded6bb06c022dd23ab5bccc411"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">concentration_past_plane</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView"><span class="n"><span class="pre">ConstParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par224concentration_past_planeEdRK18ConstParticlesViewI1TEi1T12cudaStream_t" title="par2::concentration_past_plane::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">axis</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par224concentration_past_planeEdRK18ConstParticlesViewI1TEi1T12cudaStream_t" title="par2::concentration_past_plane::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">threshold</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN4par224concentration_past_planeEdRK18ConstParticlesViewI1TEi1T12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Count particles past a plane. </p>
<p>Equivalent to legacy <code class="docutils literal notranslate"><span class="pre">concentrationAfterX()</span></code> (when axis=0).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function SYNCHRONIZES the stream internally. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All particles counted regardless of status (legacy behavior). </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This blocks the CPU until the stream completes. Unsuitable for the hot path in HPC pipelines.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>particles</strong> – Particle positions (device) </p></li>
<li><p><strong>axis</strong> – Which axis: 0=X, 1=Y, 2=Z </p></li>
<li><p><strong>threshold</strong> – Position of the plane </p></li>
<li><p><strong>stream</strong> – CUDA stream (nullptr = default stream)</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Fraction of particles with coord &gt; threshold [0.0, 1.0]</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par215count_by_statusE14ParticleCountsRK18ConstParticlesViewI1TE12cudaStream_t">
<span id="_CPPv3I0EN4par215count_by_statusERK18ConstParticlesViewI1TE12cudaStream_t"></span><span id="_CPPv2I0EN4par215count_by_statusERK18ConstParticlesViewI1TE12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1a891f2f48e8cee966243f37d1f22878f7"></span><a class="reference internal" href="#_CPPv4N4par214ParticleCountsE" title="par2::ParticleCounts"><span class="n"><span class="pre">ParticleCounts</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">count_by_status</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView"><span class="n"><span class="pre">ConstParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par215count_by_statusE14ParticleCountsRK18ConstParticlesViewI1TE12cudaStream_t" title="par2::count_by_status::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN4par215count_by_statusE14ParticleCountsRK18ConstParticlesViewI1TE12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Count particles by status. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If particles.status is nullptr, all are counted as active. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function SYNCHRONIZES the stream internally. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>particles</strong> – Particle view with status array </p></li>
<li><p><strong>stream</strong> – CUDA stream</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#structpar2_1_1ParticleCounts"><span class="std std-ref">ParticleCounts</span></a> with active/exited/inactive counts</p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par28Moments3E">
<span id="_CPPv3I0EN4par28Moments3E"></span><span id="_CPPv2I0EN4par28Moments3E"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1Moments3"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Moments3</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par28Moments3E" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;stats.hpp&gt;</em></div>
<p>3D moment statistics (mean, variance, std). </p>
<p>
For unwrapped positions under periodic BC: x_unwrap = x + wrapX * Lx</p>
<p>Variance uses the unbiased estimator (N-1 denominator). </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par28Moments37has_nanEv">
<span id="_CPPv3NK4par28Moments37has_nanEv"></span><span id="_CPPv2NK4par28Moments37has_nanEv"></span><span id="par2::Moments3::has_nanC"></span><span class="target" id="structpar2_1_1Moments3_1a30660ebcdd5c14d5b85b0f7e3555129d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_nan</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par28Moments37has_nanEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check if any component is NaN. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par28Moments34meanE">
<span id="_CPPv3N4par28Moments34meanE"></span><span id="_CPPv2N4par28Moments34meanE"></span><span id="par2::Moments3::mean__TA"></span><span class="target" id="structpar2_1_1Moments3_1a835d62ddcf1398f08de7a2cb7cb932c0"></span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mean</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">3</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N4par28Moments34meanE" title="Link to this definition"></a><br /></dt>
<dd><p>Mean position (x̄, ȳ, z̄) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par28Moments33varE">
<span id="_CPPv3N4par28Moments33varE"></span><span id="_CPPv2N4par28Moments33varE"></span><span id="par2::Moments3::var__TA"></span><span class="target" id="structpar2_1_1Moments3_1a0f07c172941eaf416b4cb840fa6a82d6"></span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">var</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">3</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N4par28Moments33varE" title="Link to this definition"></a><br /></dt>
<dd><p>Variance (σ²_x, σ²_y, σ²_z) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par28Moments3StE">
<span id="_CPPv3N4par28Moments3StE"></span><span id="_CPPv2N4par28Moments3StE"></span><span id="par2::Moments3::std__TA"></span><span class="target" id="structpar2_1_1Moments3_1a7fb92a0bec5323eb0a0575748c6b9b86"></span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">std</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">3</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">(</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">}</span></span><a class="headerlink" href="#_CPPv4N4par28Moments3StE" title="Link to this definition"></a><br /></dt>
<dd><p>Standard deviation (σ_x, σ_y, σ_z) </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4par214ParticleCountsE">
<span id="_CPPv3N4par214ParticleCountsE"></span><span id="_CPPv2N4par214ParticleCountsE"></span><span id="par2::ParticleCounts"></span><span class="target" id="structpar2_1_1ParticleCounts"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ParticleCounts</span></span></span><a class="headerlink" href="#_CPPv4N4par214ParticleCountsE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;stats.hpp&gt;</em></div>
<p>Particle count statistics by status. </p>
<p><ul class="simple">
<li><p>If no status array is provided, all particles are counted as “active”</p></li>
<li><p>Counts should sum to total (active + exited + inactive == total) </p></li>
</ul>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par214ParticleCounts5totalE">
<span id="_CPPv3N4par214ParticleCounts5totalE"></span><span id="_CPPv2N4par214ParticleCounts5totalE"></span><span id="par2::ParticleCounts::total__i"></span><span class="target" id="structpar2_1_1ParticleCounts_1ae4590abbfaa02528ca15cbc64750d179"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">total</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par214ParticleCounts5totalE" title="Link to this definition"></a><br /></dt>
<dd><p>Total number of particles. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par214ParticleCounts6activeE">
<span id="_CPPv3N4par214ParticleCounts6activeE"></span><span id="_CPPv2N4par214ParticleCounts6activeE"></span><span id="par2::ParticleCounts::active__i"></span><span class="target" id="structpar2_1_1ParticleCounts_1a14897a2acbd520688ee2e8c0cb055903"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">active</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par214ParticleCounts6activeE" title="Link to this definition"></a><br /></dt>
<dd><p>Particles with Status::Active (or no status) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par214ParticleCounts6exitedE">
<span id="_CPPv3N4par214ParticleCounts6exitedE"></span><span id="_CPPv2N4par214ParticleCounts6exitedE"></span><span id="par2::ParticleCounts::exited__i"></span><span class="target" id="structpar2_1_1ParticleCounts_1abd299589ccb012c12a3d08a8ea03e117"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">exited</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par214ParticleCounts6exitedE" title="Link to this definition"></a><br /></dt>
<dd><p>Particles with Status::Exited. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par214ParticleCounts8inactiveE">
<span id="_CPPv3N4par214ParticleCounts8inactiveE"></span><span id="_CPPv2N4par214ParticleCounts8inactiveE"></span><span id="par2::ParticleCounts::inactive__i"></span><span class="target" id="structpar2_1_1ParticleCounts_1adcb49f625d86def619f444118ffaefa8"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inactive</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par214ParticleCounts8inactiveE" title="Link to this definition"></a><br /></dt>
<dd><p>Particles with Status::Inactive. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par213StatsComputerE">
<span id="_CPPv3I0EN4par213StatsComputerE"></span><span id="_CPPv2I0EN4par213StatsComputerE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classpar2_1_1StatsComputer"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StatsComputer</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par213StatsComputerE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;stats.hpp&gt;</em></div>
<p>GPU-accelerated statistics computer with persistent buffers. </p>
<p>
Computes position moments (mean, variance, std) and status counts using GPU reduction kernels. Internal buffers are allocated once and reused across calls.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type (float or double)</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par213StatsComputer13StatsComputerEi">
<span id="_CPPv3N4par213StatsComputer13StatsComputerEi"></span><span id="_CPPv2N4par213StatsComputer13StatsComputerEi"></span><span id="par2::StatsComputer::StatsComputer__i"></span><span class="target" id="classpar2_1_1StatsComputer_1a6cadba63284214173a6701625be7463f"></span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StatsComputer</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_particles</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par213StatsComputer13StatsComputerEi" title="Link to this definition"></a><br /></dt>
<dd><p>Construct with capacity. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>max_particles</strong> – Maximum particle count to support. Larger values require more GPU memory.</p>
</dd>
<dt class="field-even">Throws<span class="colon">:</span></dt>
<dd class="field-even"><p><span><span class="cpp-expr sig sig-inline cpp"><span class="n">std</span><span class="p">::</span><span class="n">bad_alloc</span></span></span> – if GPU allocation fails </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par213StatsComputerD0Ev">
<span id="_CPPv3N4par213StatsComputerD0Ev"></span><span id="_CPPv2N4par213StatsComputerD0Ev"></span><span id="par2::StatsComputer::~StatsComputer"></span><span class="target" id="classpar2_1_1StatsComputer_1a3115b8956e498d3e51c42ec807c4f2e0"></span><span class="sig-name descname"><span class="n"><span class="pre">~StatsComputer</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par213StatsComputerD0Ev" title="Link to this definition"></a><br /></dt>
<dd><p>Destructor - frees GPU and pinned memory. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par213StatsComputer13StatsComputerERK13StatsComputer">
<span id="_CPPv3N4par213StatsComputer13StatsComputerERK13StatsComputer"></span><span id="_CPPv2N4par213StatsComputer13StatsComputerERK13StatsComputer"></span><span id="par2::StatsComputer::StatsComputer__StatsComputerCR"></span><span class="target" id="classpar2_1_1StatsComputer_1ac23d76ce5f3a700735f0c989fb73c5d1"></span><span class="sig-name descname"><span class="n"><span class="pre">StatsComputer</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par213StatsComputer13StatsComputerERK13StatsComputer" title="par2::StatsComputer::StatsComputer"><span class="n"><span class="pre">StatsComputer</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N4par213StatsComputer13StatsComputerERK13StatsComputer" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par213StatsComputeraSERK13StatsComputer">
<span id="_CPPv3N4par213StatsComputeraSERK13StatsComputer"></span><span id="_CPPv2N4par213StatsComputeraSERK13StatsComputer"></span><span id="par2::StatsComputer::assign-operator__StatsComputerCR"></span><span class="target" id="classpar2_1_1StatsComputer_1a4b993efa911878cca7c1fed44887f642"></span><a class="reference internal" href="#_CPPv4I0EN4par213StatsComputerE" title="par2::StatsComputer"><span class="n"><span class="pre">StatsComputer</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par213StatsComputerE" title="par2::StatsComputer"><span class="n"><span class="pre">StatsComputer</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N4par213StatsComputeraSERK13StatsComputer" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par213StatsComputer13StatsComputerERR13StatsComputer">
<span id="_CPPv3N4par213StatsComputer13StatsComputerERR13StatsComputer"></span><span id="_CPPv2N4par213StatsComputer13StatsComputerERR13StatsComputer"></span><span id="par2::StatsComputer::StatsComputer__StatsComputerRR"></span><span class="target" id="classpar2_1_1StatsComputer_1aeec413c4e43fb9226f13bf317fa2b9a8"></span><span class="sig-name descname"><span class="n"><span class="pre">StatsComputer</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N4par213StatsComputer13StatsComputerERR13StatsComputer" title="par2::StatsComputer::StatsComputer"><span class="n"><span class="pre">StatsComputer</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">other</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par213StatsComputer13StatsComputerERR13StatsComputer" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par213StatsComputeraSERR13StatsComputer">
<span id="_CPPv3N4par213StatsComputeraSERR13StatsComputer"></span><span id="_CPPv2N4par213StatsComputeraSERR13StatsComputer"></span><span id="par2::StatsComputer::assign-operator__StatsComputerRR"></span><span class="target" id="classpar2_1_1StatsComputer_1a408a69b66fe50b40e57768307337f3a8"></span><a class="reference internal" href="#_CPPv4I0EN4par213StatsComputerE" title="par2::StatsComputer"><span class="n"><span class="pre">StatsComputer</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN4par213StatsComputerE" title="par2::StatsComputer"><span class="n"><span class="pre">StatsComputer</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">other</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par213StatsComputeraSERR13StatsComputer" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par213StatsComputer13compute_asyncERK18ConstParticlesViewI1TERK8GridDescI1TERK11StatsConfig12cudaStream_t">
<span id="_CPPv3N4par213StatsComputer13compute_asyncERK18ConstParticlesViewI1TERK8GridDescI1TERK11StatsConfig12cudaStream_t"></span><span id="_CPPv2N4par213StatsComputer13compute_asyncERK18ConstParticlesViewI1TERK8GridDescI1TERK11StatsConfig12cudaStream_t"></span><span id="par2::StatsComputer::compute_async__ConstParticlesView:T:CR.GridDesc:T:CR.StatsConfigCR.cudaStream_t"></span><span class="target" id="classpar2_1_1StatsComputer_1aa6637dee6851cfcbd77bbff1ec6d62c8"></span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compute_async</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView"><span class="n"><span class="pre">ConstParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par213StatsComputerE" title="par2::StatsComputer::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par28GridDescE" title="par2::GridDesc"><span class="n"><span class="pre">GridDesc</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par213StatsComputerE" title="par2::StatsComputer::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">grid</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par211StatsConfigE" title="par2::StatsConfig"><span class="n"><span class="pre">StatsConfig</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">config</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par213StatsComputer13compute_asyncERK18ConstParticlesViewI1TERK8GridDescI1TERK11StatsConfig12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Compute statistics asynchronously. </p>
<p>Launches GPU kernels to compute moments and counts. Results are written to pinned host memory asynchronously.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Does NOT synchronize. Caller must synchronize stream before calling <a class="reference internal" href="#classpar2_1_1StatsComputer_1a13c5539a0d595310bd06eabc5922876b"><span class="std std-ref">fetch_result()</span></a>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If particles.n &gt; max_particles, returns cudaErrorInvalidValue. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> – Particle positions (device pointers) </p></li>
<li><p><strong>grid</strong> – Grid descriptor (for domain size in unwrap) </p></li>
<li><p><strong>config</strong> – Computation configuration </p></li>
<li><p><strong>stream</strong> – CUDA stream for async execution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>cudaSuccess on launch success, error code otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par213StatsComputer12fetch_resultEv">
<span id="_CPPv3NK4par213StatsComputer12fetch_resultEv"></span><span id="_CPPv2NK4par213StatsComputer12fetch_resultEv"></span><span id="par2::StatsComputer::fetch_resultC"></span><span class="target" id="classpar2_1_1StatsComputer_1a13c5539a0d595310bd06eabc5922876b"></span><a class="reference internal" href="#_CPPv4I0EN4par211StatsResultE" title="par2::StatsResult"><span class="n"><span class="pre">StatsResult</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par213StatsComputerE" title="par2::StatsComputer::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fetch_result</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4par213StatsComputer12fetch_resultEv" title="Link to this definition"></a><br /></dt>
<dd><p>Fetch results after stream synchronization. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <a class="reference internal" href="#classpar2_1_1StatsComputer_1aa6637dee6851cfcbd77bbff1ec6d62c8"><span class="std std-ref">compute_async()</span></a> was never called or returned an error, result.computed will be false. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#structpar2_1_1StatsResult"><span class="std std-ref">StatsResult</span></a> with computed moments and counts.</p>
</dd>
<dt class="field-even">Pre<span class="colon">:</span></dt>
<dd class="field-even"><p>Stream passed to <a class="reference internal" href="#classpar2_1_1StatsComputer_1aa6637dee6851cfcbd77bbff1ec6d62c8"><span class="std std-ref">compute_async()</span></a> must be synchronized. </p>
</dd>
<dt class="field-odd">Pre<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#classpar2_1_1StatsComputer_1aa6637dee6851cfcbd77bbff1ec6d62c8"><span class="std std-ref">compute_async()</span></a> must have been called.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par213StatsComputer8capacityEv">
<span id="_CPPv3NK4par213StatsComputer8capacityEv"></span><span id="_CPPv2NK4par213StatsComputer8capacityEv"></span><span id="par2::StatsComputer::capacityC"></span><span class="target" id="classpar2_1_1StatsComputer_1a2e6998cf0b9980b601937e359c715502"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">capacity</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par213StatsComputer8capacityEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get the maximum capacity. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-private-members">Private Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par213StatsComputer5impl_E">
<span id="_CPPv3N4par213StatsComputer5impl_E"></span><span id="_CPPv2N4par213StatsComputer5impl_E"></span><span id="par2::StatsComputer::impl___ImplP"></span><span class="target" id="classpar2_1_1StatsComputer_1ab7c10ccbbd9b65466a02a8518542ca2e"></span><span class="n"><span class="pre">Impl</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">impl_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par213StatsComputer5impl_E" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4par211StatsConfigE">
<span id="_CPPv3N4par211StatsConfigE"></span><span id="_CPPv2N4par211StatsConfigE"></span><span id="par2::StatsConfig"></span><span class="target" id="structpar2_1_1StatsConfig"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StatsConfig</span></span></span><a class="headerlink" href="#_CPPv4N4par211StatsConfigE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;stats.hpp&gt;</em></div>
<p>Configuration for statistics computation. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par211StatsConfig13use_unwrappedE">
<span id="_CPPv3N4par211StatsConfig13use_unwrappedE"></span><span id="_CPPv2N4par211StatsConfig13use_unwrappedE"></span><span id="par2::StatsConfig::use_unwrapped__b"></span><span class="target" id="structpar2_1_1StatsConfig_1ac6a95f250505087ccd447f8008099c63"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">use_unwrapped</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4par211StatsConfig13use_unwrappedE" title="Link to this definition"></a><br /></dt>
<dd><p>Use unwrapped positions for moment computation. </p>
<p>When true, positions are computed as: x_unwrap = x + wrapX * Lx</p>
<p>Requires <a class="reference internal" href="#structpar2_1_1ParticlesView"><span class="std std-ref">ParticlesView</span></a> to have wrapX/Y/Z set. Essential for correct statistics under periodic BC.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If wrapX/Y/Z are nullptr, this flag is ignored. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par211StatsConfig18filter_active_onlyE">
<span id="_CPPv3N4par211StatsConfig18filter_active_onlyE"></span><span id="_CPPv2N4par211StatsConfig18filter_active_onlyE"></span><span id="par2::StatsConfig::filter_active_only__b"></span><span class="target" id="structpar2_1_1StatsConfig_1a58677d86507194408e0f42d194c8533e"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">filter_active_only</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><a class="headerlink" href="#_CPPv4N4par211StatsConfig18filter_active_onlyE" title="Link to this definition"></a><br /></dt>
<dd><p>Compute moments only for Active particles. </p>
<p>When true (default), Exited and Inactive particles are excluded from mean/var/std computation.</p>
<p>When false, all particles are included regardless of status.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Legacy PAR² has no status concept, so all particles are effectively “active”. Setting this to true matches legacy behavior when no status array is provided. </p>
</div>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par211StatsResultE">
<span id="_CPPv3I0EN4par211StatsResultE"></span><span id="_CPPv2I0EN4par211StatsResultE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1StatsResult"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StatsResult</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par211StatsResultE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;stats.hpp&gt;</em></div>
<p>Complete statistics result. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type </p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par211StatsResult5validEv">
<span id="_CPPv3NK4par211StatsResult5validEv"></span><span id="_CPPv2NK4par211StatsResult5validEv"></span><span id="par2::StatsResult::validC"></span><span class="target" id="structpar2_1_1StatsResult_1a7238fd79bc9f164eafb92ed362fc58af"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">valid</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par211StatsResult5validEv" title="Link to this definition"></a><br /></dt>
<dd><p>Check validity (computed and no NaN) </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par211StatsResult7momentsE">
<span id="_CPPv3N4par211StatsResult7momentsE"></span><span id="_CPPv2N4par211StatsResult7momentsE"></span><span id="par2::StatsResult::moments__Moments3:T:"></span><span class="target" id="structpar2_1_1StatsResult_1a2c0177a8e58f4eebafb6330a5c91574f"></span><a class="reference internal" href="#_CPPv4I0EN4par28Moments3E" title="par2::Moments3"><span class="n"><span class="pre">Moments3</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par211StatsResultE" title="par2::StatsResult::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">moments</span></span></span><a class="headerlink" href="#_CPPv4N4par211StatsResult7momentsE" title="Link to this definition"></a><br /></dt>
<dd><p>Position statistics. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par211StatsResult6countsE">
<span id="_CPPv3N4par211StatsResult6countsE"></span><span id="_CPPv2N4par211StatsResult6countsE"></span><span id="par2::StatsResult::counts__ParticleCounts"></span><span class="target" id="structpar2_1_1StatsResult_1afac5c76cbb66f990a2d5e1eb9fd6f7a8"></span><a class="reference internal" href="#_CPPv4N4par214ParticleCountsE" title="par2::ParticleCounts"><span class="n"><span class="pre">ParticleCounts</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">counts</span></span></span><a class="headerlink" href="#_CPPv4N4par211StatsResult6countsE" title="Link to this definition"></a><br /></dt>
<dd><p>Status counts. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par211StatsResult8computedE">
<span id="_CPPv3N4par211StatsResult8computedE"></span><span id="_CPPv2N4par211StatsResult8computedE"></span><span id="par2::StatsResult::computed__b"></span><span class="target" id="structpar2_1_1StatsResult_1a385ea74d3232d7a1ffb06888f3a94c2b"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">computed</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4par211StatsResult8computedE" title="Link to this definition"></a><br /></dt>
<dd><p>True if computation completed successfully. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="i-o-helpers">
<h2>I/O Helpers<a class="headerlink" href="#i-o-helpers" title="Link to this heading"></a></h2>
<p>I/O helpers for particle data (host-side, explicit operations). </p>
<p>These utilities enable downloading particle data from GPU to CPU for export, visualization, or external analysis. All operations are explicit and stream-aware - no hidden copies.</p>
<dl class="cpp type">
<dt class="sig sig-object cpp">
<span class="target" id="namespacepar2"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">par2</span></span></span><br /></dt>
<dd><dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4par22ioE">
<span id="_CPPv3N4par22ioE"></span><span id="_CPPv2N4par22ioE"></span><span id="par2::io"></span><span class="target" id="namespacepar2_1_1io"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">io</span></span></span><a class="headerlink" href="#_CPPv4N4par22ioE" title="Link to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par22io24download_positions_asyncE11cudaError_tR19HostParticlesBufferI1TERK18ConstParticlesViewI1TEi12cudaStream_t">
<span id="_CPPv3I0EN4par22io24download_positions_asyncER19HostParticlesBufferI1TERK18ConstParticlesViewI1TEi12cudaStream_t"></span><span id="_CPPv2I0EN4par22io24download_positions_asyncER19HostParticlesBufferI1TERK18ConstParticlesViewI1TEi12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1_1io_1af6cc3c2fcea51cfe04ae59feaa9bf95a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">download_positions_async</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN4par22io19HostParticlesBufferE" title="par2::io::HostParticlesBuffer"><span class="n"><span class="pre">HostParticlesBuffer</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par22io24download_positions_asyncE11cudaError_tR19HostParticlesBufferI1TERK18ConstParticlesViewI1TEi12cudaStream_t" title="par2::io::download_positions_async::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">host</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView"><span class="n"><span class="pre">ConstParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par22io24download_positions_asyncE11cudaError_tR19HostParticlesBufferI1TERK18ConstParticlesViewI1TEi12cudaStream_t" title="par2::io::download_positions_async::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">device</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN4par22io24download_positions_asyncE11cudaError_tR19HostParticlesBufferI1TERK18ConstParticlesViewI1TEi12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Download wrapped particle positions asynchronously. </p>
<p><strong>Important</strong>: For pinned host memory, copy overlaps with computation. After this call, synchronize the stream before reading host data. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>host</strong> – Destination host buffer (must have capacity &gt;= n) </p></li>
<li><p><strong>device</strong> – Source device view </p></li>
<li><p><strong>n</strong> – Number of particles to download </p></li>
<li><p><strong>stream</strong> – CUDA stream for async copy</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>cudaSuccess on success, error code otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par22io24download_unwrapped_asyncE11cudaError_tR19HostParticlesBufferI1TERK22UnwrappedPositionsViewI1TEi12cudaStream_t">
<span id="_CPPv3I0EN4par22io24download_unwrapped_asyncER19HostParticlesBufferI1TERK22UnwrappedPositionsViewI1TEi12cudaStream_t"></span><span id="_CPPv2I0EN4par22io24download_unwrapped_asyncER19HostParticlesBufferI1TERK22UnwrappedPositionsViewI1TEi12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1_1io_1a68ccb197c34cc363235d773a59682166"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">download_unwrapped_async</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN4par22io19HostParticlesBufferE" title="par2::io::HostParticlesBuffer"><span class="n"><span class="pre">HostParticlesBuffer</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par22io24download_unwrapped_asyncE11cudaError_tR19HostParticlesBufferI1TERK22UnwrappedPositionsViewI1TEi12cudaStream_t" title="par2::io::download_unwrapped_async::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">host</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par222UnwrappedPositionsViewE" title="par2::UnwrappedPositionsView"><span class="n"><span class="pre">UnwrappedPositionsView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par22io24download_unwrapped_asyncE11cudaError_tR19HostParticlesBufferI1TERK22UnwrappedPositionsViewI1TEi12cudaStream_t" title="par2::io::download_unwrapped_async::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">device_unwrap</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN4par22io24download_unwrapped_asyncE11cudaError_tR19HostParticlesBufferI1TERK22UnwrappedPositionsViewI1TEi12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Download unwrapped positions asynchronously. </p>
<p>
Call after engine.compute_unwrapped_positions() to get continuous positions. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>host</strong> – Destination (must have x_u/y_u/z_u set) </p></li>
<li><p><strong>device_unwrap</strong> – Source device unwrapped view </p></li>
<li><p><strong>n</strong> – Number of particles </p></li>
<li><p><strong>stream</strong> – CUDA stream</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>cudaSuccess on success</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par22io19write_particles_csvEbRKNSt6stringERK19HostParticlesBufferI1TEi1Tbbb">
<span id="_CPPv3I0EN4par22io19write_particles_csvERKNSt6stringERK19HostParticlesBufferI1TEi1Tbbb"></span><span id="_CPPv2I0EN4par22io19write_particles_csvERKNSt6stringERK19HostParticlesBufferI1TEi1Tbbb"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1_1io_1a9517c7329b8d411d3a84ca7a134ff6e0"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">write_particles_csv</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par22io19HostParticlesBufferE" title="par2::io::HostParticlesBuffer"><span class="n"><span class="pre">HostParticlesBuffer</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par22io19write_particles_csvEbRKNSt6stringERK19HostParticlesBufferI1TEi1Tbbb" title="par2::io::write_particles_csv::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">host</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par22io19write_particles_csvEbRKNSt6stringERK19HostParticlesBufferI1TEi1Tbbb" title="par2::io::write_particles_csv::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">include_unwrapped</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">include_status</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">append</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN4par22io19write_particles_csvEbRKNSt6stringERK19HostParticlesBufferI1TEi1Tbbb" title="Link to this definition"></a><br /></dt>
<dd><p>Write particle snapshot to CSV file. </p>
<p>
CSV format: t,id,x,y,z[,xu,yu,zu][,status]</p>
<p><strong>Note</strong>: This is a blocking host-side operation. Call after cudaStreamSynchronize to ensure data is ready. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>filename</strong> – Output file path </p></li>
<li><p><strong>host</strong> – Host buffer with downloaded data </p></li>
<li><p><strong>n</strong> – Number of particles </p></li>
<li><p><strong>time</strong> – Current simulation time </p></li>
<li><p><strong>include_unwrapped</strong> – If true, include x_u,y_u,z_u columns </p></li>
<li><p><strong>include_status</strong> – If true, include status column </p></li>
<li><p><strong>append</strong> – If true, append to file; otherwise overwrite</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>true on success, false on I/O error</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par22io25write_legacy_csv_snapshotEbRK18ConstParticlesViewI1TERKNSt6stringE12cudaStream_t">
<span id="_CPPv3I0EN4par22io25write_legacy_csv_snapshotERK18ConstParticlesViewI1TERKNSt6stringE12cudaStream_t"></span><span id="_CPPv2I0EN4par22io25write_legacy_csv_snapshotERK18ConstParticlesViewI1TERKNSt6stringE12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="namespacepar2_1_1io_1a73a0b9995b28fd6d067ca6360950e18c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">write_legacy_csv_snapshot</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView"><span class="n"><span class="pre">ConstParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par22io25write_legacy_csv_snapshotEbRK18ConstParticlesViewI1TERKNSt6stringE12cudaStream_t" title="par2::io::write_legacy_csv_snapshot::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN4par22io25write_legacy_csv_snapshotEbRK18ConstParticlesViewI1TERKNSt6stringE12cudaStream_t" title="Link to this definition"></a><br /></dt>
<dd><p>Write legacy-format CSV snapshot (one-shot, no reused buffers). </p>
<p>
Convenience function that matches legacy PAR² exportCSV() exactly:<ul class="simple">
<li><p>Columns: id, x coord, y coord, z coord</p></li>
<li><p>Precision: 15 decimal digits</p></li>
<li><p>No status, no wrap, no time</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Allocates temporary pinned memory. For repeated exports, prefer <a class="reference internal" href="#classpar2_1_1io_1_1CsvSnapshotWriter"><span class="std std-ref">CsvSnapshotWriter</span></a> to reuse buffers.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Synchronizes stream internally. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>particles</strong> – Particle positions (device) </p></li>
<li><p><strong>filename</strong> – Output file path </p></li>
<li><p><strong>stream</strong> – CUDA stream</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>true on success</p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotConfigE">
<span id="_CPPv3N4par22io17CsvSnapshotConfigE"></span><span id="_CPPv2N4par22io17CsvSnapshotConfigE"></span><span id="par2::io::CsvSnapshotConfig"></span><span class="target" id="structpar2_1_1io_1_1CsvSnapshotConfig"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CsvSnapshotConfig</span></span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotConfigE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;io.hpp&gt;</em></div>
<p>Configuration for CSV snapshot export. </p>
<p>Controls format, columns, and sampling for CSV particle snapshots.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotConfig13legacy_formatE">
<span id="_CPPv3N4par22io17CsvSnapshotConfig13legacy_formatE"></span><span id="_CPPv2N4par22io17CsvSnapshotConfig13legacy_formatE"></span><span id="par2::io::CsvSnapshotConfig::legacy_format__b"></span><span class="target" id="structpar2_1_1io_1_1CsvSnapshotConfig_1a1446df872c8b1da73a5dce679945d879"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">legacy_format</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotConfig13legacy_formatE" title="Link to this definition"></a><br /></dt>
<dd><p>Use legacy PAR² column names. </p>
<p>When true: “id,x coord,y coord,z coord” When false: “id,x,y,z”</p>
<p>Default: true (legacy compatible) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotConfig10include_idE">
<span id="_CPPv3N4par22io17CsvSnapshotConfig10include_idE"></span><span id="_CPPv2N4par22io17CsvSnapshotConfig10include_idE"></span><span id="par2::io::CsvSnapshotConfig::include_id__b"></span><span class="target" id="structpar2_1_1io_1_1CsvSnapshotConfig_1a3ed4e5c61338b879f328c31a988dbab9"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">include_id</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotConfig10include_idE" title="Link to this definition"></a><br /></dt>
<dd><p>Include particle ID column (0-based index). </p>
<p>Legacy always includes ID. Set false only for special exports. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotConfig12include_timeE">
<span id="_CPPv3N4par22io17CsvSnapshotConfig12include_timeE"></span><span id="_CPPv2N4par22io17CsvSnapshotConfig12include_timeE"></span><span id="par2::io::CsvSnapshotConfig::include_time__b"></span><span class="target" id="structpar2_1_1io_1_1CsvSnapshotConfig_1a79ada6e0f83f4ea89c2a23761a9d8c2b"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">include_time</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotConfig12include_timeE" title="Link to this definition"></a><br /></dt>
<dd><p>Include time column at start of each row. </p>
<p>Legacy snapshots do NOT include time. Set true for time-series exports. Format: “t,id,x,y,z,…” </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotConfig14include_statusE">
<span id="_CPPv3N4par22io17CsvSnapshotConfig14include_statusE"></span><span id="_CPPv2N4par22io17CsvSnapshotConfig14include_statusE"></span><span id="par2::io::CsvSnapshotConfig::include_status__b"></span><span class="target" id="structpar2_1_1io_1_1CsvSnapshotConfig_1a8299aedc250e3b0b0da33ec4a078cde6"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">include_status</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotConfig14include_statusE" title="Link to this definition"></a><br /></dt>
<dd><p>Include particle status column (0=Active, 1=Exited, 255=Inactive). </p>
<p>Not in legacy. Useful for analyzing particle fate with Open BC. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotConfig19include_wrap_countsE">
<span id="_CPPv3N4par22io17CsvSnapshotConfig19include_wrap_countsE"></span><span id="_CPPv2N4par22io17CsvSnapshotConfig19include_wrap_countsE"></span><span id="par2::io::CsvSnapshotConfig::include_wrap_counts__b"></span><span class="target" id="structpar2_1_1io_1_1CsvSnapshotConfig_1a63e59b0cdb71c029bad114a2699624d0"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">include_wrap_counts</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotConfig19include_wrap_countsE" title="Link to this definition"></a><br /></dt>
<dd><p>Include wrap count columns (wrapX, wrapY, wrapZ). </p>
<p>Not in legacy. Useful for debugging periodic BC. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotConfig17include_unwrappedE">
<span id="_CPPv3N4par22io17CsvSnapshotConfig17include_unwrappedE"></span><span id="_CPPv2N4par22io17CsvSnapshotConfig17include_unwrappedE"></span><span id="par2::io::CsvSnapshotConfig::include_unwrapped__b"></span><span class="target" id="structpar2_1_1io_1_1CsvSnapshotConfig_1a813f58d0c5358db03bead31f80e3d619"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">include_unwrapped</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotConfig17include_unwrappedE" title="Link to this definition"></a><br /></dt>
<dd><p>Include unwrapped position columns (xu, yu, zu). </p>
<p>Not in legacy. For periodic BC, unwrapped = wrapped + wrap*L. Requires unwrapped positions to be computed before snapshot. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotConfig9precisionE">
<span id="_CPPv3N4par22io17CsvSnapshotConfig9precisionE"></span><span id="_CPPv2N4par22io17CsvSnapshotConfig9precisionE"></span><span id="par2::io::CsvSnapshotConfig::precision__i"></span><span class="target" id="structpar2_1_1io_1_1CsvSnapshotConfig_1abc3a787547d9d5b4f6d5cc3ecf3c0e37"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">precision</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">15</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotConfig9precisionE" title="Link to this definition"></a><br /></dt>
<dd><p>Decimal digits for floating point values. </p>
<p>Legacy uses 15 (full double precision). Reduce for smaller files. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotConfig6strideE">
<span id="_CPPv3N4par22io17CsvSnapshotConfig6strideE"></span><span id="_CPPv2N4par22io17CsvSnapshotConfig6strideE"></span><span id="par2::io::CsvSnapshotConfig::stride__i"></span><span class="target" id="structpar2_1_1io_1_1CsvSnapshotConfig_1a503d7cd01b242d817d3f3b24aaaeba5b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">stride</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotConfig6strideE" title="Link to this definition"></a><br /></dt>
<dd><p>Export every Nth particle. </p>
<p>stride=1: all particles stride=10: every 10th particle (10% sample)</p>
<p>Useful for reducing output size with millions of particles. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotConfig13max_particlesE">
<span id="_CPPv3N4par22io17CsvSnapshotConfig13max_particlesE"></span><span id="_CPPv2N4par22io17CsvSnapshotConfig13max_particlesE"></span><span id="par2::io::CsvSnapshotConfig::max_particles__i"></span><span class="target" id="structpar2_1_1io_1_1CsvSnapshotConfig_1a2c697308c80bf858203d59b0d8879767"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">max_particles</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="o"><span class="pre">-</span></span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotConfig13max_particlesE" title="Link to this definition"></a><br /></dt>
<dd><p>Maximum particles to export. </p>
<p>-1 = no limit (export all after stride) Positive = hard cap on output rows </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par22io17CsvSnapshotWriterE">
<span id="_CPPv3I0EN4par22io17CsvSnapshotWriterE"></span><span id="_CPPv2I0EN4par22io17CsvSnapshotWriterE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classpar2_1_1io_1_1CsvSnapshotWriter"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CsvSnapshotWriter</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par22io17CsvSnapshotWriterE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;io.hpp&gt;</em></div>
<p>Efficient CSV snapshot writer with pinned buffers. </p>
<p>
Manages pinned host memory for efficient D2H transfers and writes particle snapshots to CSV files. Supports both legacy format and extended format with additional columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type (float or double)</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotWriter17CsvSnapshotWriterEiRK17CsvSnapshotConfig">
<span id="_CPPv3N4par22io17CsvSnapshotWriter17CsvSnapshotWriterEiRK17CsvSnapshotConfig"></span><span id="_CPPv2N4par22io17CsvSnapshotWriter17CsvSnapshotWriterEiRK17CsvSnapshotConfig"></span><span id="par2::io::CsvSnapshotWriter::CsvSnapshotWriter__i.CsvSnapshotConfigCR"></span><span class="target" id="classpar2_1_1io_1_1CsvSnapshotWriter_1a8af46eb71a60bd69880a9fb8d6a5fba5"></span><span class="sig-name descname"><span class="n"><span class="pre">CsvSnapshotWriter</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_particles</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par22io17CsvSnapshotConfigE" title="par2::io::CsvSnapshotConfig"><span class="n"><span class="pre">CsvSnapshotConfig</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">config</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="p"><span class="pre">}</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotWriter17CsvSnapshotWriterEiRK17CsvSnapshotConfig" title="Link to this definition"></a><br /></dt>
<dd><p>Construct writer with capacity and configuration. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_particles</strong> – Maximum particles to support </p></li>
<li><p><strong>config</strong> – Snapshot configuration</p></li>
</ul>
</dd>
<dt class="field-even">Throws<span class="colon">:</span></dt>
<dd class="field-even"><p><span><span class="cpp-expr sig sig-inline cpp"><span class="n">std</span><span class="p">::</span><span class="n">bad_alloc</span></span></span> – if pinned memory allocation fails </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotWriterD0Ev">
<span id="_CPPv3N4par22io17CsvSnapshotWriterD0Ev"></span><span id="_CPPv2N4par22io17CsvSnapshotWriterD0Ev"></span><span id="par2::io::CsvSnapshotWriter::~CsvSnapshotWriter"></span><span class="target" id="classpar2_1_1io_1_1CsvSnapshotWriter_1a581757dd9603a70da35147ffbbc9b4a0"></span><span class="sig-name descname"><span class="n"><span class="pre">~CsvSnapshotWriter</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotWriterD0Ev" title="Link to this definition"></a><br /></dt>
<dd><p>Destructor - frees pinned memory. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotWriter17CsvSnapshotWriterERK17CsvSnapshotWriter">
<span id="_CPPv3N4par22io17CsvSnapshotWriter17CsvSnapshotWriterERK17CsvSnapshotWriter"></span><span id="_CPPv2N4par22io17CsvSnapshotWriter17CsvSnapshotWriterERK17CsvSnapshotWriter"></span><span id="par2::io::CsvSnapshotWriter::CsvSnapshotWriter__CsvSnapshotWriterCR"></span><span class="target" id="classpar2_1_1io_1_1CsvSnapshotWriter_1ad6a3e1c020995b26de8ebaebd2c925c4"></span><span class="sig-name descname"><span class="n"><span class="pre">CsvSnapshotWriter</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par22io17CsvSnapshotWriter17CsvSnapshotWriterERK17CsvSnapshotWriter" title="par2::io::CsvSnapshotWriter::CsvSnapshotWriter"><span class="n"><span class="pre">CsvSnapshotWriter</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotWriter17CsvSnapshotWriterERK17CsvSnapshotWriter" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotWriteraSERK17CsvSnapshotWriter">
<span id="_CPPv3N4par22io17CsvSnapshotWriteraSERK17CsvSnapshotWriter"></span><span id="_CPPv2N4par22io17CsvSnapshotWriteraSERK17CsvSnapshotWriter"></span><span id="par2::io::CsvSnapshotWriter::assign-operator__CsvSnapshotWriterCR"></span><span class="target" id="classpar2_1_1io_1_1CsvSnapshotWriter_1aa890f23741a9a50cf78d22070a5986b1"></span><a class="reference internal" href="#_CPPv4I0EN4par22io17CsvSnapshotWriterE" title="par2::io::CsvSnapshotWriter"><span class="n"><span class="pre">CsvSnapshotWriter</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par22io17CsvSnapshotWriterE" title="par2::io::CsvSnapshotWriter"><span class="n"><span class="pre">CsvSnapshotWriter</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotWriteraSERK17CsvSnapshotWriter" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotWriter17CsvSnapshotWriterERR17CsvSnapshotWriter">
<span id="_CPPv3N4par22io17CsvSnapshotWriter17CsvSnapshotWriterERR17CsvSnapshotWriter"></span><span id="_CPPv2N4par22io17CsvSnapshotWriter17CsvSnapshotWriterERR17CsvSnapshotWriter"></span><span id="par2::io::CsvSnapshotWriter::CsvSnapshotWriter__CsvSnapshotWriterRR"></span><span class="target" id="classpar2_1_1io_1_1CsvSnapshotWriter_1aaa3c92790b6f0402601aac4c9ad497cd"></span><span class="sig-name descname"><span class="n"><span class="pre">CsvSnapshotWriter</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N4par22io17CsvSnapshotWriter17CsvSnapshotWriterERR17CsvSnapshotWriter" title="par2::io::CsvSnapshotWriter::CsvSnapshotWriter"><span class="n"><span class="pre">CsvSnapshotWriter</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">other</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotWriter17CsvSnapshotWriterERR17CsvSnapshotWriter" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotWriteraSERR17CsvSnapshotWriter">
<span id="_CPPv3N4par22io17CsvSnapshotWriteraSERR17CsvSnapshotWriter"></span><span id="_CPPv2N4par22io17CsvSnapshotWriteraSERR17CsvSnapshotWriter"></span><span id="par2::io::CsvSnapshotWriter::assign-operator__CsvSnapshotWriterRR"></span><span class="target" id="classpar2_1_1io_1_1CsvSnapshotWriter_1a522bcf0f371e3005e22d328e5f173d14"></span><a class="reference internal" href="#_CPPv4I0EN4par22io17CsvSnapshotWriterE" title="par2::io::CsvSnapshotWriter"><span class="n"><span class="pre">CsvSnapshotWriter</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN4par22io17CsvSnapshotWriterE" title="par2::io::CsvSnapshotWriter"><span class="n"><span class="pre">CsvSnapshotWriter</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">other</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotWriteraSERR17CsvSnapshotWriter" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotWriter14write_snapshotERK18ConstParticlesViewI1TERKNSt6stringE1T12cudaStream_tPK22UnwrappedPositionsViewI1TE">
<span id="_CPPv3N4par22io17CsvSnapshotWriter14write_snapshotERK18ConstParticlesViewI1TERKNSt6stringE1T12cudaStream_tPK22UnwrappedPositionsViewI1TE"></span><span id="_CPPv2N4par22io17CsvSnapshotWriter14write_snapshotERK18ConstParticlesViewI1TERKNSt6stringE1T12cudaStream_tPK22UnwrappedPositionsViewI1TE"></span><span id="par2::io::CsvSnapshotWriter::write_snapshot__ConstParticlesView:T:CR.ssCR.T.cudaStream_t.UnwrappedPositionsView:T:CP"></span><span class="target" id="classpar2_1_1io_1_1CsvSnapshotWriter_1af8c98e79c2c46c3aa3f5c1acf849fa98"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">write_snapshot</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView"><span class="n"><span class="pre">ConstParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par22io17CsvSnapshotWriterE" title="par2::io::CsvSnapshotWriter::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par22io17CsvSnapshotWriterE" title="par2::io::CsvSnapshotWriter::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par222UnwrappedPositionsViewE" title="par2::UnwrappedPositionsView"><span class="n"><span class="pre">UnwrappedPositionsView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par22io17CsvSnapshotWriterE" title="par2::io::CsvSnapshotWriter::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">unwrapped</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotWriter14write_snapshotERK18ConstParticlesViewI1TERKNSt6stringE1T12cudaStream_tPK22UnwrappedPositionsViewI1TE" title="Link to this definition"></a><br /></dt>
<dd><p>Write particle snapshot to CSV file. </p>
<p>Performs the following steps:<ol class="upperroman simple">
<li><p>Copy positions from device to pinned host buffer (async)</p></li>
<li><p>Copy optional data (status, wrap counts) if configured</p></li>
<li><p>Synchronize the stream</p></li>
<li><p>Write CSV file (CPU-side, blocking)</p></li>
</ol>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Synchronizes stream internally before file write. The D2H copy is overlapped with prior GPU work.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For very large exports, consider using <a class="reference internal" href="#classpar2_1_1io_1_1CsvSnapshotWriter_1acd77fa101b45b4e434eb90ab1f93c353"><span class="std std-ref">write_snapshot_chunked()</span></a>. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> – Particle positions (device pointers) </p></li>
<li><p><strong>filename</strong> – Output file path (will be overwritten) </p></li>
<li><p><strong>time</strong> – Simulation time (only used if include_time=true) </p></li>
<li><p><strong>stream</strong> – CUDA stream for D2H transfers </p></li>
<li><p><strong>unwrapped</strong> – Optional unwrapped positions (device) Required if include_unwrapped=true</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>true on success, false on I/O error</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotWriter22write_snapshot_chunkedERK18ConstParticlesViewI1TERKNSt6stringE1T12cudaStream_tPK22UnwrappedPositionsViewI1TE">
<span id="_CPPv3N4par22io17CsvSnapshotWriter22write_snapshot_chunkedERK18ConstParticlesViewI1TERKNSt6stringE1T12cudaStream_tPK22UnwrappedPositionsViewI1TE"></span><span id="_CPPv2N4par22io17CsvSnapshotWriter22write_snapshot_chunkedERK18ConstParticlesViewI1TERKNSt6stringE1T12cudaStream_tPK22UnwrappedPositionsViewI1TE"></span><span id="par2::io::CsvSnapshotWriter::write_snapshot_chunked__ConstParticlesView:T:CR.ssCR.T.cudaStream_t.UnwrappedPositionsView:T:CP"></span><span class="target" id="classpar2_1_1io_1_1CsvSnapshotWriter_1acd77fa101b45b4e434eb90ab1f93c353"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">write_snapshot_chunked</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par218ConstParticlesViewE" title="par2::ConstParticlesView"><span class="n"><span class="pre">ConstParticlesView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par22io17CsvSnapshotWriterE" title="par2::io::CsvSnapshotWriter::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <a class="reference internal" href="#_CPPv4I0EN4par22io17CsvSnapshotWriterE" title="par2::io::CsvSnapshotWriter::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">time</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par222UnwrappedPositionsViewE" title="par2::UnwrappedPositionsView"><span class="n"><span class="pre">UnwrappedPositionsView</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par22io17CsvSnapshotWriterE" title="par2::io::CsvSnapshotWriter::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">unwrapped</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotWriter22write_snapshot_chunkedERK18ConstParticlesViewI1TERKNSt6stringE1T12cudaStream_tPK22UnwrappedPositionsViewI1TE" title="Link to this definition"></a><br /></dt>
<dd><p>Write snapshot in chunks (for very large particle counts). </p>
<p>Same as write_snapshot but processes particles in chunks to limit peak host memory usage. Uses internal buffer size as chunk.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Appends chunks to file, so slightly slower than single write. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> – Full particle view </p></li>
<li><p><strong>filename</strong> – Output file path </p></li>
<li><p><strong>time</strong> – Simulation time </p></li>
<li><p><strong>stream</strong> – CUDA stream </p></li>
<li><p><strong>unwrapped</strong> – Optional unwrapped positions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>true on success</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par22io17CsvSnapshotWriter6configEv">
<span id="_CPPv3NK4par22io17CsvSnapshotWriter6configEv"></span><span id="_CPPv2NK4par22io17CsvSnapshotWriter6configEv"></span><span id="par2::io::CsvSnapshotWriter::configC"></span><span class="target" id="classpar2_1_1io_1_1CsvSnapshotWriter_1a6b2119a6a55e300b18af2f21fb5812b9"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par22io17CsvSnapshotConfigE" title="par2::io::CsvSnapshotConfig"><span class="n"><span class="pre">CsvSnapshotConfig</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">config</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par22io17CsvSnapshotWriter6configEv" title="Link to this definition"></a><br /></dt>
<dd><p>Access configuration. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par22io17CsvSnapshotWriter8capacityEv">
<span id="_CPPv3NK4par22io17CsvSnapshotWriter8capacityEv"></span><span id="_CPPv2NK4par22io17CsvSnapshotWriter8capacityEv"></span><span id="par2::io::CsvSnapshotWriter::capacityC"></span><span class="target" id="classpar2_1_1io_1_1CsvSnapshotWriter_1a07411c97f2bd1515fa00ff97e2f93b0f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">capacity</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par22io17CsvSnapshotWriter8capacityEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get buffer capacity. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-private-members">Private Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io17CsvSnapshotWriter5impl_E">
<span id="_CPPv3N4par22io17CsvSnapshotWriter5impl_E"></span><span id="_CPPv2N4par22io17CsvSnapshotWriter5impl_E"></span><span id="par2::io::CsvSnapshotWriter::impl___ImplP"></span><span class="target" id="classpar2_1_1io_1_1CsvSnapshotWriter_1afea24356e56310b058e08934f45bb273"></span><span class="n"><span class="pre">Impl</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">impl_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par22io17CsvSnapshotWriter5impl_E" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par22io19HostParticlesBufferE">
<span id="_CPPv3I0EN4par22io19HostParticlesBufferE"></span><span id="_CPPv2I0EN4par22io19HostParticlesBufferE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structpar2_1_1io_1_1HostParticlesBuffer"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">HostParticlesBuffer</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par22io19HostParticlesBufferE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;io.hpp&gt;</em></div>
<p>Host-side buffer view for particle positions. </p>
<p>
User must allocate these arrays before calling download functions. For best performance, use cudaMallocHost for pinned memory. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par22io19HostParticlesBuffer5validEv">
<span id="_CPPv3NK4par22io19HostParticlesBuffer5validEv"></span><span id="_CPPv2NK4par22io19HostParticlesBuffer5validEv"></span><span id="par2::io::HostParticlesBuffer::validCCE"></span><span class="target" id="structpar2_1_1io_1_1HostParticlesBuffer_1a80bcebda93056c12d0149e8d3552d302"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">valid</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par22io19HostParticlesBuffer5validEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4par22io19HostParticlesBuffer13has_unwrappedEv">
<span id="_CPPv3NK4par22io19HostParticlesBuffer13has_unwrappedEv"></span><span id="_CPPv2NK4par22io19HostParticlesBuffer13has_unwrappedEv"></span><span id="par2::io::HostParticlesBuffer::has_unwrappedCCE"></span><span class="target" id="structpar2_1_1io_1_1HostParticlesBuffer_1a56f5080bb4be09097bd078616544de08"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_unwrapped</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK4par22io19HostParticlesBuffer13has_unwrappedEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io19HostParticlesBuffer1xE">
<span id="_CPPv3N4par22io19HostParticlesBuffer1xE"></span><span id="_CPPv2N4par22io19HostParticlesBuffer1xE"></span><span id="par2::io::HostParticlesBuffer::x__TP"></span><span class="target" id="structpar2_1_1io_1_1HostParticlesBuffer_1add7b33f9838dd49627cec455306fd561"></span><a class="reference internal" href="#_CPPv4I0EN4par22io19HostParticlesBufferE" title="par2::io::HostParticlesBuffer::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">x</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par22io19HostParticlesBuffer1xE" title="Link to this definition"></a><br /></dt>
<dd><p>X positions [host ptr]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io19HostParticlesBuffer1yE">
<span id="_CPPv3N4par22io19HostParticlesBuffer1yE"></span><span id="_CPPv2N4par22io19HostParticlesBuffer1yE"></span><span id="par2::io::HostParticlesBuffer::y__TP"></span><span class="target" id="structpar2_1_1io_1_1HostParticlesBuffer_1adfa0408ff7fb6714b6d2027d54a8ca5b"></span><a class="reference internal" href="#_CPPv4I0EN4par22io19HostParticlesBufferE" title="par2::io::HostParticlesBuffer::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">y</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par22io19HostParticlesBuffer1yE" title="Link to this definition"></a><br /></dt>
<dd><p>Y positions [host ptr]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io19HostParticlesBuffer1zE">
<span id="_CPPv3N4par22io19HostParticlesBuffer1zE"></span><span id="_CPPv2N4par22io19HostParticlesBuffer1zE"></span><span id="par2::io::HostParticlesBuffer::z__TP"></span><span class="target" id="structpar2_1_1io_1_1HostParticlesBuffer_1a697c18d1147ad5d264f520bbb2ff4caa"></span><a class="reference internal" href="#_CPPv4I0EN4par22io19HostParticlesBufferE" title="par2::io::HostParticlesBuffer::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">z</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par22io19HostParticlesBuffer1zE" title="Link to this definition"></a><br /></dt>
<dd><p>Z positions [host ptr]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io19HostParticlesBuffer8capacityE">
<span id="_CPPv3N4par22io19HostParticlesBuffer8capacityE"></span><span id="_CPPv2N4par22io19HostParticlesBuffer8capacityE"></span><span id="par2::io::HostParticlesBuffer::capacity__i"></span><span class="target" id="structpar2_1_1io_1_1HostParticlesBuffer_1af6044eccb48b82a0140d09d76692239e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">capacity</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par22io19HostParticlesBuffer8capacityE" title="Link to this definition"></a><br /></dt>
<dd><p>Allocated size. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io19HostParticlesBuffer3x_uE">
<span id="_CPPv3N4par22io19HostParticlesBuffer3x_uE"></span><span id="_CPPv2N4par22io19HostParticlesBuffer3x_uE"></span><span id="par2::io::HostParticlesBuffer::x_u__TP"></span><span class="target" id="structpar2_1_1io_1_1HostParticlesBuffer_1a3f60b557d4dbe6456ce8b79d90c48aa6"></span><a class="reference internal" href="#_CPPv4I0EN4par22io19HostParticlesBufferE" title="par2::io::HostParticlesBuffer::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">x_u</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par22io19HostParticlesBuffer3x_uE" title="Link to this definition"></a><br /></dt>
<dd><p>Unwrapped X [host ptr, optional]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io19HostParticlesBuffer3y_uE">
<span id="_CPPv3N4par22io19HostParticlesBuffer3y_uE"></span><span id="_CPPv2N4par22io19HostParticlesBuffer3y_uE"></span><span id="par2::io::HostParticlesBuffer::y_u__TP"></span><span class="target" id="structpar2_1_1io_1_1HostParticlesBuffer_1aadd0f0a295ced93153779286bc19f35c"></span><a class="reference internal" href="#_CPPv4I0EN4par22io19HostParticlesBufferE" title="par2::io::HostParticlesBuffer::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">y_u</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par22io19HostParticlesBuffer3y_uE" title="Link to this definition"></a><br /></dt>
<dd><p>Unwrapped Y [host ptr, optional]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io19HostParticlesBuffer3z_uE">
<span id="_CPPv3N4par22io19HostParticlesBuffer3z_uE"></span><span id="_CPPv2N4par22io19HostParticlesBuffer3z_uE"></span><span id="par2::io::HostParticlesBuffer::z_u__TP"></span><span class="target" id="structpar2_1_1io_1_1HostParticlesBuffer_1a08cc77ae7fc092c903c106c0837f62d3"></span><a class="reference internal" href="#_CPPv4I0EN4par22io19HostParticlesBufferE" title="par2::io::HostParticlesBuffer::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">z_u</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par22io19HostParticlesBuffer3z_uE" title="Link to this definition"></a><br /></dt>
<dd><p>Unwrapped Z [host ptr, optional]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io19HostParticlesBuffer6statusE">
<span id="_CPPv3N4par22io19HostParticlesBuffer6statusE"></span><span id="_CPPv2N4par22io19HostParticlesBuffer6statusE"></span><span id="par2::io::HostParticlesBuffer::status__uint8_tP"></span><span class="target" id="structpar2_1_1io_1_1HostParticlesBuffer_1a1c404211219148bb27b2c3c771179255"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">status</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4par22io19HostParticlesBuffer6statusE" title="Link to this definition"></a><br /></dt>
<dd><p>Status flags [host ptr, optional]. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0EN4par22io21PinnedParticlesBufferE">
<span id="_CPPv3I0EN4par22io21PinnedParticlesBufferE"></span><span id="_CPPv2I0EN4par22io21PinnedParticlesBufferE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classpar2_1_1io_1_1PinnedParticlesBuffer"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PinnedParticlesBuffer</span></span></span><a class="headerlink" href="#_CPPv4I0EN4par22io21PinnedParticlesBufferE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;io.hpp&gt;</em></div>
<p>RAII wrapper for pinned host buffer allocation. </p>
<p>
Allocates pinned memory for efficient async transfers. Automatically frees on destruction. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – Floating point type</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferEv">
<span id="_CPPv3N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferEv"></span><span id="_CPPv2N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferEv"></span><span id="par2::io::PinnedParticlesBuffer::PinnedParticlesBuffer"></span><span class="target" id="classpar2_1_1io_1_1PinnedParticlesBuffer_1abb27c905649af9669b1fa3526886bf87"></span><span class="sig-name descname"><span class="n"><span class="pre">PinnedParticlesBuffer</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io21PinnedParticlesBuffer8allocateEibb">
<span id="_CPPv3N4par22io21PinnedParticlesBuffer8allocateEibb"></span><span id="_CPPv2N4par22io21PinnedParticlesBuffer8allocateEibb"></span><span id="par2::io::PinnedParticlesBuffer::allocate__i.b.b"></span><span class="target" id="classpar2_1_1io_1_1PinnedParticlesBuffer_1a45d913e643400d364cb6b21b872f5c7e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allocate</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">capacity</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">with_unwrapped</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">with_status</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par22io21PinnedParticlesBuffer8allocateEibb" title="Link to this definition"></a><br /></dt>
<dd><p>Allocate pinned buffers. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>capacity</strong> – Number of particles </p></li>
<li><p><strong>with_unwrapped</strong> – Allocate x_u/y_u/z_u </p></li>
<li><p><strong>with_status</strong> – Allocate status array </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io21PinnedParticlesBuffer4freeEv">
<span id="_CPPv3N4par22io21PinnedParticlesBuffer4freeEv"></span><span id="_CPPv2N4par22io21PinnedParticlesBuffer4freeEv"></span><span id="par2::io::PinnedParticlesBuffer::free"></span><span class="target" id="classpar2_1_1io_1_1PinnedParticlesBuffer_1a44a76574cf835483cd3459a63a58f915"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">free</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par22io21PinnedParticlesBuffer4freeEv" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io21PinnedParticlesBufferD0Ev">
<span id="_CPPv3N4par22io21PinnedParticlesBufferD0Ev"></span><span id="_CPPv2N4par22io21PinnedParticlesBufferD0Ev"></span><span id="par2::io::PinnedParticlesBuffer::~PinnedParticlesBuffer"></span><span class="target" id="classpar2_1_1io_1_1PinnedParticlesBuffer_1a638152fb6895d37748318768d835c996"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~PinnedParticlesBuffer</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4par22io21PinnedParticlesBufferD0Ev" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferERK21PinnedParticlesBuffer">
<span id="_CPPv3N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferERK21PinnedParticlesBuffer"></span><span id="_CPPv2N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferERK21PinnedParticlesBuffer"></span><span id="par2::io::PinnedParticlesBuffer::PinnedParticlesBuffer__PinnedParticlesBufferCR"></span><span class="target" id="classpar2_1_1io_1_1PinnedParticlesBuffer_1aab63a6c24c7cce4b771e2261e0693635"></span><span class="sig-name descname"><span class="n"><span class="pre">PinnedParticlesBuffer</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferERK21PinnedParticlesBuffer" title="par2::io::PinnedParticlesBuffer::PinnedParticlesBuffer"><span class="n"><span class="pre">PinnedParticlesBuffer</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferERK21PinnedParticlesBuffer" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io21PinnedParticlesBufferaSERK21PinnedParticlesBuffer">
<span id="_CPPv3N4par22io21PinnedParticlesBufferaSERK21PinnedParticlesBuffer"></span><span id="_CPPv2N4par22io21PinnedParticlesBufferaSERK21PinnedParticlesBuffer"></span><span id="par2::io::PinnedParticlesBuffer::assign-operator__PinnedParticlesBufferCR"></span><span class="target" id="classpar2_1_1io_1_1PinnedParticlesBuffer_1ad2915952c37021836d83c9bdb05ad8ad"></span><a class="reference internal" href="#_CPPv4I0EN4par22io21PinnedParticlesBufferE" title="par2::io::PinnedParticlesBuffer"><span class="n"><span class="pre">PinnedParticlesBuffer</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par22io21PinnedParticlesBufferE" title="par2::io::PinnedParticlesBuffer"><span class="n"><span class="pre">PinnedParticlesBuffer</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N4par22io21PinnedParticlesBufferaSERK21PinnedParticlesBuffer" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferERR21PinnedParticlesBuffer">
<span id="_CPPv3N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferERR21PinnedParticlesBuffer"></span><span id="_CPPv2N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferERR21PinnedParticlesBuffer"></span><span id="par2::io::PinnedParticlesBuffer::PinnedParticlesBuffer__PinnedParticlesBufferRR"></span><span class="target" id="classpar2_1_1io_1_1PinnedParticlesBuffer_1a9723ad29ac16701d1a683cd84dbd0b59"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PinnedParticlesBuffer</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferERR21PinnedParticlesBuffer" title="par2::io::PinnedParticlesBuffer::PinnedParticlesBuffer"><span class="n"><span class="pre">PinnedParticlesBuffer</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">other</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par22io21PinnedParticlesBuffer21PinnedParticlesBufferERR21PinnedParticlesBuffer" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io21PinnedParticlesBufferaSERR21PinnedParticlesBuffer">
<span id="_CPPv3N4par22io21PinnedParticlesBufferaSERR21PinnedParticlesBuffer"></span><span id="_CPPv2N4par22io21PinnedParticlesBufferaSERR21PinnedParticlesBuffer"></span><span id="par2::io::PinnedParticlesBuffer::assign-operator__PinnedParticlesBufferRR"></span><span class="target" id="classpar2_1_1io_1_1PinnedParticlesBuffer_1aef9b4b025eb311e99b291f5dd4a11089"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN4par22io21PinnedParticlesBufferE" title="par2::io::PinnedParticlesBuffer"><span class="n"><span class="pre">PinnedParticlesBuffer</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN4par22io21PinnedParticlesBufferE" title="par2::io::PinnedParticlesBuffer"><span class="n"><span class="pre">PinnedParticlesBuffer</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">other</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N4par22io21PinnedParticlesBufferaSERR21PinnedParticlesBuffer" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par22io21PinnedParticlesBuffer6bufferE">
<span id="_CPPv3N4par22io21PinnedParticlesBuffer6bufferE"></span><span id="_CPPv2N4par22io21PinnedParticlesBuffer6bufferE"></span><span id="par2::io::PinnedParticlesBuffer::buffer__HostParticlesBuffer:T:"></span><span class="target" id="classpar2_1_1io_1_1PinnedParticlesBuffer_1a7cad6c201da996d6e12c1470f18f087c"></span><a class="reference internal" href="#_CPPv4I0EN4par22io19HostParticlesBufferE" title="par2::io::HostParticlesBuffer"><span class="n"><span class="pre">HostParticlesBuffer</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN4par22io21PinnedParticlesBufferE" title="par2::io::PinnedParticlesBuffer::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">buffer</span></span></span><a class="headerlink" href="#_CPPv4N4par22io21PinnedParticlesBuffer6bufferE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

</dd></dl>

</dd></dl>

</section>
<section id="version">
<h2>Version<a class="headerlink" href="#version" title="Link to this heading"></a></h2>
<p>Par2_Core version information. </p>
<p><dl class="simple">
<dt><strong>Copyright</strong></dt><dd><p>Par2_Core - GPU-native transport engine </p>
</dd>
</dl>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PAR2_CORE_VERSION_MAJOR">
<span class="target" id="version_8hpp_1a3b0818665b63c775ded705f1c5382932"></span><span class="sig-name descname"><span class="n"><span class="pre">PAR2_CORE_VERSION_MAJOR</span></span></span><a class="headerlink" href="#c.PAR2_CORE_VERSION_MAJOR" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PAR2_CORE_VERSION_MINOR">
<span class="target" id="version_8hpp_1a92f538029b5a30d12ae484d182f59972"></span><span class="sig-name descname"><span class="n"><span class="pre">PAR2_CORE_VERSION_MINOR</span></span></span><a class="headerlink" href="#c.PAR2_CORE_VERSION_MINOR" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PAR2_CORE_VERSION_PATCH">
<span class="target" id="version_8hpp_1afffcc284f50402c071957a3e5a26a623"></span><span class="sig-name descname"><span class="n"><span class="pre">PAR2_CORE_VERSION_PATCH</span></span></span><a class="headerlink" href="#c.PAR2_CORE_VERSION_PATCH" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PAR2_CORE_VERSION_STRING">
<span class="target" id="version_8hpp_1a4d37d89ef644efe054c7a5721f2f5128"></span><span class="sig-name descname"><span class="n"><span class="pre">PAR2_CORE_VERSION_STRING</span></span></span><a class="headerlink" href="#c.PAR2_CORE_VERSION_STRING" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<dl class="cpp type">
<dt class="sig sig-object cpp">
<span class="target" id="namespacepar2"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">par2</span></span></span><br /></dt>
<dd><dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4par27VersionE">
<span id="_CPPv3N4par27VersionE"></span><span id="_CPPv2N4par27VersionE"></span><span id="par2::Version"></span><span class="target" id="structpar2_1_1Version"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Version</span></span></span><a class="headerlink" href="#_CPPv4N4par27VersionE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;version.hpp&gt;</em></div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-attributes">Public Static Attributes</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par27Version5majorE">
<span id="_CPPv3N4par27Version5majorE"></span><span id="_CPPv2N4par27Version5majorE"></span><span id="par2::Version::major__i"></span><span class="target" id="structpar2_1_1Version_1aef4962e2ca9ee6cfdd381887d6f5a384"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">major</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par27Version5majorE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par27Version5minorE">
<span id="_CPPv3N4par27Version5minorE"></span><span id="_CPPv2N4par27Version5minorE"></span><span id="par2::Version::minor__i"></span><span class="target" id="structpar2_1_1Version_1a2d42afa8f54232d9318e2177188cf65d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">minor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv4N4par27Version5minorE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par27Version5patchE">
<span id="_CPPv3N4par27Version5patchE"></span><span id="_CPPv2N4par27Version5patchE"></span><span id="par2::Version::patch__i"></span><span class="target" id="structpar2_1_1Version_1a05be3f3833d6d50b672aad667cb9ab2f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">patch</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4par27Version5patchE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4par27Version6stringE">
<span id="_CPPv3N4par27Version6stringE"></span><span id="_CPPv2N4par27Version6stringE"></span><span id="par2::Version::string__cCP"></span><span class="target" id="structpar2_1_1Version_1ad3fc883acf27d83724cd795dbee8dbd1"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">string</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;0.1.0&quot;</span></span><a class="headerlink" href="#_CPPv4N4par27Version6stringE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="debug-policy">
<h2>Debug Policy<a class="headerlink" href="#debug-policy" title="Link to this heading"></a></h2>
<p>Compile-time debug/release policies for Par2_Core. </p>
<p>This header defines compile-time macros that control debug features:<ul class="simple">
<li><p>PAR2_DEBUG_LEVEL: Overall debug level (0=release, 1=basic, 2=full)</p></li>
<li><p>PAR2_ENABLE_NAN_GUARDS: Enable NaN/Inf checks in kernels</p></li>
<li><p>PAR2_ENABLE_BOUNDS_CHECKS: Enable array bounds validation</p></li>
</ul>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PAR2_DEBUG_LEVEL">
<span class="target" id="debug__policy_8hpp_1ab580aa2441865ad28e7c82f43dd642b4"></span><span class="sig-name descname"><span class="n"><span class="pre">PAR2_DEBUG_LEVEL</span></span></span><a class="headerlink" href="#c.PAR2_DEBUG_LEVEL" title="Link to this definition"></a><br /></dt>
<dd><p>Master debug level for Par2_Core. </p>
<p><ul class="simple">
<li><p>0: Release (default) - no debug overhead</p></li>
<li><p>1: Basic debug - CUDA error checks after launches (no sync)</p></li>
<li><p>2: Full debug - adds NaN guards and bounds checks in kernels </p></li>
</ul>
</p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PAR2_ENABLE_CUDA_CHECKS">
<span class="target" id="debug__policy_8hpp_1a439a5b5e8739d673c373dfa3e8fb90e7"></span><span class="sig-name descname"><span class="n"><span class="pre">PAR2_ENABLE_CUDA_CHECKS</span></span></span><a class="headerlink" href="#c.PAR2_ENABLE_CUDA_CHECKS" title="Link to this definition"></a><br /></dt>
<dd><p>Enable CUDA error checks after kernel launches. </p>
<p>When enabled, uses cudaPeekAtLastError() after kernel launches. Does NOT synchronize - only catches launch config errors. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PAR2_ENABLE_NAN_GUARDS">
<span class="target" id="debug__policy_8hpp_1a6021a171b13091a4f314b032e514b4ae"></span><span class="sig-name descname"><span class="n"><span class="pre">PAR2_ENABLE_NAN_GUARDS</span></span></span><a class="headerlink" href="#c.PAR2_ENABLE_NAN_GUARDS" title="Link to this definition"></a><br /></dt>
<dd><p>Enable NaN/Inf guards in dispersion computations. </p>
<p>When enabled, kernels check for division by zero and clamp values to prevent NaN propagation. Adds per-particle overhead. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PAR2_ENABLE_BOUNDS_CHECKS">
<span class="target" id="debug__policy_8hpp_1a5aaaf5372fd99661a3a7ca3635de9aa4"></span><span class="sig-name descname"><span class="n"><span class="pre">PAR2_ENABLE_BOUNDS_CHECKS</span></span></span><a class="headerlink" href="#c.PAR2_ENABLE_BOUNDS_CHECKS" title="Link to this definition"></a><br /></dt>
<dd><p>Enable array bounds checking in kernels. </p>
<p>When enabled, kernels validate array indices before access. Significant per-particle overhead. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PAR2_DEBUG_ONLY">
<span class="target" id="debug__policy_8hpp_1ad90d3d600e0ce3f692232ac7635ed8f0"></span><span class="sig-name descname"><span class="n"><span class="pre">PAR2_DEBUG_ONLY</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">code</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.PAR2_DEBUG_ONLY" title="Link to this definition"></a><br /></dt>
<dd><p>Legacy macro for debug builds. </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Deprecated:</span></em></dt>
<dd><p>Use PAR2_DEBUG_LEVEL instead. </p>
</dd></dl>

</p>
<p>Execute code only in debug builds.</p>
<p>Usage: <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">PAR2_DEBUG_ONLY</span><span class="p">(</span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Debug: x=%f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);)</span>
</pre></div>
</div>
</p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PAR2_NAN_GUARD">
<span class="target" id="debug__policy_8hpp_1ab4725fc915429bcfe4bce0c873afb425"></span><span class="sig-name descname"><span class="n"><span class="pre">PAR2_NAN_GUARD</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">code</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.PAR2_NAN_GUARD" title="Link to this definition"></a><br /></dt>
<dd><p>Execute code only with NaN guards enabled. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PAR2_DEVICE_ASSERT">
<span class="target" id="debug__policy_8hpp_1ab0b2ad422e840b79bd9ef73633c94aa6"></span><span class="sig-name descname"><span class="n"><span class="pre">PAR2_DEVICE_ASSERT</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">cond</span></span>, <span class="n"><span class="pre">msg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.PAR2_DEVICE_ASSERT" title="Link to this definition"></a><br /></dt>
<dd><p>Device-side assertion (only in debug builds). </p>
<p>Usage in kernels: <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">PAR2_DEVICE_ASSERT</span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Index out of bounds&quot;</span><span class="p">);</span>
</pre></div>
</div>
</p>
</dd></dl>

</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../hpc/performance_notes.html" class="btn btn-neutral float-left" title="Performance Notes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../dev/semantic_map.html" class="btn btn-neutral float-right" title="Semantic Map — Par2_Core Contracts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Par2_Core contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>